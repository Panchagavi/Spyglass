{
  "workflow": {
    "unique_name": "definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u",
    "name": "XDR-1253-Rule History Automation",
    "title": "XDR-1253-Rule History Automation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Overall Status for 1253",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H508G5WFJ500joO2lNYsgYqMYZmCjOwCw",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_029M4VKMD31CZ4YiphmwBKFaWrc0i8e0e8Y",
        "properties": {
          "scope": "output",
          "name": "Webhook Results",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02H5TFL232AQJ2N5D8noGi21ozHawU93iCf",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Pass",
          "scope": "output",
          "name": "Webhook ForEach TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H5U7ZX3CE074UUkMZ9BwzIitfgU97X6hl",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_02H5V6NEBUV74084cPF0Q7T87Bs1JJXjOPc",
        "properties": {
          "value": [
            {
              "column_data": {
                "payload": "{\"name\": \"json 1253 rule history test\"}",
                "type": "json",
                "webhook_type": "application/json"
              }
            },
            {
              "column_data": {
                "payload": "\"\u003cnote\u003e\\n\u003cto\u003exml 1253 rule history test\u003c/to\u003e\\n\u003cfrom\u003eJani\u003c/from\u003e\\n\u003cheading\u003eReminder\u003c/heading\u003e\\n\u003cbody\u003eDon't forget me this weekend!\u003c/body\u003e\\n\u003c/note\u003e\"",
                "type": "xml",
                "webhook_type": "application/xml"
              }
            },
            {
              "column_data": {
                "payload": "application/json; charset=utf-8",
                "type": "utf8",
                "webhook_type": "application/json; charset=utf-8"
              }
            },
            {
              "column_data": {
                "payload": "application/x-www-form-urlencoded",
                "type": "urlencoded",
                "webhook_type": "application/x-www-form-urlencoded"
              }
            }
          ],
          "scope": "local",
          "name": "Webhook_Inputs",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02H5V9NY600LU6kLcm3k7INklafI0sB0mlf",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_02H5U16E47CW7535EKB7fcAGkM1Ub7Sajy2",
        "properties": {
          "scope": "local",
          "name": "Webhook_Ids",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02H5U1UJQZ0CO5lcFlSnFuLYsyeDKR9xfCQ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Priority_Rule_History_TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4ZY1DZY3GL2ngObjIuHrjjFsJc2bDBcS",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Approval_Rule_History_TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4ZY7QN9QVT0lw2MiaYuNnM0fe07OcfCY",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Schedule_Rule_History_TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4ZYLBG69UL7TbELgH4beRdQFi3RIipt6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Provide Token (Without Bearer)",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "ST Incident - Match Rule to 2 and 0 Test Status",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H5ETW7WTO5P5GdZPjSz0dPtpwHrTceyDF",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_02H5U16E47CW7535EKB7fcAGkM1Ub7Sajy2",
        "properties": {
          "scope": "local",
          "name": "Webhook_Rule_Ids",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02H5U1PRFCCAM1v32c88DEfhm2PGLmqGC9Y",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Webhook_Rule_History_TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4ZYDON5H4F5ZA0pxJZd5VNxWMYlb0CHB",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Standalone_Rule_History_TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02H4ZXVDBUXJF5bFOffjU7IpF4L3UezPF2Y",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "XDR-1253-Rule History Automation\n\nCreate a workflow \nCreate rules and map a above wf \nTrigger WF using all 4 rules (Incident , Approval , Schedule and Webhook)\nHit rule history API to View the history \nfetch the event_name , type and matched rule count and compare \nCleanup all created Objects ",
      "display_name": "XDR-1253-Rule History Automation",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "specify_on_workflow_start": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe",
        "name": "Automatation - Create Generic Workflow",
        "title": "Automatation - Create Generic Workflow",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Automatation - Create Generic Workflow",
          "input": {
            "variable_workflow_026R3ITFC2SYD5IwFCCSGoDOyqkGJgCEwsd": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_026R3ITFC37UO0GCPYutjproHMzvdvq1KRV": "Authorization",
            "variable_workflow_026R3ITFC3WLQ0CQIbKxaAf0PetE6SpXHSj": "TestWF-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
          "workflow_name": "Automatation - Create Generic Workflow"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4RXOBPQAM21YdF0KrHXDNsESaQXvpUUz",
        "name": "Automation - AddIng an Action to the Workflow",
        "title": "Automation - AddIng an Action to the Workflow",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Automation - AddIng an Action to the Workflow",
          "input": {
            "variable_workflow_01TNRGULATIS12xwBtFh5vlzkvz7165Gb4O": "{\n  \"previous_action\": {\n    \"id\": \"$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\"\n  },\n  \"action\": {\n    \"type\": \"core.string2upper\",\n    \"base_type\": \"activity\",\n    \"name\": \"To Upper\",\n    \"properties\": {\n      \"continue_on_failure\": false,\n      \"skip_execution\": false,\n      \"source\": \"abc\",\n      \"display_name\": \"To Upper\"\n    },\n    \"title\": \"To Upper\"\n  }\n}",
            "variable_workflow_01TNRGULATYCS3YZOCTsAzqIqmW6pJXPjXH": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_01TNRGULAU5VJ5MZJeczlceLJVuSNTUGx9Y": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
            "variable_workflow_01TNRGULAUKSY47ElJvhRkMLUfZ28jBg6Hb": "Authorization"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
          "workflow_name": "Automation - AddIng an Action to the Workflow"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4RYHP9ECD37XxphaQ7AbvN1UDNeFiwUr",
        "name": "Automation - Validate Workflow",
        "title": "Automation - Validate Workflow",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Automation - Validate Workflow",
          "input": {
            "variable_workflow_026R3MTZOT2EW1USQRiDliyt5aa93GWmfiK": "Authorization",
            "variable_workflow_026R3MTZOTILC1W3cvTmVhLsJWBnHC3vcH4": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_026R3MTZOTPNC64XRWBcpmPc5VhBJBNaxj0": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
          "workflow_name": "Automation - Validate Workflow"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4S47DPWSU53cGObKlUFiuJfkrNfLdwco",
        "name": "Automation - Create a Priority Incident Rule",
        "title": "Automation - Create a Priority Incident Rule",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Automation - Create a Priority Incident Rule",
          "input": {
            "variable_workflow_027MR8CHBC18861hO5QjA8naySKiwdu2gyN": "pr-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$",
            "variable_workflow_027MR8CHBC96A1GWgiQyknzFoBdYsa57Emh": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
            "variable_workflow_027MR8CHBDRYU5sk9Lg2youqkRPg6xC0nRk": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_027MR8CHBDYW87eMO6SYumhX8GZuks1Avqv": false,
            "variable_workflow_027MR8CHBE5O23vojTUmq4Vl8h35vfIluId": "Authorization",
            "variable_workflow_027MRCJ2DP2UI35v7wyIVOskvXAKOfjKrR2": true,
            "variable_workflow_027MTARABH2P26oUCfYR8ctTuDRFybB13qe": "\"conditions\": {\n      \"operator\": \"mw\",\n      \"left_operand\": \"$output.incident.title$\",\n      \"right_operand\": \"pr 1253 rule history\"\n    },"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
          "workflow_name": "Automation - Create a Priority Incident Rule"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw",
        "name": "Automation - Create a Standalone Incident Rule",
        "title": "Automation - Create a Standalone Incident Rule",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Automation - Create a Standalone Incident Rule",
          "input": {
            "variable_workflow_027MPV5U2DIIF0zubA1M33SbdTCt6ZCzfq4": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
            "variable_workflow_027MPV5U2EFCD2dIXOMcCJfC8zTYKWhgvL0": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_027MPV5U2ETAA17CVQcWakhMZzhJv72iREN": "Authorization",
            "variable_workflow_027MQ2YZNQUVF083B0R4hBHunurAKbOgtJK": "st-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$",
            "variable_workflow_027MQ6J9U6SFN6iWZGzhPRXoQSwKfKnmVwO": false,
            "variable_workflow_027MTIDA440DM0hV6hVS0HKzyKm21K1dvp9": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": \"$output.incident.title$\",\n        \"operator\": \"mw\",\n        \"right_operand\": \"st 1253 rule history\"\n      },\n      \"operator\": \"and\",\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.scores.global$\",\n        \"operator\": \"eq\",\n        \"right_operand\": \"1000\"\n      }\n    },",
            "variable_workflow_028XFL5OHWNXK5o11JcxV0kSReACzV9dk57": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
          "workflow_name": "Automation - Create a Standalone Incident Rule"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4S4CPC449A6UHNqvahuRyuq6nQzYy8WL",
        "name": "Automation - Create a Approval Task Rule",
        "title": "Automation - Create a Approval Task Rule",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Automation - Create a Approval Task Rule",
          "input": {
            "variable_workflow_027MU5DP2Y0QV373c6xrE9AaxdSboy2UkdP": "Authorization",
            "variable_workflow_027MU5DP2YOOP2E2lqg74QpeLxjYfPFLd1E": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
            "variable_workflow_027MU5DP2YWPX7hppM5wy7ucaUEpzSiIPXs": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
            "variable_workflow_027MU5DP2ZG4M2M5RGKKfinZ7fnyMegq2Jh": false,
            "variable_workflow_027MU5DP2ZUUI2h5Puh47MrWHYptwjKKgzn": "\"conditions\": {\n      \"left_operand\": \"$output.subject_line$\",\n      \"operator\": \"mw\",\n      \"right_operand\": \"apr 1253 rule history\"\n    },",
            "variable_workflow_027MU5DP3026X6pquZ6e4iNBoMxOBGKJYGE": "apr-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$",
            "variable_workflow_02890TSOC3JQX0Ju9xWorvP0lcjMFEsf0SU": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
          "workflow_name": "Automation - Create a Approval Task Rule"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4U3ROOS7MP2Np8rMWGKYJRYg7wD0B8Sl",
        "name": "Execute Python Script",
        "title": "Fetch Start time for Schedule Rule",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Fetch Start time for Schedule Rule",
          "script": "import time\nfrom datetime import datetime\n\ncurrentTime_timestamp = time.time()\ncurrentTime = datetime.fromtimestamp(currentTime_timestamp    ).strftime(\"%Y-%m-%d %H:%M:%S\")\n\nnextTime = currentTime_timestamp + 60\n\nprint (str(datetime.fromtimestamp(nextTime).strftime(\"%H:%M\")))",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4U4ZKLTTYG59cMDCitkPfPPhnkdxoQhG",
        "name": "HTTP Request",
        "title": "Get Calendars",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "continue_on_error_status_code": false,
          "continue_on_failure": false,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
            }
          ],
          "display_name": "Get Calendars",
          "method": "GET",
          "relative_url": "api/v1/calendars",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4U5BS828EG52gzSrdgVRed3n8cHGJ69p",
        "name": "JSONPath Query",
        "title": "Fetch Calendars",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Fetch Calendars",
          "input_json": "$activity.definition_activity_02H4U4ZKLTTYG59cMDCitkPfPPhnkdxoQhG.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.[?(@.name=='Daily')].id",
              "jsonpath_query_name": "Daily_Cal_ID",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4U6AKR62R022RrkDDk01TpIJkf2s6h3t",
        "name": "HTTP Request",
        "title": "Create a Schedule Rule",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n\"description\":\"Created by Reusable Automation WF\",\n\"title\": \"Sch-Rule-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"name\": \"Sch-Rule-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"type\": \"schedule.rule_schedule\",\n\"rule_type\": \"rule_schedule\",\n\"properties\": {\n\"description\":\"Created by Reusable Automation WF\",\n\"disabled\":false,\n\"rule_type\": \"rule_schedule\",\n\"timezone\": \"Etc/GMT+0\",\n\"workflows_config\": [\n{\n\"disabled\": false,\n\"ref_id\": \"$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$\",\n\"wf_input_variables\": {}\n}\n],\n\"display_name\": \"Sch-Rule-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"calendar\": \"$activity.definition_activity_02H4U5BS828EG52gzSrdgVRed3n8cHGJ69p.output.jsonpath_queries.Daily_Cal_ID$\",\n\"starttime\": \"$activity.definition_activity_02H4U3ROOS7MP2Np8rMWGKYJRYg7wD0B8Sl.output.response_body$\",\n\"interval_minutes\":1,\n\"number_of_times\":2,\n\"title\": \"Sch-Rule-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\"\n}\n}",
          "continue_on_error_status_code": false,
          "continue_on_failure": false,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
            }
          ],
          "display_name": "Create a Schedule Rule",
          "method": "POST",
          "relative_url": "api/v1/rules",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4Z64YO9M3H7Li6pk16dBUz6lYYW2BVQj",
        "name": "JSONPath Query",
        "title": "Fetch Schedule Rule ID and Name",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": true,
          "display_name": "Fetch Schedule Rule ID and Name",
          "input_json": "$activity.definition_activity_02H4U6AKR62R022RrkDDk01TpIJkf2s6h3t.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.id",
              "jsonpath_query_name": "Schedule_Rule_ID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.name",
              "jsonpath_query_name": "Schedule_Rule_name",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02H4SH9FG6G225zUeUaDjXzZoR3dknIuea3",
        "name": "Group",
        "title": "Trigger WF",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Trigger WF",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02H4SKN03W5TH54yyE5TfWqzzZHFmbNv2tt",
            "name": "SX- Incident Creation (For Priority Rule)",
            "title": "SX- Incident Creation (For Priority Rule)",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "SX- Incident Creation (For Priority Rule)",
              "input": {
                "variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT": "{\n    \"source\": \"Umbrella\",\n    \"type\": \"bundle\",\n      \"incidents\":[\n          {\n              \"id\": \"transient:incident-$ID\",\n              \"title\": \"title-pr 1253 rule history-Automation Rule Testing\",\n              \"description\": \"In this scenario, the incident is submitted with only one technique but no tactic. In such a case, the tactics must be inferred at import from the submitted techniques, and the incident shall present the inferred tactics with these techniques in the financial risk tab.\",\n              \"type\": \"incident\",\n              \"source\": \"Umbrella\",\n              \"short_description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n              \"status\": \"New\",\n              \"promotion_method\": \"Automated\",\n              \"severity\": \"Critical\",\n              \"confidence\": \"High\",\n              \"incident_time\":{\"opened\": \"$Time\"}\n          }\n\n      ],\n      \"sightings\":[\n        {\n              \"description\": \"DNS request for 'examplebotnetdomain.com' made by 'ksimek-WS' (Roaming Computers)\",\n              \"id\": \"transient:sighting-1\",\n              \"observables\":\n              [\n                  {\n                      \"value\": \"examplebotnetdomain.com\",\n                      \"type\": \"domain\"\n                  }\n              ],\n              \"observed_time\":\n              {\n                  \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                  \"end_time\": \"2022-09-13T14:21:20.000Z\"\n              },\n              \"severity\": \"Low\",\n              \"source\": \"Umbrella Reporting API\",\n              \"source_uri\": \"https://dashboard.umbrella.com/o/1869975/#/reports/activity?encodedFilters=eyJzZWxlY3RlZERhdGVSYW5nZUlkeCI6MCwiZG9tYWluIjoiZXhhbXBsZWJvdG5ldGRvbWFpbi5jb20ifQ==\",\n              \"targets\":\n              [\n                  {\n                      \"type\": \"endpoint\",\n                      \"observables\":\n                      [\n                          {\n                              \"value\": \"41137871\",\n                              \"type\": \"odns_identity\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"odns_identity_label\"\n                          },\n                          {\n                              \"value\": \"35.169.125.172\",\n                              \"type\": \"ip\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"hostname\"\n                          }\n                      ],\n                      \"observed_time\":\n                      {\n                          \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                          \"end_time\": \"2022-09-13T14:21:20.000Z\"\n                      }\n                  }\n              ],\n            \"type\": \"sighting\"\n        }\n      ],\n    \"indicators\": [\n      {\n        \"description\": \"Several activities that reflect Command and Control behavior were detected on the same target in limited amount of time\",\n        \"valid_time\": {\n          \"start_time\": \"2022-04-01T00:00:00.000Z\"\n        },\n        \"producer\": \"Umbrella\",\n        \"type\": \"indicator\",\n        \"source\": \"Umbrella\",\n        \"external_ids\": [\n          \"securex:umbrella-threat-hunt-c\u0026c\"\n        ],\n        \"short_description\": \"Command and Control activities detected by DNS protection.\",\n        \"title\": \"Command and Control DNS activities\",\n        \"id\": \"transient:indicator-umbrella-c\u0026c\",\n        \"tlp\": \"green\"\n      }\n    ],\n    \"attack_patterns\": [\n        {\n            \"description\": \"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. \",\n            \"type\": \"attack-pattern\",\n            \"source\": \"MITRE Enterprise ATT\u0026CK\",\n            \"external_ids\": [\n                \"T1071\"\n            ],\n            \"short_description\": \"Application Layer Protocol\",\n            \"title\": \"Application Layer Protocol\",\n            \"external_references\": [\n                {\n                    \"source_name\": \"mitre-attack\",\n                    \"url\": \"https://attack.mitre.org/techniques/T1071\",\n                    \"external_id\": \"T1071\"\n                }\n            ],\n            \"source_uri\": \"https://attack.mitre.org\",\n            \"id\": \"transient:attack-pattern-T1071\",\n            \"kill_chain_phases\": [\n                {\n                    \"kill_chain_name\": \"mitre-attack\",\n                    \"phase_name\": \"command-and-control\"\n                },\n                {\n                    \"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n                    \"phase_name\": \"command-and-control\"\n                }\n            ]\n        }\n    ],\n    \"relationships\": [\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-indicator-T1071\",\n        \"source_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"target_ref\": \"transient:attack-pattern-T1071\",\n        \"relationship_type\": \"indicates\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-indicator\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"relationship_type\": \"sighting-of\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-incident\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:incident-2\",\n        \"relationship_type\": \"member-of\"\n      }\n    ]\n  }\n",
                "variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target": true,
                "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
                "target_type": "web-service.endpoint"
              },
              "workflow_id": "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
              "workflow_name": "SX- Incident Creation"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4SLATLLGL067Prs0ZhZllcHg7OrEcAGN",
            "name": "Sleep",
            "title": "Wait for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4SL5JEA23S6OLbnU1T7AQHWNU46YeZTI",
            "name": "SX- Incident Creation (For Standalone Rule)",
            "title": "SX- Incident Creation (For Standalone Rule)",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "SX- Incident Creation (For Standalone Rule)",
              "input": {
                "variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT": "{\n    \"source\": \"Umbrella\",\n    \"type\": \"bundle\",\n      \"incidents\":[\n          {\n              \"id\": \"transient:incident-2\",\n              \"title\": \"title-st 1253 rule history-Automation Rule Testing\",\n              \"description\": \"In this scenario, the incident is submitted with only one technique but no tactic. In such a case, the tactics must be inferred at import from the submitted techniques, and the incident shall present the inferred tactics with these techniques in the financial risk tab.\",\n              \"type\": \"incident\",\n              \"source\": \"Umbrella\",\n              \"short_description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n              \"status\": \"New\",\n              \"promotion_method\": \"Automated\",\n              \"severity\": \"Critical\",\n              \"confidence\": \"High\",\n              \"incident_time\":{\"opened\": \"$Time\"}\n          }\n\n      ],\n      \"sightings\":[\n        {\n              \"description\": \"DNS request for 'examplebotnetdomain.com' made by 'ksimek-WS' (Roaming Computers)\",\n              \"id\": \"transient:sighting-1\",\n              \"observables\":\n              [\n                  {\n                      \"value\": \"examplebotnetdomain.com\",\n                      \"type\": \"domain\"\n                  }\n              ],\n              \"observed_time\":\n              {\n                  \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                  \"end_time\": \"2022-09-13T14:21:20.000Z\"\n              },\n              \"severity\": \"Low\",\n              \"source\": \"Umbrella Reporting API\",\n              \"source_uri\": \"https://dashboard.umbrella.com/o/1869975/#/reports/activity?encodedFilters=eyJzZWxlY3RlZERhdGVSYW5nZUlkeCI6MCwiZG9tYWluIjoiZXhhbXBsZWJvdG5ldGRvbWFpbi5jb20ifQ==\",\n              \"targets\":\n              [\n                  {\n                      \"type\": \"endpoint\",\n                      \"observables\":\n                      [\n                          {\n                              \"value\": \"41137871\",\n                              \"type\": \"odns_identity\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"odns_identity_label\"\n                          },\n                          {\n                              \"value\": \"35.169.125.172\",\n                              \"type\": \"ip\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"hostname\"\n                          }\n                      ],\n                      \"observed_time\":\n                      {\n                          \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                          \"end_time\": \"2022-09-13T14:21:20.000Z\"\n                      }\n                  }\n              ],\n            \"type\": \"sighting\"\n        }\n      ],\n    \"indicators\": [\n      {\n        \"description\": \"Several activities that reflect Command and Control behavior were detected on the same target in limited amount of time\",\n        \"valid_time\": {\n          \"start_time\": \"2022-04-01T00:00:00.000Z\"\n        },\n        \"producer\": \"Umbrella\",\n        \"type\": \"indicator\",\n        \"source\": \"Umbrella\",\n        \"external_ids\": [\n          \"securex:umbrella-threat-hunt-c\u0026c\"\n        ],\n        \"short_description\": \"Command and Control activities detected by DNS protection.\",\n        \"title\": \"Command and Control DNS activities\",\n        \"id\": \"transient:indicator-umbrella-c\u0026c\",\n        \"tlp\": \"green\"\n      }\n    ],\n    \"attack_patterns\": [\n        {\n            \"description\": \"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. \",\n            \"type\": \"attack-pattern\",\n            \"source\": \"MITRE Enterprise ATT\u0026CK\",\n            \"external_ids\": [\n                \"T1071\"\n            ],\n            \"short_description\": \"Application Layer Protocol\",\n            \"title\": \"Application Layer Protocol\",\n            \"external_references\": [\n                {\n                    \"source_name\": \"mitre-attack\",\n                    \"url\": \"https://attack.mitre.org/techniques/T1071\",\n                    \"external_id\": \"T1071\"\n                }\n            ],\n            \"source_uri\": \"https://attack.mitre.org\",\n            \"id\": \"transient:attack-pattern-T1071\",\n            \"kill_chain_phases\": [\n                {\n                    \"kill_chain_name\": \"mitre-attack\",\n                    \"phase_name\": \"command-and-control\"\n                },\n                {\n                    \"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n                    \"phase_name\": \"command-and-control\"\n                }\n            ]\n        }\n    ],\n    \"relationships\": [\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-indicator-T1071\",\n        \"source_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"target_ref\": \"transient:attack-pattern-T1071\",\n        \"relationship_type\": \"indicates\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-indicator\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"relationship_type\": \"sighting-of\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-incident\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:incident-2\",\n        \"relationship_type\": \"member-of\"\n      }\n    ]\n  }",
                "variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target": true,
                "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
                "target_type": "web-service.endpoint"
              },
              "workflow_id": "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
              "workflow_name": "SX- Incident Creation"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z",
            "name": "Automation - Import a Workflow",
            "title": "Automation - Import a Workflow",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Automation - Import a Workflow",
              "input": {
                "variable_workflow_026YHB9OQ3HWP4aN0vx8H1V1rJIPbsEahC6": "Authorization",
                "variable_workflow_026YHBEI8ZSWW19gG1iJKan8o6QXER4fAwr": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_026YHBVWX7WMF6AcYrN4Mo5s2BnACgClrNf": "{\n\"workflow\": {\n\"unique_name\": \"definition_workflow_0288V039KBU7P26OwuKwvqy3QZ2fg5W8GmS\",\n\"name\": \"Approval-Request-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"title\": \"Approval-Request-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"type\": \"generic.workflow\",\n\"base_type\": \"workflow\",\n\"variables\": null,\n\"properties\": {\n\"atomic\": {\n\"is_atomic\": false\n},\n\"delete_workflow_instance\": false,\n\"display_name\": \"Approval-Request-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$\",\n\"runtime_user\": {\n\"target_default\": true\n},\n\"target\": {\n\"no_target\": true\n}\n},\n\"object_type\": \"definition_workflow\",\n\"actions\": [\n{\n\"unique_name\": \"definition_activity_0288V07IIVXXM6v1oqp4c5ABHz9rGKo3XrK\",\n\"name\": \"Create Approval Request\",\n\"title\": \"Create Approval Request\",\n\"type\": \"task.approval_request\",\n\"base_type\": \"activity\",\n\"properties\": {\n\"approval_choices\": [\n\"Approve\",\n\"Reject\"\n],\n\"assignees\": [\n\"vspancha@cisco.com\"\n],\n\"continue_on_failure\": false,\n\"display_name\": \"Create Approval Request\",\n\"due_date\": {\n\"is_relative_time\": true,\n\"relative_time\": {\n\"duration\": 15,\n\"time_units\": \"days\"\n},\n\"set_due_date\": true\n},\n\"expiration_date\": {\n\"is_relative_time\": true,\n\"relative_time\": {\n\"duration\": 15,\n\"time_units\": \"days\"\n}\n},\n\"expiration_status\": \"Expired\",\n\"minimum_approvals\": 1,\n\"priority\": \"high\",\n\"skip_execution\": false,\n\"subject_line\": \"Approval apr 1253 rule history Message\",\n\"task_message\": \"Approved\",\n\"task_owner\": \"vspancha@cisco.com\",\n\"task_requestor\": \"vspancha@cisco.com\"\n},\n\"object_type\": \"definition_activity\"\n}\n],\n\"categories\": [\n\"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf\"\n]\n}\n}",
                "variable_workflow_026Z2CUSXYZUP7CfGKMtqXdZf1PoKpCnqTQ": false,
                "variable_workflow_026Z2D4W3D6B73HR94LIqetofp263GiaCxF": true,
                "variable_workflow_026Z2DJMCM2QS65COEebrKJrHjYuVcFqUyW": "definition_workflow_0288V039KBU7P26OwuKwvqy3QZ2fg5W8GmS"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_026YHAFYUYJSI57lobBfWruQIXVfnumQPnC",
              "workflow_name": "Automation - Import a Workflow"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4SMIJ9A72G0t6Dy46DarvQnjk3AYZhFe",
            "name": "Automation - Validate Workflow",
            "title": "Automation - Validate Workflow",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Automation - Validate Workflow",
              "input": {
                "variable_workflow_026R3MTZOT2EW1USQRiDliyt5aa93GWmfiK": "Authorization",
                "variable_workflow_026R3MTZOTILC1W3cvTmVhLsJWBnHC3vcH4": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_026R3MTZOTPNC64XRWBcpmPc5VhBJBNaxj0": "$activity.definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z.output.variable_workflow_026YHD0WACZ1F1xGmmAahjuT0jcvHs0UQav$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
              "workflow_name": "Automation - Validate Workflow"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4SMX0IGYYQ2x7QWjoQyNVWqyQMeMjN7J",
            "name": "XDR-Atomic-Run Workflow",
            "title": "XDR-Atomic-Run Workflow",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR-Atomic-Run Workflow",
              "input": {
                "variable_workflow_02EWMJX5JA8QH6VblKxnms2YxVNUePRBPYt": "$activity.definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z.output.variable_workflow_026YHD0WACZ1F1xGmmAahjuT0jcvHs0UQav$",
                "variable_workflow_02EWMM6FM8FAD131fhlN3xQuL4bXykhWsSJ": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02EWMJH91A7RX6ISkLYJqlPHNGGEaWi0wjG",
              "workflow_name": "XDR-Atomic-Run Workflow"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI",
            "name": "For Each",
            "title": "For Each -- Webhook Creation and Execution",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For Each -- Webhook Creation and Execution",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.local.variable_workflow_02H5V9NY600LU6kLcm3k7INklafI0sB0mlf$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3",
                "name": "Automation - Create Webhook",
                "title": "Automation - Create Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create Webhook",
                  "input": {
                    "variable_workflow_027P5JFQ0SDKR6MoGg5qxaOLoqiaWHkkoYq": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$ ",
                    "variable_workflow_027P5JFQ0T3TB64EqngIu50Y9q0SkpVr6yd": "Authorization",
                    "variable_workflow_027P5JFQ0TAUB6yI2eLlWXZkMomsSYVKq0r": "$activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].type$-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$ ",
                    "variable_workflow_027P5O8M6T5BM1LlSSC5COdB66Myv1Bi81T": "$activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].webhook_type$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
                  "workflow_name": "Automation - Create Webhook"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4SP1OB18VO48pGiqrS41PRyMXLqndFEe",
                "name": "Split String",
                "title": "Split String",
                "type": "core.splitstring",
                "base_type": "activity",
                "properties": {
                  "boundaries": [
                    {
                      "boundary": "/webhooks"
                    }
                  ],
                  "continue_on_failure": false,
                  "display_name": "Split String",
                  "input_string": "$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027Q7TGYUX78D01oVFV3Qr5akvhgBUhJJkd$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4S4IRPHVQJ77jriS6VVVbKtBzwkNXcpJ",
                "name": "Automation - Create a Webhook Rule",
                "title": "Automation - Create a Webhook Rule",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create a Webhook Rule",
                  "input": {
                    "variable_workflow_027P45D44BNVE2w76s6EPAIDPhPBKNiSA8b": false,
                    "variable_workflow_027P45D44CF1A4tEsHLpvO2STimcIcVhrJt": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                    "variable_workflow_027P45D44CNAZ6angvnRBAs2qfCCDdUu8ci": "$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027P5JFQ0SP106SOaK9zDE4KzgITsplp9Tk$",
                    "variable_workflow_027P45D44D1BO6VaE0q6IvWEztPJg3h0hIS": "\"conditions\": {\n      \"left_operand\": \"$output.request_body$\",\n      \"operator\": \"mw\",\n      \"right_operand\": \"1253 rule history\"\n    },",
                    "variable_workflow_027P45D44DMB477bxyEMolVkSG1vM9kCrAK": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_027P45D44DTL82ccunZl1nVPIB2nzGAM2S9": "Authorization",
                    "variable_workflow_027P45D44E9AA7Ww5VxYXs0OBcaz6zQJGT8": "wh-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$",
                    "variable_workflow_028SFNZF9E80K2Ply4MsV48QvpSgsi0DPx2": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v",
                  "workflow_name": "Automation - Create a Webhook Rule"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5TJHBPVUD23eWRBaKHPTUSUN0UMZNk8t",
                "name": "Add Row to Table",
                "title": "Add Webhook IDs",
                "type": "core.addrowtotable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Add Webhook IDs",
                  "input_table": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.local.variable_workflow_02H5U1UJQZ0CO5lcFlSnFuLYsyeDKR9xfCQ$",
                  "row": [
                    {
                      "key": "ID",
                      "type": "string",
                      "value": "$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027P5JFQ0SP106SOaK9zDE4KzgITsplp9Tk$"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5U2EXLS4B06C4gwFfmWh1cRscXdrt3VB",
                "name": "Add Row to Table",
                "title": "Add Webhook Rule IDs",
                "type": "core.addrowtotable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Add Webhook Rule IDs",
                  "input_table": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.local.variable_workflow_02H5U1PRFCCAM1v32c88DEfhm2PGLmqGC9Y$",
                  "row": [
                    {
                      "key": "ID",
                      "type": "string",
                      "value": "$activity.definition_activity_02H4S4IRPHVQJ77jriS6VVVbKtBzwkNXcpJ.output.variable_workflow_027P45D44EMQT6prZ0rwy4cStIRPlsfpFcU$"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5TOV5FSL347Yn0amPga2zXJduRgo9Sj0",
                "name": "Sleep",
                "title": "Sleep for 10s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 10s",
                  "skip_execution": false,
                  "sleep_interval": 10
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4SNF9K4XXZ4nQhQVhZ89dINlSjPcRQAo",
                "name": "Execute Python Script",
                "title": "Execute Webhook API",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Execute Webhook API",
                  "script": "import requests\n\nurl = \"$activity.definition_activity_02H4SP1OB18VO48pGiqrS41PRyMXLqndFEe.output.parts[0]$/webhooks/$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027P5JFQ0SP106SOaK9zDE4KzgITsplp9Tk$\"\n\nquerystring = {\"api_key\":\"$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027QB1203EA8L2esNnMu54NvRsQLHdiT14N$\"}\n\npayload = $activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].payload$\nheaders = {\"Content-Type\": \"$activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].webhook_type$\"}\nresponse = requests.request(\"POST\", url, json=payload, headers=headers, params=querystring)\n\nprint(response.text)",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5U2WEXX90V7h4Kj1URwH21CzbbZ6y241",
                "name": "Condition Block",
                "title": "Verify Webhook Creation",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verify Webhook Creation",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H5U2WF5TFDL3KWO3rdliywvBnTDQrJJLY",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": "$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027P5JFQ0SWTJ2I79pB4n0bvmPFT8EcvMUf$",
                            "operator": "eq",
                            "right_operand": "true"
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4S4IRPHVQJ77jriS6VVVbKtBzwkNXcpJ.output.variable_workflow_027P45D44E1RA54uggwqHMNC1mRSe5wScXz$",
                            "operator": "eq",
                            "right_operand": "true"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4SNF9K4XXZ4nQhQVhZ89dINlSjPcRQAo.output.error.code$",
                          "operator": "eq",
                          "right_operand": "200"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H5U39NUHYFC3LHYwvvaR2MWtWvhuZrVsL",
                        "name": "Add Row to Table",
                        "title": "PassCase",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "PassCase",
                          "input_table": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5TFL232AQJ2N5D8noGi21ozHawU93iCf$",
                          "row": [
                            {
                              "key": "Webhook_Type",
                              "type": "string",
                              "value": "$activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].type$"
                            },
                            {
                              "key": "TestResults",
                              "type": "string",
                              "value": "Pass"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_02H5U4KZJ0XW05QHn4Trh9C8w6mta5DGMN2",
                    "name": "Condition Branch",
                    "title": "FailCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": "$activity.definition_activity_02H4S4HFP2XB94bWS7kF61t0O7MhLCkvjX3.output.variable_workflow_027P5JFQ0SWTJ2I79pB4n0bvmPFT8EcvMUf$",
                            "operator": "ne",
                            "right_operand": "true"
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4S4IRPHVQJ77jriS6VVVbKtBzwkNXcpJ.output.variable_workflow_027P45D44E1RA54uggwqHMNC1mRSe5wScXz$",
                            "operator": "ne",
                            "right_operand": "true"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4SNF9K4XXZ4nQhQVhZ89dINlSjPcRQAo.output.error.code$",
                          "operator": "ne",
                          "right_operand": "200"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "FailCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H5U4KZJ1L793wozsqKatxT5g9D0qNqUuJ",
                        "name": "Add Row to Table",
                        "title": "FailCase",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "FailCase",
                          "input_table": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5TFL232AQJ2N5D8noGi21ozHawU93iCf$",
                          "row": [
                            {
                              "key": "Webhook_Type",
                              "type": "string",
                              "value": "$activity.definition_activity_02H5TCAC1EARM2L81cNeRDwZ8ZiyzlNpSJI.input.source_array[@].type$"
                            },
                            {
                              "key": "TestResults",
                              "type": "string",
                              "value": "Pass"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H5U5DJH5XGS4cNf30JgQYun2AZhF3B9yI",
            "name": "Select from Table",
            "title": "Select from Table",
            "type": "core.selectfromtable",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "columns": [
                {
                  "column_name": "TestResults",
                  "column_type": "string"
                }
              ],
              "continue_on_failure": false,
              "display_name": "Select from Table",
              "input_table": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5TFL232AQJ2N5D8noGi21ozHawU93iCf$",
              "number_of_rows": {
                "all_rows": true
              },
              "persist_output": false,
              "skip_execution": false,
              "sorting": {
                "no_sort": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5U67ZIFAB94184nBHEuaUmZTa6B7I2N0",
            "name": "Condition Block",
            "title": "Enter this Block Only When table has Fail value",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "conditions": [],
              "continue_on_failure": false,
              "display_name": "Enter this Block Only When table has Fail value",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02H5U67ZUQ2S96aB63UlP4eO93UzMxZhxk3",
                "name": "Condition Branch",
                "title": "Yes , There is Failure",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_02H5U5DJH5XGS4cNf30JgQYun2AZhF3B9yI.output.response_body$",
                    "operator": "mregex",
                    "right_operand": ".*Fail"
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes , There is Failure",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02H5U8GSULHDN0iu3YGlOUA1NRisGdMXjzH",
                    "name": "Set Variables",
                    "title": "Failed",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5U7ZX3CE074UUkMZ9BwzIitfgU97X6hl$",
                          "variable_value_new": "Fail"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H4SLFUN4NM12NtWBUYWTk4oBq8jbZq7jv",
            "name": "Sleep",
            "title": "Wait for 30s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for 30s",
              "skip_execution": false,
              "sleep_interval": 30
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_02H4ZB7CLMQIC3lEUyfagJQxJbQENUkQgn0",
        "name": "Parallel Block",
        "title": "Rule History API to Check for All types",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Rule History API to Check for All types",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02H4ZB7CT29WA4MYpiWjTFhBPD09lRJqooc",
            "name": "Parallel Branch",
            "title": "Standalone Incident",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Standalone Incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4US0UWKSIN26N8pyscMJFns1J1lCwGss",
                "name": "XDR-1253-Rule History Reusable WF",
                "title": "XDR-1253-Rule History Reusable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR-1253-Rule History Reusable WF",
                  "input": {
                    "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 2,
                    "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "incident.rule_event"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
                  "workflow_name": "XDR-1253-Rule History Reusable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZQUKS205P3HVf8VJaVowwFDO99r4Axr",
                "name": "JSONPath Query",
                "title": "Fetch Details from Rule history Response",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Details from Rule history Response",
                  "input_json": "$activity.definition_activity_02H4US0UWKSIN26N8pyscMJFns1J1lCwGss.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-st 1253 rule history-Automation Rule Testing')].event_name",
                      "jsonpath_query_name": "Standalone_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-st 1253 rule history-Automation Rule Testing')].matched_rule_count",
                      "jsonpath_query_name": "Standalone_MatchedRuleCount",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-st 1253 rule history-Automation Rule Testing')].type",
                      "jsonpath_query_name": "Standalone_EventType",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FMDHAXL0U4Yl6QwkpWfbV7C2cFFLUDg",
                "name": "SXO- Get Workflow Instances (V1.1 )",
                "title": "SXO- Get Workflow Instances (V1.1 )",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "SXO- Get Workflow Instances (V1.1 )",
                  "input": {
                    "variable_workflow_01UI12PFBGGMI46GosPCeAfs97cuhRV2HPO": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                    "variable_workflow_01UI14NPSPU7K4lnWpU0bRq4sAvBh6mrbpD": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq",
                  "workflow_name": "SXO- Get Workflow Instances (V1.1 )"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FMVE9CJCY75twR7cLxfjzs38tvBWDS3",
                "name": "JSONPath Query",
                "title": "Fetch the InstanceID",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch the InstanceID",
                  "input_json": "$activity.definition_activity_02H5FMDHAXL0U4Yl6QwkpWfbV7C2cFFLUDg.output.variable_workflow_01UJCX408QPTU6sQRcRQVhUxy2CNGkTkscO$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                      "jsonpath_query_name": "InsatnceID_for_St_rule",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FOSQH6N203j180wCgHa5xKP0vPDTsSn",
                "name": "Calculate Date",
                "title": "Calculate Date",
                "type": "core.calculate_date",
                "base_type": "activity",
                "properties": {
                  "adjustment": -86400,
                  "continue_on_failure": false,
                  "display_name": "Calculate Date",
                  "original_date": "$activity.definition_activity_02H4SL5JEA23S6OLbnU1T7AQHWNU46YeZTI.output.end_time$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FOIJ5KB5H5Kkw43EUWO6lOTyZZVXz6o",
                "name": "HTTP Request",
                "title": "Fetch Runs Instance Using instance ID (New API)",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"owner\": [],\n  \"instance_ids\": [\n    \"$activity.definition_activity_02H5FMVE9CJCY75twR7cLxfjzs38tvBWDS3.output.jsonpath_queries.InsatnceID_for_St_rule$\"\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                    }
                  ],
                  "display_name": "Fetch Runs Instance Using instance ID (New API)",
                  "method": "POST",
                  "relative_url": "/api/v1.1/instances?limit=24\u0026start=0\u0026date_from=$activity.definition_activity_02H5FOSQH6N203j180wCgHa5xKP0vPDTsSn.output.result$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FQMZQ0SD03mXiBm0wITKS6bPQ2Cp1xT",
                "name": "JSONPath Query",
                "title": "Fetch Instance Details from New API",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Fetch Instance Details from New API",
                  "input_json": "$activity.definition_activity_02H5FOIJ5KB5H5Kkw43EUWO6lOTyZZVXz6o.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].definition_id",
                      "jsonpath_query_name": "workflow_id",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].started_by",
                      "jsonpath_query_name": "started_by",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                      "jsonpath_query_name": "instance_ID",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H5FPY28IGRL1SvjE2uMSWVAS4kHhtOCYO",
                "name": "HTTP Request",
                "title": "Delete Instances",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                    }
                  ],
                  "display_name": "Delete Instances",
                  "method": "DELETE",
                  "relative_url": "/api/v1/instances/$activity.definition_activity_02H5FMVE9CJCY75twR7cLxfjzs38tvBWDS3.output.jsonpath_queries.InsatnceID_for_St_rule$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZYPRCDNUG2lpCorQrTRVMHPT0Mt4on6",
                "name": "Condition Block",
                "title": "Verification for Standalone Rule History",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verification for Standalone Rule History",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H4ZYPRN1JZV3Qagq9R4ZKpsv6NJjDFkw4",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": "$activity.definition_activity_02H4US0UWKSIN26N8pyscMJFns1J1lCwGss.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                          "operator": "eq",
                                          "right_operand": "Pass"
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H4ZQUKS205P3HVf8VJaVowwFDO99r4Axr.output.jsonpath_queries.Standalone_EventName$",
                                          "operator": "eq",
                                          "right_operand": "title-st 1253 rule history-Automation Rule Testing"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H4ZQUKS205P3HVf8VJaVowwFDO99r4Axr.output.jsonpath_queries.Standalone_EventType$",
                                        "operator": "eq",
                                        "right_operand": "incident.rule_event"
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H4ZQUKS205P3HVf8VJaVowwFDO99r4Axr.output.jsonpath_queries.Standalone_MatchedRuleCount$",
                                      "operator": "eq",
                                      "right_operand": "1"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H5FMDHAXL0U4Yl6QwkpWfbV7C2cFFLUDg.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                                    "operator": "eq",
                                    "right_operand": "true"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H5FMVE9CJCY75twR7cLxfjzs38tvBWDS3.output.jsonpath_queries.InsatnceID_for_St_rule$",
                                  "operator": "eq",
                                  "right_operand": "$activity.definition_activity_02H5FQMZQ0SD03mXiBm0wITKS6bPQ2Cp1xT.output.jsonpath_queries.instance_ID$"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H5FOIJ5KB5H5Kkw43EUWO6lOTyZZVXz6o.output.error.code$",
                                "operator": "eq",
                                "right_operand": "200"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H5FQMZQ0SD03mXiBm0wITKS6bPQ2Cp1xT.output.jsonpath_queries.started_by$",
                              "operator": "eq",
                              "right_operand": "$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H5FQMZQ0SD03mXiBm0wITKS6bPQ2Cp1xT.output.jsonpath_queries.workflow_id$",
                            "operator": "eq",
                            "right_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H5FPY28IGRL1SvjE2uMSWVAS4kHhtOCYO.output.error.code$",
                          "operator": "eq",
                          "right_operand": "200"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H4ZZ76PE2LH2VMfGsRlkfZAa0KQRShRSd",
                        "name": "Set Variables",
                        "title": "Pass",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Pass",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZXVDBUXJF5bFOffjU7IpF4L3UezPF2Y$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H4ZB7D2NXKU7bLadWJqA2FrunrM693i0g",
            "name": "Parallel Branch",
            "title": "Priority Incident",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Priority Incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4ZCC4G6JI24lv6RkSKz1PBbMIdE3gyRG",
                "name": "XDR-1253-Rule History Reusable WF",
                "title": "XDR-1253-Rule History Reusable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR-1253-Rule History Reusable WF",
                  "input": {
                    "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 2,
                    "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "incident.rule_event"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
                  "workflow_name": "XDR-1253-Rule History Reusable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZTABTE7R40ZA89M2KgAAJziBUqn8xv9",
                "name": "JSONPath Query",
                "title": "Fetch Details from Rule history Response",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Details from Rule history Response",
                  "input_json": "$activity.definition_activity_02H4ZCC4G6JI24lv6RkSKz1PBbMIdE3gyRG.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-pr 1253 rule history-Automation Rule Testing')].event_name",
                      "jsonpath_query_name": "Priority_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-pr 1253 rule history-Automation Rule Testing')].matched_rule_count",
                      "jsonpath_query_name": "Priority_MatchedRuleCount",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='title-pr 1253 rule history-Automation Rule Testing')].type",
                      "jsonpath_query_name": "Priority_EventType",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZZBIDQKG54RTVVT0TqdgXBw1uF7MxDq",
                "name": "Condition Block",
                "title": "Verification for Priority Rule History",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verification for Priority Rule History",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H4ZZBIDRCZT1Lsy74ZdSU1lL5IE7qpIf0",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZCC4G6JI24lv6RkSKz1PBbMIdE3gyRG.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                              "operator": "eq",
                              "right_operand": "Pass"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZTABTE7R40ZA89M2KgAAJziBUqn8xv9.output.jsonpath_queries.Priority_EventName$",
                              "operator": "eq",
                              "right_operand": "title-pr 1253 rule history-Automation Rule Testing"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4ZTABTE7R40ZA89M2KgAAJziBUqn8xv9.output.jsonpath_queries.Priority_EventType$",
                            "operator": "eq",
                            "right_operand": "incident.rule_event"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4ZTABTE7R40ZA89M2KgAAJziBUqn8xv9.output.jsonpath_queries.Priority_MatchedRuleCount$",
                          "operator": "eq",
                          "right_operand": "1"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H4ZZBIDT9J05U6Q0GkAW9Ut1b3Oawuaib",
                        "name": "Set Variables",
                        "title": "Pass",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Pass",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY1DZY3GL2ngObjIuHrjjFsJc2bDBcS$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H4ZBVLKKYUF3BQmugYxeDO0ATuYSf4SEh",
            "name": "Parallel Branch",
            "title": "Approval Incident",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Approval Incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4ZCENNMFI60ChOkgVyQrHJNoPO2tyKua",
                "name": "XDR-1253-Rule History Reusable WF",
                "title": "XDR-1253-Rule History Reusable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR-1253-Rule History Reusable WF",
                  "input": {
                    "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 1,
                    "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "approval_task.rule_event"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
                  "workflow_name": "XDR-1253-Rule History Reusable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZU88EF4M05gTxbJP0CBDCSoLccIhtT3",
                "name": "JSONPath Query",
                "title": "Fetch Details from Rule history Response",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Details from Rule history Response",
                  "input_json": "$activity.definition_activity_02H4ZCENNMFI60ChOkgVyQrHJNoPO2tyKua.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..event_name",
                      "jsonpath_query_name": "Approval_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$..matched_rule_count",
                      "jsonpath_query_name": "Approval_MatchedRuleCount",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$..type",
                      "jsonpath_query_name": "Approval_EventType",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZZGBH67OV0vYLQkb1gawoHk8jemzhik",
                "name": "Condition Block",
                "title": "Verification for Approval Rule History",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verification for Approval Rule History",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H4ZZGBH73U70DbNlFjbatY671JqPo7bw1",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZCENNMFI60ChOkgVyQrHJNoPO2tyKua.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                              "operator": "eq",
                              "right_operand": "Pass"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZU88EF4M05gTxbJP0CBDCSoLccIhtT3.output.jsonpath_queries.Approval_EventName$",
                              "operator": "eq",
                              "right_operand": "Approval Task: Approval apr 1253 rule history Message"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4ZU88EF4M05gTxbJP0CBDCSoLccIhtT3.output.jsonpath_queries.Approval_EventType$",
                            "operator": "eq",
                            "right_operand": "approval_task.rule_event"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4ZU88EF4M05gTxbJP0CBDCSoLccIhtT3.output.jsonpath_queries.Approval_MatchedRuleCount$",
                          "operator": "eq",
                          "right_operand": "1"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H4ZZGBH8A892ef9XkCniOBqOddCOCtU8m",
                        "name": "Set Variables",
                        "title": "Pass",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Pass",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY7QN9QVT0lw2MiaYuNnM0fe07OcfCY$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H4ZBYQ4QT4Z03w7fDhLrhxAeu6QT0mfig",
            "name": "Parallel Branch",
            "title": "Webhook Incident",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Webhook Incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4ZCH2IE3NY5Sq9qrpzzrgoHfvKKw0yGU",
                "name": "XDR-1253-Rule History Reusable WF",
                "title": "XDR-1253-Rule History Reusable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR-1253-Rule History Reusable WF",
                  "input": {
                    "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 4,
                    "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "webhook.rule_event"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
                  "workflow_name": "XDR-1253-Rule History Reusable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7",
                "name": "JSONPath Query",
                "title": "Fetch Details from Rule history Response",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Details from Rule history Response",
                  "input_json": "$activity.definition_activity_02H4ZCH2IE3NY5Sq9qrpzzrgoHfvKKw0yGU.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.[?(@.event_name=='json-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].event_name",
                      "jsonpath_query_name": "json_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='json-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].matched_rule_count",
                      "jsonpath_query_name": "json_MatchedRuleCount",
                      "jsonpath_query_type": "integer",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='json-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].type",
                      "jsonpath_query_name": "json_EventType",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='xml-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].event_name",
                      "jsonpath_query_name": "XML_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='xml-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].matched_rule_count",
                      "jsonpath_query_name": "XML_matched_rule_count",
                      "jsonpath_query_type": "integer",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='xml-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].type",
                      "jsonpath_query_name": "XML_type",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='utf8-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].event_name",
                      "jsonpath_query_name": "UTF8_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='utf8-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].matched_rule_count",
                      "jsonpath_query_name": "UTF8_matched_rule_count",
                      "jsonpath_query_type": "integer",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='utf8-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].type",
                      "jsonpath_query_name": "UTF8_type",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='urlencoded-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].event_name",
                      "jsonpath_query_name": "URLEncoded_event_name",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='urlencoded-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].matched_rule_count",
                      "jsonpath_query_name": "URLEncoded_matched_rule_count",
                      "jsonpath_query_type": "integer"
                    },
                    {
                      "jsonpath_query": "$.[?(@.event_name=='urlencoded-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$')].type",
                      "jsonpath_query_name": "URLEncoded_type",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZZLL9RBPP0o0BKTzxID2QyB8IVhZkTn",
                "name": "Condition Block",
                "title": "Verification for Webhook Rule History",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verification for Webhook Rule History",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H4ZZLL9RZLA4lWM0N4cgmR3MSVIqWffue",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": "$activity.definition_activity_02H4ZCH2IE3NY5Sq9qrpzzrgoHfvKKw0yGU.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                                "operator": "eq",
                                                "right_operand": "Pass"
                                              },
                                              "operator": "and",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.json_EventName$",
                                                "operator": "eq",
                                                "right_operand": "json-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$"
                                              }
                                            },
                                            "operator": "and",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.json_EventType$",
                                              "operator": "eq",
                                              "right_operand": "webhook.rule_event"
                                            }
                                          },
                                          "operator": "and",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.json_MatchedRuleCount$",
                                            "operator": "eq",
                                            "right_operand": 1
                                          }
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.XML_EventName$",
                                          "operator": "eq",
                                          "right_operand": "xml-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.XML_matched_rule_count$",
                                        "operator": "eq",
                                        "right_operand": 1
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.XML_type$",
                                      "operator": "eq",
                                      "right_operand": "webhook.rule_event"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.UTF8_EventName$",
                                    "operator": "eq",
                                    "right_operand": "utf8-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.UTF8_matched_rule_count$",
                                  "operator": "eq",
                                  "right_operand": 1
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.UTF8_type$",
                                "operator": "eq",
                                "right_operand": "webhook.rule_event"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.URLEncoded_event_name$",
                              "operator": "eq",
                              "right_operand": "urlencoded-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.URLEncoded_matched_rule_count$",
                            "operator": "eq",
                            "right_operand": 1
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4ZW4JUQTHY7DC378wpY6kNICGqfKrsM7.output.jsonpath_queries.URLEncoded_type$",
                          "operator": "eq",
                          "right_operand": "webhook.rule_event"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H4ZZLL9TVDT2I7SDB3kfcIHJK5ukNevE2",
                        "name": "Set Variables",
                        "title": "Pass",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Pass",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYDON5H4F5ZA0pxJZd5VNxWMYlb0CHB$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H4ZC25E2TG55lSu3B0Dl4VTVizVh66hgN",
            "name": "Parallel Branch",
            "title": "Schedule Incident",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Schedule Incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4ZCJK8UOQE4Bo7qkBEQ4mU99gRIVunlp",
                "name": "XDR-1253-Rule History Reusable WF",
                "title": "XDR-1253-Rule History Reusable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR-1253-Rule History Reusable WF",
                  "input": {
                    "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                    "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 1,
                    "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "schedule.rule_schedule"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
                  "workflow_name": "XDR-1253-Rule History Reusable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZWMSLG3X12o73ytuLmYFzhHubBL0QQe",
                "name": "JSONPath Query",
                "title": "Fetch Details from Rule history Response",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Details from Rule history Response",
                  "input_json": "$activity.definition_activity_02H4ZCJK8UOQE4Bo7qkBEQ4mU99gRIVunlp.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..event_name",
                      "jsonpath_query_name": "Schedule_EventName",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$..matched_rule_count",
                      "jsonpath_query_name": "Schedule_MatchedRuleCount",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$..type",
                      "jsonpath_query_name": "Schedule_EventType",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H4ZZPXHC5H53hAwlbDPohjsikV0cW9de8",
                "name": "Condition Block",
                "title": "Verification for Schedule Rule History",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verification for Schedule Rule History",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02H4ZZPXHCY3H0Le3emRmZzS65urbV5gjLj",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZCJK8UOQE4Bo7qkBEQ4mU99gRIVunlp.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                              "operator": "eq",
                              "right_operand": "Pass"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4ZWMSLG3X12o73ytuLmYFzhHubBL0QQe.output.jsonpath_queries.Schedule_EventName$",
                              "operator": "eq",
                              "right_operand": "$activity.definition_activity_02H4Z64YO9M3H7Li6pk16dBUz6lYYW2BVQj.output.jsonpath_queries.Schedule_Rule_name$"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H4ZWMSLG3X12o73ytuLmYFzhHubBL0QQe.output.jsonpath_queries.Schedule_EventType$",
                            "operator": "eq",
                            "right_operand": "schedule.rule_schedule"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H4ZWMSLG3X12o73ytuLmYFzhHubBL0QQe.output.jsonpath_queries.Schedule_MatchedRuleCount$",
                          "operator": "eq",
                          "right_operand": "1"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02H4ZZPXHFM9X1sSmPVLVV7eyrIAiILKYQx",
                        "name": "Set Variables",
                        "title": "Pass",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Pass",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYLBG69UL7TbELgH4beRdQFi3RIipt6$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02H5EFBI125PT5snAQTH6yZE7ExBuZUGOyc",
        "name": "Group",
        "title": "Matching More Than one Rule and None Rule",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Matching More Than one Rule and None Rule",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN",
            "name": "Automation - Create a Standalone Incident Rule (One More Rule)",
            "title": "Automation - Create a Standalone Incident Rule (One More Rule)",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Automation - Create a Standalone Incident Rule (One More Rule)",
              "input": {
                "variable_workflow_027MPV5U2DIIF0zubA1M33SbdTCt6ZCzfq4": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                "variable_workflow_027MPV5U2EFCD2dIXOMcCJfC8zTYKWhgvL0": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_027MPV5U2ETAA17CVQcWakhMZzhJv72iREN": "Authorization",
                "variable_workflow_027MQ2YZNQUVF083B0R4hBHunurAKbOgtJK": "Standalone-1253-$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.instance_id$",
                "variable_workflow_027MQ6J9U6SFN6iWZGzhPRXoQSwKfKnmVwO": false,
                "variable_workflow_027MTIDA440DM0hV6hVS0HKzyKm21K1dvp9": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": \"$output.incident.description$\",\n        \"operator\": \"mw\",\n        \"right_operand\": \"1253-desc\"\n      },\n      \"operator\": \"and\",\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.confidence$\",\n        \"operator\": \"eq\",\n        \"right_operand\": \"High\"\n      }\n    },",
                "variable_workflow_028XFL5OHWNXK5o11JcxV0kSReACzV9dk57": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
              "workflow_name": "Automation - Create a Standalone Incident Rule"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5EOPTFJZPA1xQu06S6EuMSTEbX8OnDoU",
            "name": "SX- Incident Creation (to Get match rule count to 2)",
            "title": "SX- Incident Creation (to Get match rule count to 2)",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "SX- Incident Creation (to Get match rule count to 2)",
              "input": {
                "variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT": "{\n    \"source\": \"Umbrella\",\n    \"type\": \"bundle\",\n      \"incidents\":[\n          {\n              \"id\": \"transient:incident-2\",\n              \"title\": \"new title-st 1253 rule history-Automation Rule Testing\",\n              \"description\": \"In this scenario, the incident 1253-desc is submitted with only one technique but no tactic. In such a case, the tactics must be inferred at import from the submitted techniques, and the incident shall present the inferred tactics with these techniques in the financial risk tab.\",\n              \"type\": \"incident\",\n              \"source\": \"Umbrella\",\n              \"short_description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n              \"status\": \"New\",\n              \"promotion_method\": \"Automated\",\n              \"severity\": \"Critical\",\n              \"confidence\": \"High\",\n              \"incident_time\":{\"opened\": \"$Time\"}\n          }\n\n      ],\n      \"sightings\":[\n        {\n              \"description\": \"DNS request for 'examplebotnetdomain.com' made by 'ksimek-WS' (Roaming Computers)\",\n              \"id\": \"transient:sighting-1\",\n              \"observables\":\n              [\n                  {\n                      \"value\": \"examplebotnetdomain.com\",\n                      \"type\": \"domain\"\n                  }\n              ],\n              \"observed_time\":\n              {\n                  \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                  \"end_time\": \"2022-09-13T14:21:20.000Z\"\n              },\n              \"severity\": \"Low\",\n              \"source\": \"Umbrella Reporting API\",\n              \"source_uri\": \"https://dashboard.umbrella.com/o/1869975/#/reports/activity?encodedFilters=eyJzZWxlY3RlZERhdGVSYW5nZUlkeCI6MCwiZG9tYWluIjoiZXhhbXBsZWJvdG5ldGRvbWFpbi5jb20ifQ==\",\n              \"targets\":\n              [\n                  {\n                      \"type\": \"endpoint\",\n                      \"observables\":\n                      [\n                          {\n                              \"value\": \"41137871\",\n                              \"type\": \"odns_identity\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"odns_identity_label\"\n                          },\n                          {\n                              \"value\": \"35.169.125.172\",\n                              \"type\": \"ip\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"hostname\"\n                          }\n                      ],\n                      \"observed_time\":\n                      {\n                          \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                          \"end_time\": \"2022-09-13T14:21:20.000Z\"\n                      }\n                  }\n              ],\n            \"type\": \"sighting\"\n        }\n      ],\n    \"indicators\": [\n      {\n        \"description\": \"Several activities that reflect Command and Control behavior were detected on the same target in limited amount of time\",\n        \"valid_time\": {\n          \"start_time\": \"2022-04-01T00:00:00.000Z\"\n        },\n        \"producer\": \"Umbrella\",\n        \"type\": \"indicator\",\n        \"source\": \"Umbrella\",\n        \"external_ids\": [\n          \"securex:umbrella-threat-hunt-c\u0026c\"\n        ],\n        \"short_description\": \"Command and Control activities detected by DNS protection.\",\n        \"title\": \"Command and Control DNS activities\",\n        \"id\": \"transient:indicator-umbrella-c\u0026c\",\n        \"tlp\": \"green\"\n      }\n    ],\n    \"attack_patterns\": [\n        {\n            \"description\": \"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. \",\n            \"type\": \"attack-pattern\",\n            \"source\": \"MITRE Enterprise ATT\u0026CK\",\n            \"external_ids\": [\n                \"T1071\"\n            ],\n            \"short_description\": \"Application Layer Protocol\",\n            \"title\": \"Application Layer Protocol\",\n            \"external_references\": [\n                {\n                    \"source_name\": \"mitre-attack\",\n                    \"url\": \"https://attack.mitre.org/techniques/T1071\",\n                    \"external_id\": \"T1071\"\n                }\n            ],\n            \"source_uri\": \"https://attack.mitre.org\",\n            \"id\": \"transient:attack-pattern-T1071\",\n            \"kill_chain_phases\": [\n                {\n                    \"kill_chain_name\": \"mitre-attack\",\n                    \"phase_name\": \"command-and-control\"\n                },\n                {\n                    \"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n                    \"phase_name\": \"command-and-control\"\n                }\n            ]\n        }\n    ],\n    \"relationships\": [\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-indicator-T1071\",\n        \"source_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"target_ref\": \"transient:attack-pattern-T1071\",\n        \"relationship_type\": \"indicates\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-indicator\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"relationship_type\": \"sighting-of\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-incident\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:incident-2\",\n        \"relationship_type\": \"member-of\"\n      }\n    ]\n  }",
                "variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target": true,
                "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
                "target_type": "web-service.endpoint"
              },
              "workflow_id": "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
              "workflow_name": "SX- Incident Creation"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5HJU9T6FB519u0yvFXF2EER0cFSRlaou",
            "name": "Sleep",
            "title": "Wait for 30s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for 30s",
              "skip_execution": false,
              "sleep_interval": 30
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5FKKBF51W6236hI3UaWWnKxh5mn6OlTz",
            "name": "Calculate Date",
            "title": "Calculate Date",
            "type": "core.calculate_date",
            "base_type": "activity",
            "properties": {
              "adjustment": -86400,
              "continue_on_failure": false,
              "display_name": "Calculate Date",
              "original_date": "$activity.definition_activity_02H5EOPTFJZPA1xQu06S6EuMSTEbX8OnDoU.output.end_time$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5EPPNFXDTP4v2YbcMmXJJLDObQmtUfUM",
            "name": "XDR-1253-Rule History Reusable WF",
            "title": "XDR-1253-Rule History Reusable WF",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR-1253-Rule History Reusable WF",
              "input": {
                "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 1,
                "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "incident.rule_event"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
              "workflow_name": "XDR-1253-Rule History Reusable WF"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW",
            "name": "JSONPath Query",
            "title": "Fetch Details from Rule history Response",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Details from Rule history Response",
              "input_json": "$activity.definition_activity_02H5EPPNFXDTP4v2YbcMmXJJLDObQmtUfUM.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[?(@.event_name=='new title-st 1253 rule history-Automation Rule Testing')].event_name",
                  "jsonpath_query_name": "Standalone1_EventName",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.[?(@.event_name=='new title-st 1253 rule history-Automation Rule Testing')].matched_rule_count",
                  "jsonpath_query_name": "Standalone1_MatchedRuleCount",
                  "jsonpath_query_type": "integer"
                },
                {
                  "jsonpath_query": "$.[?(@.event_name=='new title-st 1253 rule history-Automation Rule Testing')].type",
                  "jsonpath_query_name": "Standalone1_EventType",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5F8FETBRQE6sNpvgLyjuT4qif2GS4Xco",
            "name": "SXO- Get Workflow Instances (V1.1 )",
            "title": "SXO- Get Workflow Instances (V1.1 )",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "SXO- Get Workflow Instances (V1.1 )",
              "input": {
                "variable_workflow_01UI12PFBGGMI46GosPCeAfs97cuhRV2HPO": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                "variable_workflow_01UI14NPSPU7K4lnWpU0bRq4sAvBh6mrbpD": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq",
              "workflow_name": "SXO- Get Workflow Instances (V1.1 )"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq",
            "name": "JSONPath Query",
            "title": "Fetch the Instance ID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch the Instance ID",
              "input_json": "$activity.definition_activity_02H5F8FETBRQE6sNpvgLyjuT4qif2GS4Xco.output.variable_workflow_01UJCX408QPTU6sQRcRQVhUxy2CNGkTkscO$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                  "jsonpath_query_name": "Instance_ID_for_Matching2Rules",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                  "jsonpath_query_name": "Instance_ID1_for_Matching2Rules",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5FFGL6VKKB0PbspILoXfJaKmSRaP8oD1",
            "name": "HTTP Request",
            "title": "Fetch Runs Instance Using instance ID (New API)",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"owner\": [],\n  \"instance_ids\": [\n    \"$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID_for_Matching2Rules$\"\n  ]\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Fetch Runs Instance Using instance ID (New API)",
              "method": "POST",
              "relative_url": "/api/v1.1/instances?limit=24\u0026start=0\u0026date_from=$activity.definition_activity_02H5FKKBF51W6236hI3UaWWnKxh5mn6OlTz.output.result$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7",
            "name": "JSONPath Query",
            "title": "Fetch Details from New API - New Rule",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Details from New API - New Rule",
              "input_json": "$activity.definition_activity_02H5FFGL6VKKB0PbspILoXfJaKmSRaP8oD1.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                  "jsonpath_query_name": "Insatnce_ID_fromNewAPI_ForNewRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].started_by",
                  "jsonpath_query_name": "started_by_fromNewAPI_ForNewRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].definition_id",
                  "jsonpath_query_name": "WorkflowID_fromNewAPI_ForNewRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5FLVKKKP2I1oIlo00JNxucJ1XCdbUqpL",
            "name": "HTTP Request",
            "title": "Fetch Runs Instance Using instance ID (New API) - Different Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"owner\": [],\n  \"instance_ids\": [\n    \"$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID1_for_Matching2Rules$\"\n  ]\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Fetch Runs Instance Using instance ID (New API) - Different Rule",
              "method": "POST",
              "relative_url": "/api/v1.1/instances?limit=24\u0026start=0\u0026date_from=$activity.definition_activity_02H5FKKBF51W6236hI3UaWWnKxh5mn6OlTz.output.result$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F",
            "name": "JSONPath Query",
            "title": "Fetch Details from New API - Different Rule",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Details from New API - Different Rule",
              "input_json": "$activity.definition_activity_02H5FLVKKKP2I1oIlo00JNxucJ1XCdbUqpL.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].id",
                  "jsonpath_query_name": "Insatnce_ID_fromNewAPI_ForOldRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].started_by",
                  "jsonpath_query_name": "started_by_fromNewAPI_ForOldRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.results[?(@.started_by=='$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$')].definition_id",
                  "jsonpath_query_name": "WorkflowID_fromNewAPI_ForOLDRule",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5ERZ4JEZ574LmJWAEuvqlot2zWzczCl7",
            "name": "SX- Incident Creation (To get matched Rule count to 0)",
            "title": "SX- Incident Creation (To get matched Rule count to 0)",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "SX- Incident Creation (To get matched Rule count to 0)",
              "input": {
                "variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT": "{\n    \"source\": \"Umbrella\",\n    \"type\": \"bundle\",\n      \"incidents\":[\n          {\n              \"id\": \"transient:incident-$ID\",\n              \"title\": \"none title-Automation Rule Testing\",\n              \"description\": \"In this scenario, the incident is submitted with only one technique but no tactic. In such a case, the tactics must be inferred at import from the submitted techniques, and the incident shall present the inferred tactics with these techniques in the financial risk tab.\",\n              \"type\": \"incident\",\n              \"source\": \"Umbrella\",\n              \"short_description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n              \"status\": \"New\",\n              \"promotion_method\": \"Automated\",\n              \"severity\": \"Critical\",\n              \"confidence\": \"High\",\n              \"incident_time\":{\"opened\": \"$Time\"}\n          }\n\n      ],\n      \"sightings\":[\n        {\n              \"description\": \"DNS request for 'examplebotnetdomain.com' made by 'ksimek-WS' (Roaming Computers)\",\n              \"id\": \"transient:sighting-1\",\n              \"observables\":\n              [\n                  {\n                      \"value\": \"examplebotnetdomain.com\",\n                      \"type\": \"domain\"\n                  }\n              ],\n              \"observed_time\":\n              {\n                  \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                  \"end_time\": \"2022-09-13T14:21:20.000Z\"\n              },\n              \"severity\": \"Low\",\n              \"source\": \"Umbrella Reporting API\",\n              \"source_uri\": \"https://dashboard.umbrella.com/o/1869975/#/reports/activity?encodedFilters=eyJzZWxlY3RlZERhdGVSYW5nZUlkeCI6MCwiZG9tYWluIjoiZXhhbXBsZWJvdG5ldGRvbWFpbi5jb20ifQ==\",\n              \"targets\":\n              [\n                  {\n                      \"type\": \"endpoint\",\n                      \"observables\":\n                      [\n                          {\n                              \"value\": \"41137871\",\n                              \"type\": \"odns_identity\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"odns_identity_label\"\n                          },\n                          {\n                              \"value\": \"35.169.125.172\",\n                              \"type\": \"ip\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"hostname\"\n                          }\n                      ],\n                      \"observed_time\":\n                      {\n                          \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                          \"end_time\": \"2022-09-13T14:21:20.000Z\"\n                      }\n                  }\n              ],\n            \"type\": \"sighting\"\n        }\n      ],\n    \"indicators\": [\n      {\n        \"description\": \"Several activities that reflect Command and Control behavior were detected on the same target in limited amount of time\",\n        \"valid_time\": {\n          \"start_time\": \"2022-04-01T00:00:00.000Z\"\n        },\n        \"producer\": \"Umbrella\",\n        \"type\": \"indicator\",\n        \"source\": \"Umbrella\",\n        \"external_ids\": [\n          \"securex:umbrella-threat-hunt-c\u0026c\"\n        ],\n        \"short_description\": \"Command and Control activities detected by DNS protection.\",\n        \"title\": \"Command and Control DNS activities\",\n        \"id\": \"transient:indicator-umbrella-c\u0026c\",\n        \"tlp\": \"green\"\n      }\n    ],\n    \"attack_patterns\": [\n        {\n            \"description\": \"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. \",\n            \"type\": \"attack-pattern\",\n            \"source\": \"MITRE Enterprise ATT\u0026CK\",\n            \"external_ids\": [\n                \"T1071\"\n            ],\n            \"short_description\": \"Application Layer Protocol\",\n            \"title\": \"Application Layer Protocol\",\n            \"external_references\": [\n                {\n                    \"source_name\": \"mitre-attack\",\n                    \"url\": \"https://attack.mitre.org/techniques/T1071\",\n                    \"external_id\": \"T1071\"\n                }\n            ],\n            \"source_uri\": \"https://attack.mitre.org\",\n            \"id\": \"transient:attack-pattern-T1071\",\n            \"kill_chain_phases\": [\n                {\n                    \"kill_chain_name\": \"mitre-attack\",\n                    \"phase_name\": \"command-and-control\"\n                },\n                {\n                    \"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n                    \"phase_name\": \"command-and-control\"\n                }\n            ]\n        }\n    ],\n    \"relationships\": [\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-indicator-T1071\",\n        \"source_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"target_ref\": \"transient:attack-pattern-T1071\",\n        \"relationship_type\": \"indicates\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-indicator\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"relationship_type\": \"sighting-of\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-incident\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:incident-2\",\n        \"relationship_type\": \"member-of\"\n      }\n    ]\n  }",
                "variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target": true,
                "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
                "target_type": "web-service.endpoint"
              },
              "workflow_id": "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
              "workflow_name": "SX- Incident Creation"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5HREX80RCF5JniF8trxUSA55jVqf1y0y",
            "name": "Sleep",
            "title": "Wait for 30s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for 30s",
              "skip_execution": false,
              "sleep_interval": 30
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5ET79OI6K33zP8OyMypsRFkNkFrt270t",
            "name": "XDR-1253-Rule History Reusable WF",
            "title": "XDR-1253-Rule History Reusable WF",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR-1253-Rule History Reusable WF",
              "input": {
                "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE": 1,
                "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk": "incident.rule_event"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
              "workflow_name": "XDR-1253-Rule History Reusable WF"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl",
            "name": "JSONPath Query",
            "title": "Fetch Details from Rule history Response",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Details from Rule history Response",
              "input_json": "$activity.definition_activity_02H5ET79OI6K33zP8OyMypsRFkNkFrt270t.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[?(@.event_name=='none title-Automation Rule Testing')].event_name",
                  "jsonpath_query_name": "Standalone1_EventName_None",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.[?(@.event_name=='none title-Automation Rule Testing')].matched_rule_count",
                  "jsonpath_query_name": "Standalone1_MatchedRuleCount_None",
                  "jsonpath_query_type": "integer"
                },
                {
                  "jsonpath_query": "$.[?(@.event_name=='none title-Automation Rule Testing')].type",
                  "jsonpath_query_name": "Standalone1_EventType_None",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5EV3QMP67R1zvN30FatMmDYn2Et5uQPF",
            "name": "Condition Block",
            "title": "Verify UseCase for When Matched Rule is 2 and 0",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "conditions": [],
              "continue_on_failure": false,
              "display_name": "Verify UseCase for When Matched Rule is 2 and 0",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02H5EV3QW2FNB5xYsnqZCQzsxUPI6lmhkNZ",
                "name": "Condition Branch",
                "title": "PassCase",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": "$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                          "operator": "eq",
                                                          "right_operand": "true"
                                                        },
                                                        "operator": "and",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02H5EOPTFJZPA1xQu06S6EuMSTEbX8OnDoU.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                          "operator": "eq",
                                                          "right_operand": "true"
                                                        }
                                                      },
                                                      "operator": "and",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02H5EPPNFXDTP4v2YbcMmXJJLDObQmtUfUM.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                                        "operator": "eq",
                                                        "right_operand": "Pass"
                                                      }
                                                    },
                                                    "operator": "and",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_EventName$",
                                                      "operator": "eq",
                                                      "right_operand": "new title-st 1253 rule history-Automation Rule Testing"
                                                    }
                                                  },
                                                  "operator": "and",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_EventType$",
                                                    "operator": "eq",
                                                    "right_operand": "incident.rule_event"
                                                  }
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_MatchedRuleCount$",
                                                  "operator": "gte",
                                                  "right_operand": "2"
                                                }
                                              },
                                              "operator": "and",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02H5ERZ4JEZ574LmJWAEuvqlot2zWzczCl7.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                "operator": "eq",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "and",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02H5ET79OI6K33zP8OyMypsRFkNkFrt270t.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                              "operator": "eq",
                                              "right_operand": "Pass"
                                            }
                                          },
                                          "operator": "and",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_EventName_None$",
                                            "operator": "eq",
                                            "right_operand": "none title-Automation Rule Testing"
                                          }
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_EventType_None$",
                                          "operator": "eq",
                                          "right_operand": "incident.rule_event"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_MatchedRuleCount_None$",
                                        "operator": "eq",
                                        "right_operand": "0"
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H5F8FETBRQE6sNpvgLyjuT4qif2GS4Xco.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                                      "operator": "eq",
                                      "right_operand": "true"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H5FFGL6VKKB0PbspILoXfJaKmSRaP8oD1.output.error.code$",
                                    "operator": "eq",
                                    "right_operand": "200"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.Insatnce_ID_fromNewAPI_ForNewRule$",
                                  "operator": "eq",
                                  "right_operand": "$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID_for_Matching2Rules$"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.WorkflowID_fromNewAPI_ForNewRule$",
                                "operator": "eq",
                                "right_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.started_by_fromNewAPI_ForNewRule$",
                              "operator": "eq",
                              "right_operand": "$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H5FLVKKKP2I1oIlo00JNxucJ1XCdbUqpL.output.error.code$",
                            "operator": "eq",
                            "right_operand": "200"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.Insatnce_ID_fromNewAPI_ForOldRule$",
                          "operator": "eq",
                          "right_operand": "$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID1_for_Matching2Rules$"
                        }
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.WorkflowID_fromNewAPI_ForOLDRule$",
                        "operator": "eq",
                        "right_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.started_by_fromNewAPI_ForOldRule$",
                      "operator": "eq",
                      "right_operand": "$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "PassCase",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02H5EYAYLW0JA2g2Al0lMplzHvaje63WdCO",
                    "name": "Set Variables",
                    "title": "PassCase",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5ETW7WTO5P5GdZPjSz0dPtpwHrTceyDF$",
                          "variable_value_new": "Pass"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02H5G7KH8VRHM4i7qOs0Y4nGKQieRgdrkYI",
                "name": "Condition Branch",
                "title": "FailCase",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": "$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                          "operator": "ne",
                                                          "right_operand": "true"
                                                        },
                                                        "operator": "or",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02H5EOPTFJZPA1xQu06S6EuMSTEbX8OnDoU.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                          "operator": "ne",
                                                          "right_operand": "true"
                                                        }
                                                      },
                                                      "operator": "or",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02H5EPPNFXDTP4v2YbcMmXJJLDObQmtUfUM.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                                        "operator": "ne",
                                                        "right_operand": "Pass"
                                                      }
                                                    },
                                                    "operator": "or",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_EventName$",
                                                      "operator": "ne",
                                                      "right_operand": "new title-st 1253 rule history-Automation Rule Testing"
                                                    }
                                                  },
                                                  "operator": "or",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_EventType$",
                                                    "operator": "ne",
                                                    "right_operand": "incident.rule_event"
                                                  }
                                                },
                                                "operator": "or",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02H5EV6ANSBR72GzThR6MpEpIADrjjRRAeW.output.jsonpath_queries.Standalone1_MatchedRuleCount$",
                                                  "operator": "lt",
                                                  "right_operand": "2"
                                                }
                                              },
                                              "operator": "or",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02H5ERZ4JEZ574LmJWAEuvqlot2zWzczCl7.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                "operator": "ne",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "or",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02H5ET79OI6K33zP8OyMypsRFkNkFrt270t.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                                              "operator": "ne",
                                              "right_operand": "Pass"
                                            }
                                          },
                                          "operator": "or",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_EventName_None$",
                                            "operator": "ne",
                                            "right_operand": "none title-Automation Rule Testing"
                                          }
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_EventType_None$",
                                          "operator": "ne",
                                          "right_operand": "incident.rule_event"
                                        }
                                      },
                                      "operator": "or",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H5EWLMR9PJ06kujnCFZAJbAqbe639HcPl.output.jsonpath_queries.Standalone1_MatchedRuleCount_None$",
                                        "operator": "ne",
                                        "right_operand": "0"
                                      }
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H5F8FETBRQE6sNpvgLyjuT4qif2GS4Xco.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                                      "operator": "ne",
                                      "right_operand": "true"
                                    }
                                  },
                                  "operator": "or",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H5FFGL6VKKB0PbspILoXfJaKmSRaP8oD1.output.error.code$",
                                    "operator": "ne",
                                    "right_operand": "200"
                                  }
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.Insatnce_ID_fromNewAPI_ForNewRule$",
                                  "operator": "ne",
                                  "right_operand": "$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID_for_Matching2Rules$"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.WorkflowID_fromNewAPI_ForNewRule$",
                                "operator": "ne",
                                "right_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H5FVX8V7V8Z4OjJbdPMgD5fdEvuOnvdO7.output.jsonpath_queries.started_by_fromNewAPI_ForNewRule$",
                              "operator": "ne",
                              "right_operand": "$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02H5FLVKKKP2I1oIlo00JNxucJ1XCdbUqpL.output.error.code$",
                            "operator": "ne",
                            "right_operand": "200"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.Insatnce_ID_fromNewAPI_ForOldRule$",
                          "operator": "ne",
                          "right_operand": "$activity.definition_activity_02H5F9E2RFPXR26RzvI6KXHhCPniVzuQcRq.output.jsonpath_queries.Instance_ID1_for_Matching2Rules$"
                        }
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.WorkflowID_fromNewAPI_ForOLDRule$",
                        "operator": "ne",
                        "right_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02H5G07XVP1WO6OikhJDaz2GUOJ61F1FT4F.output.jsonpath_queries.started_by_fromNewAPI_ForOldRule$",
                      "operator": "ne",
                      "right_operand": "$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "FailCase",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02H5G7KH8X6007iuyFxV8CnM7IkaXXldloF",
                    "name": "Set Variables",
                    "title": "FailCase",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "FailCase",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5ETW7WTO5P5GdZPjSz0dPtpwHrTceyDF$",
                          "variable_value_new": "Fail"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02H4ZEZRMVKAI3temTHW77pS7KkXdEH4cnE",
        "name": "Group",
        "title": "Cleanup",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Cleanup",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02H4Z3HMSAF4R1zCMpFO6df1BO32aU2mHTa",
            "name": "XDR -- UnLock LockedWorkflow Reusable",
            "title": "XDR -- UnLock LockedWorkflow Reusable",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR -- UnLock LockedWorkflow Reusable",
              "input": {
                "variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$",
                "variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh",
              "workflow_name": "XDR -- UnLock LockedWorkflow Reusable"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z4W1KOEQS4XDy9ZBWa6LjrKUH16DL6e",
            "name": "HTTP Request",
            "title": "Delete Workflow",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Workflow",
              "method": "DELETE",
              "relative_url": "api/v1/workflows/$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4ZIHIW73R065NgnpBEvPQ19fLuHodtR8",
            "name": "Sleep",
            "title": "Sleep for 5s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 5s",
              "skip_execution": false,
              "sleep_interval": 5
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z8C3BLO3O6nVWoE3BwELCyNCtCtGvh4",
            "name": "HTTP Request",
            "title": "Delete Approval Workflow",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Approval Workflow",
              "method": "DELETE",
              "relative_url": "api/v1/workflows/$activity.definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z.output.variable_workflow_026YHD0WACZ1F1xGmmAahjuT0jcvHs0UQav$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z4D4QJI0W7eg3CeyiOn1RCnAPnBJHBh",
            "name": "HTTP Request",
            "title": "Delete Priority Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Priority Rule",
              "method": "DELETE",
              "relative_url": "api/v1/rules/$activity.definition_activity_02H4S47DPWSU53cGObKlUFiuJfkrNfLdwco.output.variable_workflow_027MR8CHBDD633pQPGnXsZVl1TYdOrt5209$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z58RCT157601sviROCUwGMkV317yaBm",
            "name": "HTTP Request",
            "title": "Delete Standalone Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Standalone Rule",
              "method": "DELETE",
              "relative_url": "api/v1/rules/$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5UQIQ1HITN4z6G3rqfIBiO8nXa0RpeK1",
            "name": "HTTP Request",
            "title": "Delete Standalone Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Standalone Rule",
              "method": "DELETE",
              "relative_url": "api/v1/rules/$activity.definition_activity_02H5EIPAXXBPV2QTgTcp1f3rCad3heTMzLN.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z5IECH7YF1ONHyO7Tj1phFzTUzKeppB",
            "name": "HTTP Request",
            "title": "Delete Schedule Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Schedule Rule",
              "method": "DELETE",
              "relative_url": "api/v1/rules/$activity.definition_activity_02H4Z64YO9M3H7Li6pk16dBUz6lYYW2BVQj.output.jsonpath_queries.Schedule_Rule_ID$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4Z6X6G3GMI7c7lzmg4vNdnM8O44OxOeU",
            "name": "HTTP Request",
            "title": "Delete Approval Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                }
              ],
              "display_name": "Delete Approval Rule",
              "method": "DELETE",
              "relative_url": "api/v1/rules/$activity.definition_activity_02H4S4CPC449A6UHNqvahuRyuq6nQzYy8WL.output.variable_workflow_027MU5DP2Z8BL0GzeMlE7T4Qq4dVcYkmu7o$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5TYR68JT0Z77inC4EGRUSoHSpSu3oqil",
            "name": "For Each",
            "title": "For Each",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For Each",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.local.variable_workflow_02H5U1PRFCCAM1v32c88DEfhm2PGLmqGC9Y$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4Z7FX7DMZY77Ez9oqg7ZeeSm81BzothU",
                "name": "HTTP Request",
                "title": "Delete Webhook Rule",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                    }
                  ],
                  "display_name": "Delete Webhook Rule",
                  "method": "DELETE",
                  "relative_url": "api/v1/rules/$activity.definition_activity_02H5TYR68JT0Z77inC4EGRUSoHSpSu3oqil.input.source_array[@].ID$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H5TYWSQBIHL7CMWmkEpbyxxY0EvdUMpBc",
            "name": "Sleep",
            "title": "Sleep for 5s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 5s",
              "skip_execution": false,
              "sleep_interval": 5
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H5UR69L348P0pjA7wAyWWiz1hkh0FBmsb",
            "name": "For Each",
            "title": "For Each",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For Each",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.local.variable_workflow_02H5U1UJQZ0CO5lcFlSnFuLYsyeDKR9xfCQ$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H4Z81J0S8IH2vZwCxafJ2RDdwoyFEEYF7",
                "name": "HTTP Request",
                "title": "Delete Webhook",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.input.variable_workflow_02H4RX8OHQXVN47VHBBlq8jxuN2b4KHGTAE$"
                    }
                  ],
                  "display_name": "Delete Webhook",
                  "method": "DELETE",
                  "relative_url": "api/v1/webhooks/$activity.definition_activity_02H5UR69L348P0pjA7wAyWWiz1hkh0FBmsb.input.source_array[@].ID$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02H507XKU4L9B6j7nugJ4I7atm2nVZd8Our",
        "name": "Condition Block",
        "title": "Verify Overall Status for 1253",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "conditions": [],
          "continue_on_failure": false,
          "display_name": "Verify Overall Status for 1253",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02H507XL22MKV7OBjeuZC6IdxfhJgBlKUEf",
            "name": "Condition Branch",
            "title": "PassCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC43F43oBn9BzrOKiM8NvxxcNOrN$",
                                                                  "operator": "eq",
                                                                  "right_operand": "true"
                                                                },
                                                                "operator": "and",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02H4RXOBPQAM21YdF0KrHXDNsESaQXvpUUz.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                  "operator": "eq",
                                                                  "right_operand": "true"
                                                                }
                                                              },
                                                              "operator": "and",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02H4RYHP9ECD37XxphaQ7AbvN1UDNeFiwUr.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                "operator": "eq",
                                                                "right_operand": "true"
                                                              }
                                                            },
                                                            "operator": "and",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02H4S47DPWSU53cGObKlUFiuJfkrNfLdwco.output.variable_workflow_027MR8CHBBPAY2Ir8OSHRgquZ2IQJVUoSsz$",
                                                              "operator": "eq",
                                                              "right_operand": "true"
                                                            }
                                                          },
                                                          "operator": "and",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                            "operator": "eq",
                                                            "right_operand": "true"
                                                          }
                                                        },
                                                        "operator": "and",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02H4S4CPC449A6UHNqvahuRyuq6nQzYy8WL.output.variable_workflow_027MU5DP2YH6R32Z5KXl90Z7snntfyqjylj$",
                                                          "operator": "eq",
                                                          "right_operand": "true"
                                                        }
                                                      },
                                                      "operator": "and",
                                                      "right_operand": {
                                                        "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5U7ZX3CE074UUkMZ9BwzIitfgU97X6hl$",
                                                        "operator": "eq",
                                                        "right_operand": "Pass"
                                                      }
                                                    },
                                                    "operator": "and",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02H4U4ZKLTTYG59cMDCitkPfPPhnkdxoQhG.output.error.code$",
                                                      "operator": "eq",
                                                      "right_operand": "200"
                                                    }
                                                  },
                                                  "operator": "and",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02H4U6AKR62R022RrkDDk01TpIJkf2s6h3t.output.error.code$",
                                                    "operator": "eq",
                                                    "right_operand": "200"
                                                  }
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02H4SKN03W5TH54yyE5TfWqzzZHFmbNv2tt.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                  "operator": "eq",
                                                  "right_operand": "true"
                                                }
                                              },
                                              "operator": "and",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02H4SL5JEA23S6OLbnU1T7AQHWNU46YeZTI.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                "operator": "eq",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "and",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z.output.variable_workflow_026YHDBBBMOKL4PuJR5QoVaFm20O7FVC813$",
                                              "operator": "eq",
                                              "right_operand": "true"
                                            }
                                          },
                                          "operator": "and",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02H4SMIJ9A72G0t6Dy46DarvQnjk3AYZhFe.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                            "operator": "eq",
                                            "right_operand": "true"
                                          }
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H4SMX0IGYYQ2x7QWjoQyNVWqyQMeMjN7J.output.variable_workflow_02EWMMJPAR7CA6bW0g1OT6ZUJ9nPsEUS27Q$",
                                          "operator": "eq",
                                          "right_operand": "Pass"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H4Z4W1KOEQS4XDy9ZBWa6LjrKUH16DL6e.output.error.code$",
                                        "operator": "eq",
                                        "right_operand": "200"
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H4Z8C3BLO3O6nVWoE3BwELCyNCtCtGvh4.output.error.code$",
                                      "operator": "eq",
                                      "right_operand": "200"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H4Z4D4QJI0W7eg3CeyiOn1RCnAPnBJHBh.output.error.code$",
                                    "operator": "eq",
                                    "right_operand": "200"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H4Z58RCT157601sviROCUwGMkV317yaBm.output.error.code$",
                                  "operator": "eq",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H4Z5IECH7YF1ONHyO7Tj1phFzTUzKeppB.output.error.code$",
                                "operator": "eq",
                                "right_operand": "200"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4Z6X6G3GMI7c7lzmg4vNdnM8O44OxOeU.output.error.code$",
                              "operator": "eq",
                              "right_operand": "200"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY7QN9QVT0lw2MiaYuNnM0fe07OcfCY$",
                            "operator": "eq",
                            "right_operand": "Pass"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY1DZY3GL2ngObjIuHrjjFsJc2bDBcS$",
                          "operator": "eq",
                          "right_operand": "Pass"
                        }
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYLBG69UL7TbELgH4beRdQFi3RIipt6$",
                        "operator": "eq",
                        "right_operand": "Pass"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZXVDBUXJF5bFOffjU7IpF4L3UezPF2Y$",
                      "operator": "eq",
                      "right_operand": "Pass"
                    }
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYDON5H4F5ZA0pxJZd5VNxWMYlb0CHB$",
                    "operator": "eq",
                    "right_operand": "Pass"
                  }
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5ETW7WTO5P5GdZPjSz0dPtpwHrTceyDF$",
                  "operator": "eq",
                  "right_operand": "Pass"
                }
              },
              "continue_on_failure": false,
              "display_name": "PassCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H50H6475QYB3gn1gRx757BH8ZIGzQ4oj0",
                "name": "Set Variables",
                "title": "PassCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "PassCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H508G5WFJ500joO2lNYsgYqMYZmCjOwCw$",
                      "variable_value_new": "Pass"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02H50HGA9FDM56jpZCJBhWv2eH0IozU9YND",
            "name": "Condition Branch",
            "title": "FailCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": "$activity.definition_activity_02H4RWN13XJLX23ThpTe20fhaRqUHVulQNe.output.variable_workflow_026R3ITFC43F43oBn9BzrOKiM8NvxxcNOrN$",
                                                                  "operator": "ne",
                                                                  "right_operand": "true"
                                                                },
                                                                "operator": "or",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02H4RXOBPQAM21YdF0KrHXDNsESaQXvpUUz.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                  "operator": "ne",
                                                                  "right_operand": "true"
                                                                }
                                                              },
                                                              "operator": "or",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02H4RYHP9ECD37XxphaQ7AbvN1UDNeFiwUr.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                "operator": "ne",
                                                                "right_operand": "true"
                                                              }
                                                            },
                                                            "operator": "or",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02H4S47DPWSU53cGObKlUFiuJfkrNfLdwco.output.variable_workflow_027MR8CHBBPAY2Ir8OSHRgquZ2IQJVUoSsz$",
                                                              "operator": "ne",
                                                              "right_operand": "true"
                                                            }
                                                          },
                                                          "operator": "or",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02H4S48GTE2SE06i6zf8UAEq1F2DqWGG9Rw.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                            "operator": "ne",
                                                            "right_operand": "true"
                                                          }
                                                        },
                                                        "operator": "or",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02H4S4CPC449A6UHNqvahuRyuq6nQzYy8WL.output.variable_workflow_027MU5DP2YH6R32Z5KXl90Z7snntfyqjylj$",
                                                          "operator": "ne",
                                                          "right_operand": "true"
                                                        }
                                                      },
                                                      "operator": "or",
                                                      "right_operand": {
                                                        "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5U7ZX3CE074UUkMZ9BwzIitfgU97X6hl$",
                                                        "operator": "eq",
                                                        "right_operand": "Fail"
                                                      }
                                                    },
                                                    "operator": "or",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02H4U4ZKLTTYG59cMDCitkPfPPhnkdxoQhG.output.error.code$",
                                                      "operator": "ne",
                                                      "right_operand": "200"
                                                    }
                                                  },
                                                  "operator": "or",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02H4U6AKR62R022RrkDDk01TpIJkf2s6h3t.output.error.code$",
                                                    "operator": "ne",
                                                    "right_operand": "200"
                                                  }
                                                },
                                                "operator": "or",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02H4SKN03W5TH54yyE5TfWqzzZHFmbNv2tt.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                  "operator": "ne",
                                                  "right_operand": "true"
                                                }
                                              },
                                              "operator": "or",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02H4SL5JEA23S6OLbnU1T7AQHWNU46YeZTI.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                                                "operator": "ne",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "or",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02H4SHFKOXKLU30P0tnlVb7xsFUfcBYPJ9z.output.variable_workflow_026YHDBBBMOKL4PuJR5QoVaFm20O7FVC813$",
                                              "operator": "ne",
                                              "right_operand": "true"
                                            }
                                          },
                                          "operator": "or",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02H4SMIJ9A72G0t6Dy46DarvQnjk3AYZhFe.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                            "operator": "ne",
                                            "right_operand": "true"
                                          }
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02H4SMX0IGYYQ2x7QWjoQyNVWqyQMeMjN7J.output.variable_workflow_02EWMMJPAR7CA6bW0g1OT6ZUJ9nPsEUS27Q$",
                                          "operator": "ne",
                                          "right_operand": "Pass"
                                        }
                                      },
                                      "operator": "or",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02H4Z4W1KOEQS4XDy9ZBWa6LjrKUH16DL6e.output.error.code$",
                                        "operator": "ne",
                                        "right_operand": "200"
                                      }
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02H4Z8C3BLO3O6nVWoE3BwELCyNCtCtGvh4.output.error.code$",
                                      "operator": "ne",
                                      "right_operand": "200"
                                    }
                                  },
                                  "operator": "or",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02H4Z4D4QJI0W7eg3CeyiOn1RCnAPnBJHBh.output.error.code$",
                                    "operator": "ne",
                                    "right_operand": "200"
                                  }
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02H4Z58RCT157601sviROCUwGMkV317yaBm.output.error.code$",
                                  "operator": "ne",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02H4Z5IECH7YF1ONHyO7Tj1phFzTUzKeppB.output.error.code$",
                                "operator": "ne",
                                "right_operand": "200"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02H4Z6X6G3GMI7c7lzmg4vNdnM8O44OxOeU.output.error.code$",
                              "operator": "ne",
                              "right_operand": "200"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY7QN9QVT0lw2MiaYuNnM0fe07OcfCY$",
                            "operator": "ne",
                            "right_operand": "Pass"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZY1DZY3GL2ngObjIuHrjjFsJc2bDBcS$",
                          "operator": "ne",
                          "right_operand": "Pass"
                        }
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYLBG69UL7TbELgH4beRdQFi3RIipt6$",
                        "operator": "ne",
                        "right_operand": "Pass"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZXVDBUXJF5bFOffjU7IpF4L3UezPF2Y$",
                      "operator": "ne",
                      "right_operand": "Pass"
                    }
                  },
                  "operator": "or",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H4ZYDON5H4F5ZA0pxJZd5VNxWMYlb0CHB$",
                    "operator": "ne",
                    "right_operand": "Pass"
                  }
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H5ETW7WTO5P5GdZPjSz0dPtpwHrTceyDF$",
                  "operator": "ne",
                  "right_operand": "Pass"
                }
              },
              "continue_on_failure": false,
              "display_name": "FailCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02H50HGA9H2BB2TDirsduC8R9jpY3tJHeEF",
                "name": "Set Variables",
                "title": "FailCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "FailCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02H4RW5S7KVXE1xiAV0XiPRxU1jqPIRcU6u.output.variable_workflow_02H508G5WFJ500joO2lNYsgYqMYZmCjOwCw$",
                      "variable_value_new": "Fail"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02H50NHRC2FOD5H4QWX7cxqwMQvKsq5QqE8",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "categories": {
    "category_01GUFX9FVCE283ZPiHKK9kqAufyYonIV94A": {
      "unique_name": "category_01GUFX9FVCE283ZPiHKK9kqAufyYonIV94A",
      "name": "CA Web Services",
      "title": "CA Web Services",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "system",
      "object_type": "category"
    }
  },
  "table_types": {
    "tabletype_029M4VKMD31CZ4YiphmwBKFaWrc0i8e0e8Y": {
      "unique_name": "tabletype_029M4VKMD31CZ4YiphmwBKFaWrc0i8e0e8Y",
      "data_type": "datatype.tabletype",
      "display_name": "Webhook_TestResults_25456",
      "columns": [
        {
          "name": "Webhook_Type",
          "title": "Webhook_Type",
          "type": "string"
        },
        {
          "name": "TestResults",
          "title": "TestResults",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_02H5U16E47CW7535EKB7fcAGkM1Ub7Sajy2": {
      "unique_name": "tabletype_02H5U16E47CW7535EKB7fcAGkM1Ub7Sajy2",
      "data_type": "datatype.tabletype",
      "display_name": "Webhook_Ids",
      "columns": [
        {
          "name": "ID",
          "title": "ID",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_02H5V6NEBUV74084cPF0Q7T87Bs1JJXjOPc": {
      "unique_name": "tabletype_02H5V6NEBUV74084cPF0Q7T87Bs1JJXjOPc",
      "data_type": "datatype.tabletype",
      "display_name": "webhook-type",
      "columns": [
        {
          "name": "type",
          "title": "type",
          "type": "string"
        },
        {
          "name": "webhook_type",
          "title": "webhook_type",
          "type": "string"
        },
        {
          "name": "payload",
          "title": "payload",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
        "name": "SX- Incident Creation",
        "title": "SX- Incident Creation",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "{\n    \"source\": \"Umbrella\",\n    \"type\": \"bundle\",\n      \"incidents\":[\n          {\n              \"id\": \"transient:incident-$ID\",\n              \"title\": \"SG-PR-Sep11-2-Automation Rule Testing - IncidentWF_$ID\",\n              \"description\": \"In this scenario, the incident is submitted with only one technique but no tactic. In such a case, the tactics must be inferred at import from the submitted techniques, and the incident shall present the inferred tactics with these techniques in the financial risk tab.\",\n              \"type\": \"incident\",\n              \"source\": \"Umbrella\",\n              \"short_description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n              \"status\": \"New\",\n              \"promotion_method\": \"Automated\",\n              \"severity\": \"Critical\",\n              \"confidence\": \"High\",\n              \"incident_time\":{\"opened\": \"$Time\"}\n          }\n\n      ],\n      \"sightings\":[\n        {\n              \"description\": \"DNS request for 'examplebotnetdomain.com' made by 'ksimek-WS' (Roaming Computers)\",\n              \"id\": \"transient:sighting-1\",\n              \"observables\":\n              [\n                  {\n                      \"value\": \"examplebotnetdomain.com\",\n                      \"type\": \"domain\"\n                  }\n              ],\n              \"observed_time\":\n              {\n                  \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                  \"end_time\": \"2022-09-13T14:21:20.000Z\"\n              },\n              \"severity\": \"Low\",\n              \"source\": \"Umbrella Reporting API\",\n              \"source_uri\": \"https://dashboard.umbrella.com/o/1869975/#/reports/activity?encodedFilters=eyJzZWxlY3RlZERhdGVSYW5nZUlkeCI6MCwiZG9tYWluIjoiZXhhbXBsZWJvdG5ldGRvbWFpbi5jb20ifQ==\",\n              \"targets\":\n              [\n                  {\n                      \"type\": \"endpoint\",\n                      \"observables\":\n                      [\n                          {\n                              \"value\": \"41137871\",\n                              \"type\": \"odns_identity\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"odns_identity_label\"\n                          },\n                          {\n                              \"value\": \"35.169.125.172\",\n                              \"type\": \"ip\"\n                          },\n                          {\n                              \"value\": \"ksimek-WS\",\n                              \"type\": \"hostname\"\n                          }\n                      ],\n                      \"observed_time\":\n                      {\n                          \"start_time\": \"2022-09-13T14:21:20.000Z\",\n                          \"end_time\": \"2022-09-13T14:21:20.000Z\"\n                      }\n                  }\n              ],\n            \"type\": \"sighting\"\n        }\n      ],\n    \"indicators\": [\n      {\n        \"description\": \"Several activities that reflect Command and Control behavior were detected on the same target in limited amount of time\",\n        \"valid_time\": {\n          \"start_time\": \"2022-04-01T00:00:00.000Z\"\n        },\n        \"producer\": \"Umbrella\",\n        \"type\": \"indicator\",\n        \"source\": \"Umbrella\",\n        \"external_ids\": [\n          \"securex:umbrella-threat-hunt-c\u0026c\"\n        ],\n        \"short_description\": \"Command and Control activities detected by DNS protection.\",\n        \"title\": \"Command and Control DNS activities\",\n        \"id\": \"transient:indicator-umbrella-c\u0026c\",\n        \"tlp\": \"green\"\n      }\n    ],\n    \"attack_patterns\": [\n        {\n            \"description\": \"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. \",\n            \"type\": \"attack-pattern\",\n            \"source\": \"MITRE Enterprise ATT\u0026CK\",\n            \"external_ids\": [\n                \"T1071\"\n            ],\n            \"short_description\": \"Application Layer Protocol\",\n            \"title\": \"Application Layer Protocol\",\n            \"external_references\": [\n                {\n                    \"source_name\": \"mitre-attack\",\n                    \"url\": \"https://attack.mitre.org/techniques/T1071\",\n                    \"external_id\": \"T1071\"\n                }\n            ],\n            \"source_uri\": \"https://attack.mitre.org\",\n            \"id\": \"transient:attack-pattern-T1071\",\n            \"kill_chain_phases\": [\n                {\n                    \"kill_chain_name\": \"mitre-attack\",\n                    \"phase_name\": \"command-and-control\"\n                },\n                {\n                    \"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n                    \"phase_name\": \"command-and-control\"\n                }\n            ]\n        }\n    ],\n    \"relationships\": [\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-indicator-T1071\",\n        \"source_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"target_ref\": \"transient:attack-pattern-T1071\",\n        \"relationship_type\": \"indicates\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-indicator\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:indicator-umbrella-c\u0026c\",\n        \"relationship_type\": \"sighting-of\"\n      },\n      {\n        \"type\": \"relationship\",\n        \"id\": \"transient:relationship-sighting-incident\",\n        \"source_ref\": \"transient:sighting-1\",\n        \"target_ref\": \"transient:incident-2\",\n        \"relationship_type\": \"member-of\"\n      }\n    ]\n  }\n",
              "scope": "input",
              "name": "Incident Payload",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Pass or Fail",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Provide the token with Bearer",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Incident ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_025XVBQ4XDOXO4WQY9An03Am9kg3LLcX3Z1",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "SX- Incident Creation",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
            "execute_on_workflow_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_025XVBQ6MME670TrxLs3oc86o6v1aSY5g9j",
            "name": "Replace String",
            "title": "Modify Payload",
            "type": "core.replacestring",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Modify Payload",
              "input_string": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.input.variable_workflow_025XVBQ4XDCWA6CIc3NJnrtB74GGidZMJGT$",
              "replace_list": [
                {
                  "replaced_string": "$ID",
                  "replacement_string": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.instance_id$"
                },
                {
                  "replaced_string": "$Time",
                  "replacement_string": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.start_time$"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf",
            "name": "HTTP Request",
            "title": "Create an Incident",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "$activity.definition_activity_025XVBQ6MME670TrxLs3oc86o6v1aSY5g9j.output.result_string$",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.input.variable_workflow_02EDD9GCRBAX574rDgRmdygEP3enq7dzk6J$"
                }
              ],
              "display_name": "Create an Incident",
              "method": "POST",
              "relative_url": "/private-intel/bundle/import",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_025XVBQ8CW1B42mCSGdz6rb7ez0foMufR9m",
            "name": "JSONPath Query",
            "title": "Extract Incident ID String",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Extract Incident ID String",
              "input_json": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.results.[?(@.type=='incident')].id",
                  "jsonpath_query_name": "Incident_ID",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_025XVS7H9QAV10OKjqm2u2GNSsID9VcLJJH",
            "name": "Split String",
            "title": "Extract Incident ID from the String above Action",
            "type": "core.splitstring",
            "base_type": "activity",
            "properties": {
              "boundaries": [
                {
                  "boundary": "/ctia/incident/"
                }
              ],
              "continue_on_failure": false,
              "display_name": "Extract Incident ID from the String above Action",
              "input_string": "$activity.definition_activity_025XVBQ8CW1B42mCSGdz6rb7ez0foMufR9m.output.jsonpath_queries.Incident_ID$",
              "remove_empty": true,
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_025XVBQ9BKQVS7EpsORoZPTATSI4XdHsPvZ",
            "name": "Set Variables",
            "title": "Storing Incident Id in O/P Variable",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Storing Incident Id in O/P Variable",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.variable_workflow_025XVBQ4XDOXO4WQY9An03Am9kg3LLcX3Z1$",
                  "variable_value_new": "$activity.definition_activity_025XVS7H9QAV10OKjqm2u2GNSsID9VcLJJH.output.parts[-1]$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_025XVBQA4Y6VN4z4wIECW9ZQ0DSr7TxkU1Y",
            "name": "Condition Block",
            "title": "Category Create Validation pass/Fail",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Category Create Validation pass/Fail",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_025XVBQAWRLLD5qD8sungkqBjzJTgFEOmLW",
                "name": "Condition Branch",
                "title": "pass",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.succeeded$",
                      "operator": "eq",
                      "right_operand": true
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "pass",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_025XVBQBXFYPB1sy1UGaNyE5s4c1aqpUYrB",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                          "variable_value_new": "true"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_025XVBQCS4JT9441P66qIKq56gpjuFTra8T",
                "name": "Condition Branch",
                "title": "409 Error- JWT Error",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.code$",
                      "operator": "eq",
                      "right_operand": "401"
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.message$",
                      "operator": "mregex",
                      "right_operand": ".*decode jwt error"
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "409 Error- JWT Error",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_025XVBQDRDSPD68c9lNqCFEpUjhY5cIHQyW",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_025XVBQEMEPTU6HdjQF2l26mcNIWQ68CLmA",
                "name": "Condition Branch",
                "title": "400 Error- Invalid Payload",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.message$",
                      "operator": "mregex",
                      "right_operand": ".*Invalid format*"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.code$",
                      "operator": "eq",
                      "right_operand": "400"
                    }
                  },
                  "continue_on_failure": true,
                  "description": "old- .*Validate payload with schema errored\nnew- title error:length must be \\u003c= 64",
                  "display_name": "400 Error- Invalid Payload",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_025XVBQFMLD725jEJiW3kskUkBAeyW3V2sJ",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_025XVBQGFQ2070xuDxfqxVFGDeMGOJTVpb6",
                "name": "Condition Branch",
                "title": "400 Error- Category Payload missing",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.message$",
                      "operator": "mregex",
                      "right_operand": ".*nil*"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_025XVBQ7ISYCS1RbjXd97nTAZBWibmaZkQf.output.error.code$",
                      "operator": "eq",
                      "right_operand": "400"
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "400 Error- Category Payload missing",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_025XVBQHG55HQ35Mp0S44BSMjgtdB8c1f8b",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o.output.variable_workflow_025XVBQ4XDWTI6w12ilYBIIdxxfnoAF1cmt$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_01GUFX9FVCE283ZPiHKK9kqAufyYonIV94A"
        ]
      }
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
        "name": "XDR-1253-Rule History Reusable WF",
        "title": "XDR-1253-Rule History Reusable WF",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Rule History Response Body",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": "text"
            },
            "unique_name": "variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Provide Input token without Bearer",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": "text"
            },
            "unique_name": "variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "Rule History Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": "text"
            },
            "unique_name": "variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "all\nwebhook.rule_event\napproval_task.rule_event\nincident.rule_event\nschedule.rule_schedule",
              "scope": "input",
              "name": "Enter the types",
              "type": "datatype.string",
              "description": "Supported Types , if you want to fetch for all type then enter all or individual type then enter the below type\n\nwebhook.rule_event\napproval_task.rule_event\nincident.rule_event\nschedule.rule_schedule",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": "text"
            },
            "unique_name": "variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 1,
              "scope": "input",
              "name": "limit",
              "type": "datatype.integer",
              "description": "Enter the Limit. (Integer Value)",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "XDR-1253-Rule History Reusable WF",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02H4UDBGZRK4E0CBhg19YV2u05jd87Q2j1Y",
            "name": "HTTP Request",
            "title": "Fetch Rule History",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n    \"types\": [\n        \"$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.input.variable_workflow_02H4UIZ2KWYPD38esKaxEbryF85BZmrVNVk$\"\n    ]\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.input.variable_workflow_02H4UED9U5Z741LyFFk2QsdlkrlszDd2lPm$"
                }
              ],
              "display_name": "Fetch Rule History",
              "method": "POST",
              "relative_url": "api/v1/rules_history/batch_get?start=0\u0026limit=$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.input.variable_workflow_02H4UF2MV8OP75lcjVH57FIaModBiCIg6kE$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4UMARTDTE01LMtL6doKDivRQpx1rnf7T",
            "name": "JSONPath Query",
            "title": "Fetch Results",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Results",
              "input_json": "$activity.definition_activity_02H4UDBGZRK4E0CBhg19YV2u05jd87Q2j1Y.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.results",
                  "jsonpath_query_name": "Rule_History_Results",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4UL8ZK4Q9F2Alkknitus7v9ofLZyzsEi",
            "name": "Set Variables",
            "title": "Store History Response Body",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Store History Response Body",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.output.variable_workflow_02H4UK3EHMSJW3mT22lEyt6oqcd3aOpb57c$",
                  "variable_value_new": "$activity.definition_activity_02H4UMARTDTE01LMtL6doKDivRQpx1rnf7T.output.jsonpath_queries.Rule_History_Results$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02H4UKCOH8YIC4zmwvlQxn6hj9xSUn0SleM",
            "name": "Condition Block",
            "title": "Verify the Rule History Status",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "conditions": [],
              "continue_on_failure": false,
              "display_name": "Verify the Rule History Status",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02H4UKCOQPO4C0Q6WCRWgayKgvlq5dxDnWZ",
                "name": "Condition Branch",
                "title": "PassCase",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_02H4UDBGZRK4E0CBhg19YV2u05jd87Q2j1Y.output.error.code$",
                    "operator": "eq",
                    "right_operand": "200"
                  },
                  "continue_on_failure": false,
                  "display_name": "PassCase",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02H4UKU91VC5517CmjhAAkyIIMbMz8n1qM2",
                    "name": "Set Variables",
                    "title": "PassCase",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                          "variable_value_new": "Pass"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02H4UN6P7X1LR3xcwyi90eVLeRwQNC5Ieay",
                "name": "Condition Branch",
                "title": "FailCase",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_02H4UDBGZRK4E0CBhg19YV2u05jd87Q2j1Y.output.error.code$",
                    "operator": "ne",
                    "right_operand": "200"
                  },
                  "continue_on_failure": false,
                  "display_name": "FailCase",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02H4UN6P7XRLK4CSvHR332otl0n48a8rNOY",
                    "name": "Set Variables",
                    "title": "PassCase",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq.output.variable_workflow_02H4UK914860U0Xc2up0iWLqpTXZiAgLCNT$",
                          "variable_value_new": "Fail"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02H4UNIL7BWZH4CTA8fRKKqnit6tkDOTHeD",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq",
        "name": "SXO- Get Workflow Instances (V1.1 )",
        "title": "SXO- Get Workflow Instances (V1.1 )",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Instance Id's",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UJBPR11MC7U4Y6MzbHSuwvme3HRaEhSH9",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Bearer ",
              "scope": "input",
              "name": "Provide Token",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UI14NPSPU7K4lnWpU0bRq4sAvBh6mrbpD",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Provide workflow id to get the instances",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UI12PFBGGMI46GosPCeAfs97cuhRV2HPO",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Authorization",
              "scope": "local",
              "name": "Authorization",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UI14S3SGR8S2CLxZaULLiK9CeM9DL1jGv",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Instances whole Payload",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UJCX408QPTU6sQRcRQVhUxy2CNGkTkscO",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Pass / Fail",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "SXO- Get Workflow Instances (V1.1 )",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01UI0Z1Y636WF2JONYXoJF1H2RafGJQ9nzO",
            "name": "CA-Format Date Wf to get the last 1 day  instances",
            "title": "CA-Format Date Wf to get the last 1 day  instances",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "CA-Format Date Wf to get the last 1 day  instances",
              "input": {
                "variable_workflow_01UUWH1B7IEKO1TJ1QqEMHZi1hBfP3P0TLG": -86400
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "no_target": true
              },
              "workflow_id": "definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP",
              "workflow_name": "SXO -Format Date to get the WF instances"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4",
            "name": "HTTP Request",
            "title": "GET WF instances since1day from current time",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "{\n  \"owner\": [],\n  \"workflow_ids\": [\n    \"$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.input.variable_workflow_01UI12PFBGGMI46GosPCeAfs97cuhRV2HPO$\"\n  ]\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.local.variable_workflow_01UI14S3SGR8S2CLxZaULLiK9CeM9DL1jGv$",
                  "value": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.input.variable_workflow_01UI14NPSPU7K4lnWpU0bRq4sAvBh6mrbpD$"
                }
              ],
              "display_name": "GET WF instances since1day from current time",
              "method": "POST",
              "relative_url": "be-console/api/v1.1/instances?limit=100\u0026start=0\u0026date_from=$activity.definition_activity_01UI0Z1Y636WF2JONYXoJF1H2RafGJQ9nzO.output.variable_workflow_01R8RS9ZFVD7X2X7XZxO19myE297M4vT3z4$\u0026date_to=$activity.definition_activity_01UI0Z1Y636WF2JONYXoJF1H2RafGJQ9nzO.output.variable_workflow_01R8RSFF87RFT4JbuW4LpP7X4hdeMW0CH7r$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01UI5DJHLWL9R4JLiKM4lalkFSz9diKfZfP",
            "name": "JSONPath Query",
            "title": "Extract Instance Id's",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract Instance Id's",
              "input_json": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$..id",
                  "jsonpath_query_name": "Instance Ids",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01UJBPU18B3OX7lnTEJeIzKvN3hheVdE6xc",
            "name": "Set Variables",
            "title": "Storing instance Id's in O/P Variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Storing instance Id's in O/P Variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UJBPR11MC7U4Y6MzbHSuwvme3HRaEhSH9$",
                  "variable_value_new": "$activity.definition_activity_01UI5DJHLWL9R4JLiKM4lalkFSz9diKfZfP.output.jsonpath_queries.Instance Ids$"
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UJCX408QPTU6sQRcRQVhUxy2CNGkTkscO$",
                  "variable_value_new": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.response_body$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01UI7GA70XVG06Mu1lnXm1tItsR4JkwHSGb",
            "name": "Condition Block",
            "title": "Validation",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Validation",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01UI7GA7X82EF5Ktvh1li2yBz0q5B7gAb7R",
                "name": "Condition Branch",
                "title": "200 Pass",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.succeeded$",
                      "operator": "eq",
                      "right_operand": true
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "200 Pass",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01UI7GJRMFY3D4jSibqKl8l084oBTcCycBH",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                          "variable_value_new": "true"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01UI7GA9C1NYS2gLTwldKC0MmajEw7ZqKUC",
                "name": "Condition Branch",
                "title": "Error = 404 Resource Not found",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.code$",
                        "operator": "eq",
                        "right_operand": "404"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.message$",
                      "operator": "eq",
                      "right_operand": ".*Resource not found"
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "Error = 404 Resource Not found",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01UI7NYQLPCAZ3EiZMyUpdTxTMSkIOeBRGK",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01UI7J7IZO9NG2fvvZmdy4fi8zjOGq0bANn",
                "name": "Condition Branch",
                "title": "Error = 400 ObjectID is not in expected format",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_01UI0Z1Y636WF2JONYXoJF1H2RafGJQ9nzO.output.error.code$",
                        "operator": "nmw",
                        "right_operand": "400"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_01UI0Z1Y636WF2JONYXoJF1H2RafGJQ9nzO.output.error.message$",
                        "operator": "mregex",
                        "right_operand": ".*ObjectID is not in expected format"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.succeeded$",
                      "operator": "eq",
                      "right_operand": false
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "Error = 400 ObjectID is not in expected format",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01UI7NZL8LGHW6XuSKuW192ltKVxVwUSJNx",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01UI7M3PSTAS277lDGWQPANgE9pIXnF36gR",
                "name": "Condition Branch",
                "title": "500 Error- Oh no !! Something unexpected happened",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.message$",
                      "operator": "mregex",
                      "right_operand": ".*Oh no !! Something unexpected happened"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.code$",
                      "operator": "eq",
                      "right_operand": "500"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "500 Error- Oh no !! Something unexpected happened",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01UI7O0M8U6HE53q6fPgmLUkA2JvVk7URNL",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01UI7MW0M71H612RtnsDJIaQkTn1TgxYqfc",
                "name": "Condition Branch",
                "title": "500 Error- EOF Cannot connect to backend service",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.code$",
                      "operator": "mregex",
                      "right_operand": ".*Cannot connect to backend"
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01UI10JG4LAFK6LLLhjiHX9es2ojpyW3Xn4.output.error.code$",
                      "operator": "eq",
                      "right_operand": "500"
                    }
                  },
                  "continue_on_failure": true,
                  "display_name": "500 Error- EOF Cannot connect to backend service",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01UI7O5NJRNLW6eeVBslBnQlxv3ty9vTWjB",
                    "name": "Set Variables",
                    "title": "Set Variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Set Variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq.output.variable_workflow_01UI7GTLOWA2M2nHYkRpc3pjkJWs2rfZuhP$",
                          "variable_value_new": "false"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      },
      "subworkflows": [
        {
          "workflow": {
            "unique_name": "definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP",
            "name": "SXO -Format Date to get the WF instances",
            "title": "SXO -Format Date to get the WF instances",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.integer",
                "properties": {
                  "value": -86400,
                  "scope": "input",
                  "name": "provide seconds how many days need (by default 1day: -86400 )",
                  "type": "datatype.integer",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_01UUWH1B7IEKO1TJ1QqEMHZi1hBfP3P0TLG",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Date_from",
                  "type": "datatype.string",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_01R8RS9ZFVD7X2X7XZxO19myE297M4vT3z4",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Date_to",
                  "type": "datatype.string",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_01R8RSFF87RFT4JbuW4LpP7X4hdeMW0CH7r",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "display_name": "SXO -Format Date to get the WF instances",
              "runtime_user": {
                "target_default": true
              },
              "target": {
                "no_target": true
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_01UI40MTE16H05j6V3D5ElWXKzXCIKJrfsi",
                "name": "Group",
                "title": "Date_from",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Date_from",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01R8RQQSQOEQ21d8q1PcGjC6YR2k9amDMkX",
                    "name": "Calculate Date",
                    "title": "Calculate Date (Date_from)",
                    "type": "core.calculate_date",
                    "base_type": "activity",
                    "properties": {
                      "adjustment": "$workflow.definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP.input.variable_workflow_01UUWH1B7IEKO1TJ1QqEMHZi1hBfP3P0TLG$",
                      "continue_on_failure": true,
                      "display_name": "Calculate Date (Date_from)",
                      "original_date": "$workflow.definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP.output.start_time$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01R8RRK5WRID728HTfHBQCEMSvQtlfyCpxT",
                    "name": "Format Date",
                    "title": "Format Date",
                    "type": "core.format_date",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Format Date",
                      "format_string": "2006-01-02T15:04:05Z",
                      "original_date": "$activity.definition_activity_01R8RQQSQOEQ21d8q1PcGjC6YR2k9amDMkX.output.result$",
                      "skip_execution": false,
                      "use_custom_format": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01UI40QC5EMVM3TmpktL65Wz2pfUdhdS0jh",
                "name": "Group",
                "title": "(Date_to)",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "(Date_to)",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01R8RR9Q44QTF16oTPBuoM5it3uHc3P8HSZ",
                    "name": "Calculate Date",
                    "title": "Calculate Date (Date_to)",
                    "type": "core.calculate_date",
                    "base_type": "activity",
                    "properties": {
                      "adjustment": 500,
                      "continue_on_failure": true,
                      "display_name": "Calculate Date (Date_to)",
                      "original_date": "$workflow.definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP.output.start_time$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01R8RRSAE39NH41lriMFykwYdgjrMHVMCaT",
                    "name": "Format Date",
                    "title": "Format Date",
                    "type": "core.format_date",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Format Date",
                      "format_string": "2006-01-02T15:04:05Z",
                      "original_date": "$activity.definition_activity_01R8RR9Q44QTF16oTPBuoM5it3uHc3P8HSZ.output.result$",
                      "skip_execution": false,
                      "use_custom_format": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01R8RSMD8724B5UgaUIYrs09pQEce8tV7Wn",
                "name": "Set Variables",
                "title": "Storing Date formats in O/P variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Storing Date formats in O/P variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP.output.variable_workflow_01R8RS9ZFVD7X2X7XZxO19myE297M4vT3z4$",
                      "variable_value_new": "$activity.definition_activity_01R8RRK5WRID728HTfHBQCEMSvQtlfyCpxT.output.result$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP.output.variable_workflow_01R8RSFF87RFT4JbuW4LpP7X4hdeMW0CH7r$",
                      "variable_value_new": "$activity.definition_activity_01R8RRSAE39NH41lriMFykwYdgjrMHVMCaT.output.result$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ],
            "categories": [
              "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
            ]
          }
        }
      ],
      "dependent_workflows": [
        "definition_workflow_01R8RQJA9CPD51vyewbmqpvSZvNiNnllWmP"
      ]
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh",
        "name": "XDR -- UnLock LockedWorkflow Reusable",
        "title": "XDR -- UnLock LockedWorkflow Reusable",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "UnLock Test Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Provide WF_ID to UnLock",
              "type": "datatype.string",
              "description": "Provide WF_ID to Lock",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Bearer ",
              "scope": "input",
              "name": "Provide the Token",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "WF_UnLocked_Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT166HD1lJuHe4AGwB8e0OKoMJYGd",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "XDR -- UnLock LockedWorkflow Reusable",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC",
            "name": "HTTP Request",
            "title": "UnLock the WF",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck$"
                }
              ],
              "display_name": "UnLock the WF",
              "method": "PUT",
              "relative_url": "/api/v1/workflows/$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69$/unlock",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKWOJ0ML0DY6Rk2gDVnApSyhBiIEXC",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt",
            "name": "JSONPath Query",
            "title": "Fetch UnLocked Status",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch UnLocked Status",
              "input_json": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.locked",
                  "jsonpath_query_name": "locked_status_after_Unlocking",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA",
            "name": "HTTP Request",
            "title": "UnLock the WF (again-- Expected to fail)",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck$"
                }
              ],
              "display_name": "UnLock the WF (again-- Expected to fail)",
              "method": "PUT",
              "relative_url": "/api/v1/workflows/$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69$/unlock",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKYX7PSM6PX1OfNGMGxCTddihZhhNQ",
            "name": "Condition Block",
            "title": "Verify UnLock Status",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify UnLock Status",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02CZUIKZRXCH9759d6Fol388ieNGGEl8GaX",
                "name": "Condition Branch",
                "title": "WF is UnLocked",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$",
                        "operator": "eq",
                        "right_operand": "false"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "WF is UnLocked",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CZUIL1S1MT44IzcG3HjvEAyR6ZgRDjLFZ",
                    "name": "Set Variables",
                    "title": "Store Locked and TestStatus",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Store Locked and TestStatus",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.output.variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5$",
                          "variable_value_new": "Pass"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.output.variable_workflow_02CZUIKT166HD1lJuHe4AGwB8e0OKoMJYGd$",
                          "variable_value_new": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02CZUIL303S1W4UnmWHY77WfjiaLLddoLf9",
                "name": "Condition Branch",
                "title": "WF is Not UnLocked",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$",
                        "operator": "ne",
                        "right_operand": "false"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "WF is Not UnLocked",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CZUIL4ARKM42dn3P6XUuFJvzeTxDXsqWV",
                    "name": "Completed",
                    "title": "Mark As Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Mark As Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
    "definition_workflow_026YHAFYUYJSI57lobBfWruQIXVfnumQPnC",
    "definition_workflow_02EWMJH91A7RX6ISkLYJqlPHNGGEaWi0wjG",
    "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
    "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v"
  ],
  "dependent_workflows": [
    "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
    "definition_workflow_025XVBQ491IWE6dWB2g8NyL8Hu49gmEmV9o",
    "definition_workflow_026YHAFYUYJSI57lobBfWruQIXVfnumQPnC",
    "definition_workflow_02EWMJH91A7RX6ISkLYJqlPHNGGEaWi0wjG",
    "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
    "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v",
    "definition_workflow_02H4UD1DADNQ54Cygs3BFtJYDBTPCFwvxzq",
    "definition_workflow_01UI0X0G3N4EV6BFvTCezYk8CFlnpHwOmfq",
    "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh"
  ],
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:iroh_api"
    }
  ]
}