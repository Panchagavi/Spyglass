{
  "workflow": {
    "unique_name": "definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU",
    "name": "XDR-Automation-26274-AUT: Sync Observable Types",
    "title": "XDR-Automation-26274-AUT: Sync Observable Types",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "output",
          "name": "OverallStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_029OP60NWB8R67gSp7yFPb2HabLNFFCU3dN",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Bearer ",
          "scope": "input",
          "name": "Provide the Token",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_029ONMAQRBL2J10XxJAKaQ6OIUNFayaABe1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Authorization",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_029ONM17JLKWV6kYgPi9yXkAUzajR0kCiQD",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_029OOWYCDAXXC7bsuociI13leQE0YsaIMY0",
        "properties": {
          "scope": "output",
          "name": "Results",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_029OP4KYALGDS3z4qFdMluGBCBk5B5kaW05",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_029ONZHIKFF5G0nZhRbw8TGWknUVgWJoRuj",
        "properties": {
          "value": [
            {
              "column_data": {
                "Observable_Type_Values": "amp_computer_guid"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "certificate_common_name"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "certificate_issuer"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "certificate_serial"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "cisco_mid"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "cisco_unified_connector_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "cisco_nvm_uuid"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "pan_cortex_xdr_agent_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "crowdstrike_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "cybereason_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "darktrace_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "device"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "domain"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "email"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "email_messageid"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "email_subject"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "file_path"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "hostname"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "imei"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "ip"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "ipv6"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "mac_address"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "md5"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "microsoft_windows_defender_machine_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "mutex"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "ngfw_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "ngfw_name"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "odns_identity"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "odns_identity_label"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "orbital_node_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "pki_certificate_serial_numbers_for_revoked_code_signing_or_server_certificates"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "processor_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "process_name"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "process_args"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "process_hash"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "process_path"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "process_username"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "registry_key"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "registry_name"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "registry_path"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "sentinel_one_agent_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "serial_number"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "sha1"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "sha256"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "swc_device_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "trend_micro_id"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "url"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "user"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "user_agent"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "file_name"
              }
            },
            {
              "column_data": {
                "Observable_Type_Values": "imsi"
              }
            }
          ],
          "scope": "local",
          "name": "Observable_Value_26274",
          "type": "datatype.table",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_029OOAGA0CN7U1OmvsjZHl3buKMc3Ux3hkS",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "XDR-Automation-26274-AUT: Sync Observable Types",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "specify_on_workflow_start": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_029ONKQRRQPY15XR95NZ9irknrVmIUeSvPt",
        "name": "HTTP Request",
        "title": "Get Schema",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.input.variable_workflow_029ONM17JLKWV6kYgPi9yXkAUzajR0kCiQD$",
              "value": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.input.variable_workflow_029ONMAQRBL2J10XxJAKaQ6OIUNFayaABe1$"
            }
          ],
          "display_name": "Get Schema",
          "method": "GET",
          "relative_url": "api/v1/schemas?schema_type=view\u0026base_type=template_workflow",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg",
        "name": "For Each",
        "title": "For Each",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For Each",
          "skip_execution": false,
          "source_array": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.local.variable_workflow_029OOAGA0CN7U1OmvsjZHl3buKMc3Ux3hkS$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG",
            "name": "JSONPath Query",
            "title": "Fetch Observable Type Label",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Observable Type Label",
              "input_json": "$activity.definition_activity_029ONKQRRQPY15XR95NZ9irknrVmIUeSvPt.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$..wf_metadata..options[?(@.value == '$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$')].label",
                  "jsonpath_query_name": "Observable_Type_Label",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$..wf_metadata..options[?(@.value == '$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$')].value",
                  "jsonpath_query_name": "Observable_Type_Value",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_029OPGZQA0QCG2gYzuJmQeVY2beUk1TW4Td",
            "name": "Replace String",
            "title": "Modify Observable Type Label (Replace Empty Space With _)",
            "type": "core.replacestring",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Modify Observable Type Label (Replace Empty Space With _)",
              "input_string": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Label$",
              "replace_list": [
                {
                  "replaced_string": " ",
                  "replacement_string": "_"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_029OODS93TWMC4pfluy8XLsmuvs3mL5nXVn",
            "name": "Condition Block",
            "title": "Verify Observable Type and Value",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify Observable Type and Value",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_029OODSAAMYMW3rqvUvDfcWCiVmZnIg514O",
                "name": "Condition Branch",
                "title": "Labels and Values are Matched ",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Value$",
                      "operator": "eq",
                      "right_operand": "$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_029OPGZQA0QCG2gYzuJmQeVY2beUk1TW4Td.output.result_string$",
                      "operator": "eqi",
                      "right_operand": "$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Labels and Values are Matched ",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_029OP4RLVZBMG6C5d9YUnx4n6uANt9TwuJP",
                    "name": "Add Row to Table",
                    "title": "Add Row to Table",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add Row to Table",
                      "input_table": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.output.variable_workflow_029OP4KYALGDS3z4qFdMluGBCBk5B5kaW05$",
                      "row": [
                        {
                          "key": "ObservableType_Value",
                          "type": "string",
                          "value": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Value$"
                        },
                        {
                          "key": "ObservableType_Lable",
                          "type": "string",
                          "value": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Label$"
                        },
                        {
                          "key": "Aviliable_In_Schema_or_not",
                          "type": "string",
                          "value": "Pass - Observable type \"$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$\" is Present in Schema"
                        },
                        {
                          "key": "Results",
                          "type": "string",
                          "value": ""
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_029OOG8ODD29T7J7FL6j6Uc4dwqBMT9CrSL",
                "name": "Condition Branch",
                "title": "Labels and Values are not Matched ",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Value$",
                      "operator": "ne",
                      "right_operand": "$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$"
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_029OPGZQA0QCG2gYzuJmQeVY2beUk1TW4Td.output.result_string$",
                      "operator": "ne",
                      "right_operand": "$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Labels and Values are not Matched ",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_029OP5CEL0EUB7AIoy8fAgY8yT07SOG6Hkb",
                    "name": "Add Row to Table",
                    "title": "Add Row to Table",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add Row to Table",
                      "input_table": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.output.variable_workflow_029OP4KYALGDS3z4qFdMluGBCBk5B5kaW05$",
                      "row": [
                        {
                          "key": "ObservableType_Value",
                          "type": "string",
                          "value": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Value$"
                        },
                        {
                          "key": "ObservableType_Lable",
                          "type": "string",
                          "value": "$activity.definition_activity_029ONND7VJZOZ1ckTeJlaFzte0FSHVXG4wG.output.jsonpath_queries.Observable_Type_Label$"
                        },
                        {
                          "key": "Aviliable_In_Schema_or_not",
                          "type": "string",
                          "value": "Fail - Observable type \"$activity.definition_activity_029OOANA152TL67EI3Z0yMgCiH78xRmt8vg.input.source_array[@].Observable_Type_Values$\" is Absent in Schema"
                        },
                        {
                          "key": "Results",
                          "type": "string",
                          "value": ""
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_029OP82S5MPAQ37OkhkNLLQwwfjE1byzK7X",
        "name": "Select from Table",
        "title": "Select from Table",
        "type": "core.selectfromtable",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "columns": [
            {
              "column_name": "Aviliable_In_Schema_or_not",
              "column_type": "string"
            }
          ],
          "continue_on_failure": true,
          "display_name": "Select from Table",
          "input_table": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.output.variable_workflow_029OP4KYALGDS3z4qFdMluGBCBk5B5kaW05$",
          "number_of_rows": {
            "all_rows": true
          },
          "persist_output": false,
          "skip_execution": false,
          "sorting": {
            "no_sort": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_029OP8D7VI18F1ocguCSWeEwecbNRQ5B2Ni",
        "name": "Condition Block",
        "title": "Observable is Not Aviable in Schema",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Observable is Not Aviable in Schema",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_029OP8D9P5D7J3LO2tpljoM2g8XWOhdm400",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_029OP82S5MPAQ37OkhkNLLQwwfjE1byzK7X.output.response_body$",
                "operator": "mregex",
                "right_operand": ".*Fail"
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_029OP8YTQM2ZD4vT2XLeCXOlTkg0VpiAm5u",
                "name": "Set Variables",
                "title": "Failed",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.output.variable_workflow_029OP60NWB8R67gSp7yFPb2HabLNFFCU3dN$",
                      "variable_value_new": "Fail"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_029OQU4DRCST50udIDRQnHefzUfGA0ZsC5q",
                "name": "Completed",
                "title": "Stop",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Stop",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_029OP9XG7NNW95U3KHbyklUJ2gCaEQojEdC",
        "name": "Set Variables",
        "title": "Passed",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Passed",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_029OMCNVN37DQ3NROyDjsMiaAAWZSzEGrAU.output.variable_workflow_029OP60NWB8R67gSp7yFPb2HabLNFFCU3dN$",
              "variable_value_new": "Pass"
            }
          ]
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "table_types": {
    "tabletype_029ONZHIKFF5G0nZhRbw8TGWknUVgWJoRuj": {
      "unique_name": "tabletype_029ONZHIKFF5G0nZhRbw8TGWknUVgWJoRuj",
      "data_type": "datatype.tabletype",
      "display_name": "ObservableType_Value_26274",
      "description": "ObservableType_Value_26274",
      "columns": [
        {
          "name": "Observable_Type_Values",
          "title": "Observable_Type_Values",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_029OOWYCDAXXC7bsuociI13leQE0YsaIMY0": {
      "unique_name": "tabletype_029OOWYCDAXXC7bsuociI13leQE0YsaIMY0",
      "data_type": "datatype.tabletype",
      "display_name": "ObservableType_Results_26274",
      "description": "ObservableType_Results_26274",
      "columns": [
        {
          "name": "ObservableType_Value",
          "title": "ObservableType_Value",
          "type": "string"
        },
        {
          "name": "ObservableType_Lable",
          "title": "ObservableType_Lable",
          "type": "string"
        },
        {
          "name": "Aviliable_In_Schema_or_not",
          "title": "Aviliable_In_Schema_or_not?",
          "type": "string"
        },
        {
          "name": "Results",
          "title": "Results",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  }
}