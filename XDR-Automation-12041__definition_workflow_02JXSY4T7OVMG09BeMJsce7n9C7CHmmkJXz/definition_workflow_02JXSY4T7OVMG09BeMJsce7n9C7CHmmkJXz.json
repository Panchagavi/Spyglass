{
  "workflow": {
    "unique_name": "definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz",
    "name": "XDR-Automation-12041",
    "title": "XDR-Automation-12041",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Incident Creation with new status",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02JXXFREM05ON7kRFovqWaq5V5HNtURLoOO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "{\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Open\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.title$\",\n\"operator\": \"mw\",\n\"right_operand\": \"new status\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: Confirmed Threat\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: False Positive\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: Merged\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: Near-Miss\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: Other\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Closed: Suspected\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"ne\",\n\"right_operand\": \"Closed: Under Review\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Containment Achieved\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Containment Achieved\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Hold: External\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Hold: Internal\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Hold: Legal\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"New\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"ne\",\n\"right_operand\": \"New: Processing\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"New: Processing\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Open\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Open: Contained\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Open: Investigating\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"mw\",\n\"right_operand\": \"Open: Recovered\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"mw\",\n\"right_operand\": \"Open: Reported\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Rejected\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"ne\",\n\"right_operand\": \"Restoration Achieved\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.status$\",\n\"operator\": \"eq\",\n\"right_operand\": \"Stalled\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.confidence$\",\n\"right_operand\": \"High\",\n\"operator\": \"eq\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.severity$\",\n\"right_operand\": \"Critical\",\n\"operator\": \"eq\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.scores.global$\",\n\"right_operand\": \"500\",\n\"operator\": \"gte\"\n},\n\"operator\": \"and\"\n},\n\"right_operand\": {\n\"left_operand\": \"$output.incident.source$\",\n\"right_operand\": \"Umbrella\",\n\"operator\": \"eq\"\n},\n\"operator\": \"and\"\n}",
          "scope": "local",
          "name": "Provide condition with new status",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02JXW78E1QDY45c5kwVB7w8g1C2hl84Uv6H",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "XDR 12041 Overall TestStatus",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02JXYY4SFE6HX6Jwpc4W15PN5IqZlDWtEhs",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "Playbook Creation with new status",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02JXXG08KJ1O80oiGZKvVgqbJgsqwJy8GI8",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "automation_rules": {
        "type": [
          "incident.rule_event"
        ]
      },
      "delete_workflow_instance": false,
      "description": "XDR-Automation-12041\n\nCreate a WF and add incident rule with new status in condition \nCreate a Playbook wf from template and create a assignment rule with new status \nExport and Import UseCases",
      "display_name": "XDR-Automation-12041",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "target_id": "$module_target;Cisco XDR;securex:ao:sxo;automation-apis$",
        "execute_on_workflow_target": true
      },
      "wf_metadata": {
        "coa": {
          "action": [
            "alert",
            "allow",
            "augment"
          ],
          "actuator": "endpoint",
          "intent": "incident_response",
          "observable_types": [
            "domain",
            "email",
            "hostname",
            "ip",
            "ipv6",
            "md5",
            "sha1",
            "sha256",
            "url",
            "user",
            "amp_computer_guid",
            "certificate_common_name",
            "certificate_issuer",
            "certificate_serial",
            "cisco_cm_id",
            "cisco_mid",
            "cisco_uc_id",
            "cortex_agent_id",
            "crowdstrike_id",
            "cybereason_id",
            "darktrace_id",
            "device",
            "email_messageid",
            "email_subject",
            "file_name",
            "file_path",
            "imei",
            "imsi",
            "mac_address",
            "ms_machine_id",
            "mutex",
            "ngfw_id",
            "ngfw_name",
            "odns_identity",
            "odns_identity_label",
            "orbital_node_id",
            "pki_serial",
            "process_args",
            "process_hash",
            "process_name",
            "process_path",
            "process_username",
            "processor_id",
            "registry_key",
            "registry_name",
            "registry_path",
            "s1_agent_id",
            "serial_number",
            "swc_device_id",
            "trend_micro_id",
            "user_agent"
          ]
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02JXXHQKW4ZRE38oSjM8H1TSBfEyCgmjEo2",
        "name": "Parallel Block",
        "title": "XDR-12041",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "XDR-12041",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02JXXHQL97LKO3W3tKW9IZ5y1qmHxBoR6Gh",
            "name": "Parallel Branch",
            "title": "Incident Creation and Mapping a WF",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Incident Creation and Mapping a WF",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP",
                "name": "Automatation - Create Generic Workflow",
                "title": "Automatation - Create Generic Workflow",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automatation - Create Generic Workflow",
                  "input": {
                    "variable_workflow_026R3ITFC2SYD5IwFCCSGoDOyqkGJgCEwsd": "",
                    "variable_workflow_026R3ITFC37UO0GCPYutjproHMzvdvq1KRV": "",
                    "variable_workflow_026R3ITFC3WLQ0CQIbKxaAf0PetE6SpXHSj": "WF-IncidentNewStatus-$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.instance_id$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
                  "workflow_name": "Automatation - Create Generic Workflow"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXU3R3KIZSB39zfPoSLvERDxrpp0ep1we",
                "name": "Automation - AddIng an Action to the Workflow",
                "title": "Automation - AddIng an Action to the Workflow",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - AddIng an Action to the Workflow",
                  "input": {
                    "variable_workflow_01TNRGULATIS12xwBtFh5vlzkvz7165Gb4O": "{\n\"previous_action\": {\n    \"id\": \"$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\"\n  },\n  \"action\": {\n    \"type\": \"core.sleep\",\n    \"base_type\": \"activity\",\n    \"name\": \"Sleep\",\n    \"properties\": {\n      \"continue_on_failure\": false,\n      \"skip_execution\": false,\n\"sleep_interval\":1,\n      \"display_name\": \"Sleep\"\n    },\n    \"title\": \"Sleep\"\n  }\n}",
                    "variable_workflow_01TNRGULATYCS3YZOCTsAzqIqmW6pJXPjXH": "",
                    "variable_workflow_01TNRGULAU5VJ5MZJeczlceLJVuSNTUGx9Y": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                    "variable_workflow_01TNRGULAUKSY47ElJvhRkMLUfZ28jBg6Hb": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
                  "workflow_name": "Automation - AddIng an Action to the Workflow"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXU3TWF7UBX5533Im6OmyzMi13K1oeIgl",
                "name": "Automation - Validate Workflow",
                "title": "Automation - Validate Workflow",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Automation - Validate Workflow",
                  "input": {
                    "variable_workflow_026R3MTZOT2EW1USQRiDliyt5aa93GWmfiK": "",
                    "variable_workflow_026R3MTZOTILC1W3cvTmVhLsJWBnHC3vcH4": "",
                    "variable_workflow_026R3MTZOTPNC64XRWBcpmPc5VhBJBNaxj0": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
                  "workflow_name": "Automation - Validate Workflow"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXVDLHYMUWE1WEY1EXXprY3C39218wSyi",
                "name": "Group",
                "title": "Standalone Rule Creation",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Standalone Rule Creation",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883",
                    "name": "Automation - Create a Standalone Incident Rule",
                    "title": "Automation - Create a Standalone Incident Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Automation - Create a Standalone Incident Rule",
                      "input": {
                        "variable_workflow_027MPV5U2DIIF0zubA1M33SbdTCt6ZCzfq4": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                        "variable_workflow_027MPV5U2EFCD2dIXOMcCJfC8zTYKWhgvL0": "",
                        "variable_workflow_027MPV5U2ETAA17CVQcWakhMZzhJv72iREN": "",
                        "variable_workflow_027MQ2YZNQUVF083B0R4hBHunurAKbOgtJK": "st-new-status-$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.instance_id$",
                        "variable_workflow_027MQ6J9U6SFN6iWZGzhPRXoQSwKfKnmVwO": false,
                        "variable_workflow_027MTIDA440DM0hV6hVS0HKzyKm21K1dvp9": "\"conditions\": $workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.local.variable_workflow_02JXW78E1QDY45c5kwVB7w8g1C2hl84Uv6H$,",
                        "variable_workflow_028XFL5OHWNXK5o11JcxV0kSReACzV9dk57": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
                      "workflow_name": "Automation - Create a Standalone Incident Rule"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXUVH8YOI3X0U3tKWUYtzHcy9VXmzhioR",
                    "name": "HTTP Request",
                    "title": "Fetch Status and Conditions from Created ST Rule",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "Fetch Status and Conditions from Created ST Rule",
                      "method": "GET",
                      "relative_url": "/api/v1/rules/$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXUW5H2GT0X5tMYIpiB8Uj7x5zv4nPrva",
                    "name": "JSONPath Query",
                    "title": "Fetch ST Rule Status and Conditions",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch ST Rule Status and Conditions",
                      "input_json": "$activity.definition_activity_02JXUVH8YOI3X0U3tKWUYtzHcy9VXmzhioR.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.properties..status.state",
                          "jsonpath_query_name": "ST_Rule_Status",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        },
                        {
                          "jsonpath_query": "$.properties.conditions",
                          "jsonpath_query_name": "Conditions from Created ST Rule",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02JXVE02YQGOE1gjie6SjZFlMblyCwisCxP",
                "name": "Group",
                "title": "Priority Rule Creation",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Priority Rule Creation",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq",
                    "name": "Automation - Create a Priority Incident Rule",
                    "title": "Automation - Create a Priority Incident Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Automation - Create a Priority Incident Rule",
                      "input": {
                        "variable_workflow_027MR8CHBC18861hO5QjA8naySKiwdu2gyN": "pr-newstatus-$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.instance_id$",
                        "variable_workflow_027MR8CHBC96A1GWgiQyknzFoBdYsa57Emh": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                        "variable_workflow_027MR8CHBDRYU5sk9Lg2youqkRPg6xC0nRk": "",
                        "variable_workflow_027MR8CHBDYW87eMO6SYumhX8GZuks1Avqv": false,
                        "variable_workflow_027MR8CHBE5O23vojTUmq4Vl8h35vfIluId": "",
                        "variable_workflow_027MRCJ2DP2UI35v7wyIVOskvXAKOfjKrR2": true,
                        "variable_workflow_027MTARABH2P26oUCfYR8ctTuDRFybB13qe": "\"conditions\": $workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.local.variable_workflow_02JXW78E1QDY45c5kwVB7w8g1C2hl84Uv6H$,",
                        "variable_workflow_02ETBZYS6P7IE2UK8KeL6urOHwXlp7IEeXD": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
                      "workflow_name": "Automation - Create a Priority Incident Rule"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXVECK3DBQI3Cyto2rFlkt6TtS9mQkoNw",
                    "name": "HTTP Request",
                    "title": "Fetch Status and Conditions from Created PR Rule",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "Fetch Status and Conditions from Created PR Rule",
                      "method": "GET",
                      "relative_url": "/api/v1/rules/$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBDD633pQPGnXsZVl1TYdOrt5209$",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXVEEXM6FMD7F23QrKlpwcWVRs2DmfQ4p",
                    "name": "JSONPath Query",
                    "title": "Fetch PR Rule Status and Conditions",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch PR Rule Status and Conditions",
                      "input_json": "$activity.definition_activity_02JXVECK3DBQI3Cyto2rFlkt6TtS9mQkoNw.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.properties..status.state",
                          "jsonpath_query_name": "PR_Rule_Status",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        },
                        {
                          "jsonpath_query": "$.properties.conditions",
                          "jsonpath_query_name": "Conditions from Created PR Rule",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02JXVCXDPQBTK107bgjP1Ey5OydqnmXoqlL",
                "name": "XDR -- UnLock LockedWorkflow Reusable",
                "title": "XDR -- UnLock LockedWorkflow Reusable",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "XDR -- UnLock LockedWorkflow Reusable",
                  "input": {
                    "variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck": "Bearer ",
                    "variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh",
                  "workflow_name": "XDR -- UnLock LockedWorkflow Reusable"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYX3A5SUY73mDHyiHl33NZq1UdCGfmj6",
                "name": "HTTP Request",
                "title": "Export WF having Rules (New Status as Conditions)",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Export WF having Rules (New Status as Conditions)",
                  "method": "GET",
                  "relative_url": "/exchange/api/v1/workflows/export?workflow_id=$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXZ8W2W90R8278EywaF76sfoWA2SQ0mh1",
                "name": "JSONPath Query",
                "title": "Fetch WF UniqueName",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch WF UniqueName",
                  "input_json": "$activity.definition_activity_02JXYX3A5SUY73mDHyiHl33NZq1UdCGfmj6.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.workflow.unique_name",
                      "jsonpath_query_name": "exported_wf_uniqueName",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXZQ6WT2MXW1uUxqUxb3lInFhV6TTZgUG",
                "name": "Group",
                "title": "Cleanup",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Cleanup",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02JXVCSIODF1A6jr7BbBWiDduaMCL0FJ3OR",
                    "name": "Automation - Delete a Workflow",
                    "title": "Automation - Delete a Workflow",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Workflow",
                      "input": {
                        "variable_workflow_026R3PNDY8RA95VaRgAjXzUEj3wGr6HPAdD": "",
                        "variable_workflow_026R3PNDY92910xa97iBzDFhQpIJHMWlqMC": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC3HIF0D3EmshjkHgtAVGHYBZ99A$",
                        "variable_workflow_026R3PNDY9ASP1QCJH3aMfMJWdd40fPA4eY": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_026R3PNDMKDIO0lhGr43dUx4CkVU7BTcx2i",
                      "workflow_name": "Automation - Delete a Workflow"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXVCLPZI1B57K0ikwiASFbOGtI5dhM3Qp",
                    "name": "Automation - Delete a Standalone Rule",
                    "title": "Automation - Delete a Standalone Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Standalone Rule",
                      "input": {
                        "variable_workflow_027GQAZSMGF5L06O3QUxfsLAW38RATuUDJO": "",
                        "variable_workflow_027GQAZSMGTCV5TpSmr0bkH3It5zQYLtUu3": "$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MPXU910JZU3Qf8DD47CpW5iirIAtYRT0$",
                        "variable_workflow_027GQAZSMH1OJ5BK4wbuH9JasDboqqfjR7Z": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
                      "workflow_name": "Automation - Delete a Rule"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXVGIEQADC51P0WKCd9yqpYcGei3JGnLA",
                    "name": "Automation - Delete a Priority Rule",
                    "title": "Automation - Delete a Priority Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Priority Rule",
                      "input": {
                        "variable_workflow_027GQAZSMGF5L06O3QUxfsLAW38RATuUDJO": "",
                        "variable_workflow_027GQAZSMGTCV5TpSmr0bkH3It5zQYLtUu3": "$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBDD633pQPGnXsZVl1TYdOrt5209$",
                        "variable_workflow_027GQAZSMH1OJ5BK4wbuH9JasDboqqfjR7Z": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
                      "workflow_name": "Automation - Delete a Rule"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02JXZVYQEKPXM58MfVEJGJik875oWoz0VrU",
                "name": "Group",
                "title": "Import UseCase",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Import UseCase",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02JXZ9DSDGDX41YSLYicOsgCMbYNiWNgkug",
                    "name": "HTTP Request",
                    "title": "Import WF having Rules with newstatus",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "body": "$activity.definition_activity_02JXYX3A5SUY73mDHyiHl33NZq1UdCGfmj6.output.response_body$",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "Import WF having Rules with newstatus",
                      "method": "POST",
                      "relative_url": "/exchange/api/v1/workflows/import?create_new=true\u0026overwrite=false\u0026workflow_unique_name=$activity.definition_activity_02JXZ8W2W90R8278EywaF76sfoWA2SQ0mh1.output.jsonpath_queries.exported_wf_uniqueName$",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZJKX3DIC660vX3tyqBw3Tb9brmfNRif",
                    "name": "Sleep",
                    "title": "Sleep for 20s",
                    "type": "core.sleep",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Sleep for 20s",
                      "skip_execution": false,
                      "sleep_interval": 20
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZJTMCGNC93xf33JSRSHc9xFZj8xyHgN",
                    "name": "JSONPath Query",
                    "title": "Fetch Imported WF ID",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch Imported WF ID",
                      "input_json": "$activity.definition_activity_02JXZ9DSDGDX41YSLYicOsgCMbYNiWNgkug.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.id",
                          "jsonpath_query_name": "imported_wf_id",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZKARCP6DJ44yeTzCkc7GHoYvHxFLM1n",
                    "name": "Sleep",
                    "title": "Sleep for 5s",
                    "type": "core.sleep",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Sleep for 5s",
                      "skip_execution": false,
                      "sleep_interval": 5
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZKKYY8YT62UvJIQwe3YD8V9H7elAHCE",
                    "name": "HTTP Request",
                    "title": "GET  Imported WF ID by Rules",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "GET  Imported WF ID by Rules",
                      "method": "GET",
                      "relative_url": "/api/v1/workflows/$activity.definition_activity_02JXZJTMCGNC93xf33JSRSHc9xFZj8xyHgN.output.jsonpath_queries.imported_wf_id$/rules",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZLLO9ARCN5U4Bcgd7bDvukMYsp9HDBr",
                    "name": "Sleep",
                    "title": "Sleep for 5s",
                    "type": "core.sleep",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Sleep for 5s",
                      "skip_execution": false,
                      "sleep_interval": 5
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZLOIKUJSY3fmaUEyXgbZwYshVIse8w7",
                    "name": "JSONPath Query",
                    "title": "Fetch Imported RulesID",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch Imported RulesID",
                      "input_json": "$activity.definition_activity_02JXZKKYY8YT62UvJIQwe3YD8V9H7elAHCE.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$..[?(@.title==\"st-new-status-$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.instance_id$\")].id",
                          "jsonpath_query_name": "imported_st_rule",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        },
                        {
                          "jsonpath_query": "$..[?(@.title==\"pr-newstatus-$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.instance_id$\")].id",
                          "jsonpath_query_name": "imported_pr_rule",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZNECMM35A3rh0qjSZYekv4WqT47HAGb",
                    "name": "HTTP Request",
                    "title": "GET PR Rule by ID",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "GET PR Rule by ID",
                      "method": "GET",
                      "relative_url": "/api/v1/rules/$activity.definition_activity_02JXZLOIKUJSY3fmaUEyXgbZwYshVIse8w7.output.jsonpath_queries.imported_pr_rule$",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZO5BLYRZ11NC7OikcBqpsHOi0IZSHjh",
                    "name": "JSONPath Query",
                    "title": "Fetch Rule status and Condition",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch Rule status and Condition",
                      "input_json": "$activity.definition_activity_02JXZNECMM35A3rh0qjSZYekv4WqT47HAGb.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.properties..status.state",
                          "jsonpath_query_name": "imported_pr_rule_status",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        },
                        {
                          "jsonpath_query": "$.properties.conditions",
                          "jsonpath_query_name": "imported_pr_rule_conditions",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZNV5970033HrXOHlpuRszvA4eIHdb0G",
                    "name": "HTTP Request",
                    "title": "GET ST Rule by ID",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": true,
                      "display_name": "GET ST Rule by ID",
                      "method": "GET",
                      "relative_url": "/api/v1/rules/$activity.definition_activity_02JXZLOIKUJSY3fmaUEyXgbZwYshVIse8w7.output.jsonpath_queries.imported_st_rule$",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target": true
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZP8V9KOXO4jtyUZ0lXvdahGYWUfyBlf",
                    "name": "JSONPath Query",
                    "title": "Fetch Rule status and Condition",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Fetch Rule status and Condition",
                      "input_json": "$activity.definition_activity_02JXZNV5970033HrXOHlpuRszvA4eIHdb0G.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.properties..status.state",
                          "jsonpath_query_name": "imported_st_rule_status",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        },
                        {
                          "jsonpath_query": "$.properties.conditions",
                          "jsonpath_query_name": "imported_st_rule_conditions",
                          "jsonpath_query_type": "string",
                          "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02JXZQGB3UTIG3rXYc1zgnoyeBCzinpGArw",
                "name": "Group",
                "title": "Cleanup",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Cleanup",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02JXZQGB3X6534X1JG1RVb77VNYrIdOmyvH",
                    "name": "Automation - Delete a Workflow",
                    "title": "Automation - Delete a Workflow",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Workflow",
                      "input": {
                        "variable_workflow_026R3PNDY8RA95VaRgAjXzUEj3wGr6HPAdD": "",
                        "variable_workflow_026R3PNDY92910xa97iBzDFhQpIJHMWlqMC": "$activity.definition_activity_02JXZJTMCGNC93xf33JSRSHc9xFZj8xyHgN.output.jsonpath_queries.imported_wf_id$",
                        "variable_workflow_026R3PNDY9ASP1QCJH3aMfMJWdd40fPA4eY": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_026R3PNDMKDIO0lhGr43dUx4CkVU7BTcx2i",
                      "workflow_name": "Automation - Delete a Workflow"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZQGB40JD22Z9Xn9AgHZFAZbcIv1rvbo",
                    "name": "Automation - Delete a Standalone Rule",
                    "title": "Automation - Delete a Standalone Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Standalone Rule",
                      "input": {
                        "variable_workflow_027GQAZSMGF5L06O3QUxfsLAW38RATuUDJO": "",
                        "variable_workflow_027GQAZSMGTCV5TpSmr0bkH3It5zQYLtUu3": "$activity.definition_activity_02JXZLOIKUJSY3fmaUEyXgbZwYshVIse8w7.output.jsonpath_queries.imported_st_rule$",
                        "variable_workflow_027GQAZSMH1OJ5BK4wbuH9JasDboqqfjR7Z": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
                      "workflow_name": "Automation - Delete a Rule"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02JXZQGB41B7D0beZsAZFxSbiud8Z7uDW3W",
                    "name": "Automation - Delete a Priority Rule",
                    "title": "Automation - Delete a Priority Rule",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Automation - Delete a Priority Rule",
                      "input": {
                        "variable_workflow_027GQAZSMGF5L06O3QUxfsLAW38RATuUDJO": "",
                        "variable_workflow_027GQAZSMGTCV5TpSmr0bkH3It5zQYLtUu3": "$activity.definition_activity_02JXZLOIKUJSY3fmaUEyXgbZwYshVIse8w7.output.jsonpath_queries.imported_pr_rule$",
                        "variable_workflow_027GQAZSMH1OJ5BK4wbuH9JasDboqqfjR7Z": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
                      "workflow_name": "Automation - Delete a Rule"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02JXXDZB6JBBE2L1cHbnMzlpmlWjR1BqYc7",
                "name": "Condition Block",
                "title": "Verify Incident Creation with new Status",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verify Incident Creation with new Status",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02JXXDZBGBFXW7hTCbhCCzsLlBkDKo63zkD",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": {
                                                                    "left_operand": {
                                                                      "left_operand": {
                                                                        "left_operand": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC43F43oBn9BzrOKiM8NvxxcNOrN$",
                                                                        "operator": "eq",
                                                                        "right_operand": "true"
                                                                      },
                                                                      "operator": "and",
                                                                      "right_operand": {
                                                                        "left_operand": "$activity.definition_activity_02JXU3R3KIZSB39zfPoSLvERDxrpp0ep1we.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                        "operator": "eq",
                                                                        "right_operand": "true"
                                                                      }
                                                                    },
                                                                    "operator": "and",
                                                                    "right_operand": {
                                                                      "left_operand": "$activity.definition_activity_02JXU3TWF7UBX5533Im6OmyzMi13K1oeIgl.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                      "operator": "eq",
                                                                      "right_operand": "true"
                                                                    }
                                                                  },
                                                                  "operator": "and",
                                                                  "right_operand": {
                                                                    "left_operand": "$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                                    "operator": "eq",
                                                                    "right_operand": "true"
                                                                  }
                                                                },
                                                                "operator": "and",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MQASRSDCSY4NQnhKVVh2pqV7fmLwoXpc$",
                                                                  "operator": "eq",
                                                                  "right_operand": "started-polling"
                                                                }
                                                              },
                                                              "operator": "and",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02JXUVH8YOI3X0U3tKWUYtzHcy9VXmzhioR.output.error.code$",
                                                                "operator": "eq",
                                                                "right_operand": "200"
                                                              }
                                                            },
                                                            "operator": "and",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02JXUW5H2GT0X5tMYIpiB8Uj7x5zv4nPrva.output.jsonpath_queries.ST_Rule_Status$",
                                                              "operator": "eq",
                                                              "right_operand": "started-polling"
                                                            }
                                                          },
                                                          "operator": "and",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBBPAY2Ir8OSHRgquZ2IQJVUoSsz$",
                                                            "operator": "eq",
                                                            "right_operand": "true"
                                                          }
                                                        },
                                                        "operator": "and",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02JXVECK3DBQI3Cyto2rFlkt6TtS9mQkoNw.output.error.code$",
                                                          "operator": "eq",
                                                          "right_operand": "200"
                                                        }
                                                      },
                                                      "operator": "and",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02JXVEEXM6FMD7F23QrKlpwcWVRs2DmfQ4p.output.jsonpath_queries.PR_Rule_Status$",
                                                        "operator": "eq",
                                                        "right_operand": "started-polling"
                                                      }
                                                    },
                                                    "operator": "and",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02JXVCXDPQBTK107bgjP1Ey5OydqnmXoqlL.output.variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5$",
                                                      "operator": "eq",
                                                      "right_operand": "Pass"
                                                    }
                                                  },
                                                  "operator": "and",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02JXVCSIODF1A6jr7BbBWiDduaMCL0FJ3OR.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                                                    "operator": "eq",
                                                    "right_operand": "true"
                                                  }
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02JXVCLPZI1B57K0ikwiASFbOGtI5dhM3Qp.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                                                  "operator": "eq",
                                                  "right_operand": "true"
                                                }
                                              },
                                              "operator": "and",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02JXVGIEQADC51P0WKCd9yqpYcGei3JGnLA.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                                                "operator": "eq",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "and",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBCP4Z6SugO88nxcdWtJR6cD7mwD$",
                                              "operator": "eq",
                                              "right_operand": "started-polling"
                                            }
                                          },
                                          "operator": "and",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02JXYX3A5SUY73mDHyiHl33NZq1UdCGfmj6.output.error.code$",
                                            "operator": "eq",
                                            "right_operand": "200"
                                          }
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02JXZ9DSDGDX41YSLYicOsgCMbYNiWNgkug.output.error.code$",
                                          "operator": "eq",
                                          "right_operand": "200"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02JXZKKYY8YT62UvJIQwe3YD8V9H7elAHCE.output.error.code$",
                                        "operator": "eq",
                                        "right_operand": "200"
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02JXZNECMM35A3rh0qjSZYekv4WqT47HAGb.output.error.code$",
                                      "operator": "eq",
                                      "right_operand": "200"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02JXZO5BLYRZ11NC7OikcBqpsHOi0IZSHjh.output.jsonpath_queries.imported_pr_rule_status$",
                                    "operator": "eq",
                                    "right_operand": "started-polling"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02JXZNV5970033HrXOHlpuRszvA4eIHdb0G.output.error.code$",
                                  "operator": "eq",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02JXZP8V9KOXO4jtyUZ0lXvdahGYWUfyBlf.output.jsonpath_queries.imported_st_rule_status$",
                                "operator": "eq",
                                "right_operand": "started-polling"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02JXZQGB3X6534X1JG1RVb77VNYrIdOmyvH.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                              "operator": "eq",
                              "right_operand": "true"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02JXZQGB40JD22Z9Xn9AgHZFAZbcIv1rvbo.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                            "operator": "eq",
                            "right_operand": "true"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02JXZQGB41B7D0beZsAZFxSbiud8Z7uDW3W.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                          "operator": "eq",
                          "right_operand": "true"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02JXXNV3LA3MK4a3Zr4w6ALchOsPw0NDKkC",
                        "name": "Set Variables",
                        "title": "PassCase",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "PassCase",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXFREM05ON7kRFovqWaq5V5HNtURLoOO$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_02JXZTGJ3VXUU455qNqx9S2C5dtGlD7ZDUy",
                    "name": "Condition Branch",
                    "title": "FailCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": {
                                                                    "left_operand": {
                                                                      "left_operand": {
                                                                        "left_operand": "$activity.definition_activity_02JXU3MV6BN3O6aSX1eF0XLoxAJG5DjtmYP.output.variable_workflow_026R3ITFC43F43oBn9BzrOKiM8NvxxcNOrN$",
                                                                        "operator": "ne",
                                                                        "right_operand": "true"
                                                                      },
                                                                      "operator": "or",
                                                                      "right_operand": {
                                                                        "left_operand": "$activity.definition_activity_02JXU3R3KIZSB39zfPoSLvERDxrpp0ep1we.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                        "operator": "ne",
                                                                        "right_operand": "true"
                                                                      }
                                                                    },
                                                                    "operator": "or",
                                                                    "right_operand": {
                                                                      "left_operand": "$activity.definition_activity_02JXU3TWF7UBX5533Im6OmyzMi13K1oeIgl.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                      "operator": "ne",
                                                                      "right_operand": "true"
                                                                    }
                                                                  },
                                                                  "operator": "or",
                                                                  "right_operand": {
                                                                    "left_operand": "$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MPV5U2E0AP2iC7VW29dyXnt1pH5TTUYm$",
                                                                    "operator": "ne",
                                                                    "right_operand": "true"
                                                                  }
                                                                },
                                                                "operator": "or",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02JXU60T7B9AO5E7Ix70m2izAciPkttG883.output.variable_workflow_027MQASRSDCSY4NQnhKVVh2pqV7fmLwoXpc$",
                                                                  "operator": "ne",
                                                                  "right_operand": "started-polling"
                                                                }
                                                              },
                                                              "operator": "or",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02JXUVH8YOI3X0U3tKWUYtzHcy9VXmzhioR.output.error.code$",
                                                                "operator": "ne",
                                                                "right_operand": "200"
                                                              }
                                                            },
                                                            "operator": "or",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02JXUW5H2GT0X5tMYIpiB8Uj7x5zv4nPrva.output.jsonpath_queries.ST_Rule_Status$",
                                                              "operator": "ne",
                                                              "right_operand": "started-polling"
                                                            }
                                                          },
                                                          "operator": "or",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBBPAY2Ir8OSHRgquZ2IQJVUoSsz$",
                                                            "operator": "ne",
                                                            "right_operand": "true"
                                                          }
                                                        },
                                                        "operator": "or",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02JXVECK3DBQI3Cyto2rFlkt6TtS9mQkoNw.output.error.code$",
                                                          "operator": "ne",
                                                          "right_operand": "200"
                                                        }
                                                      },
                                                      "operator": "or",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02JXVEEXM6FMD7F23QrKlpwcWVRs2DmfQ4p.output.jsonpath_queries.PR_Rule_Status$",
                                                        "operator": "ne",
                                                        "right_operand": "started-polling"
                                                      }
                                                    },
                                                    "operator": "or",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02JXVCXDPQBTK107bgjP1Ey5OydqnmXoqlL.output.variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5$",
                                                      "operator": "ne",
                                                      "right_operand": "Pass"
                                                    }
                                                  },
                                                  "operator": "or",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02JXVCSIODF1A6jr7BbBWiDduaMCL0FJ3OR.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                                                    "operator": "ne",
                                                    "right_operand": "true"
                                                  }
                                                },
                                                "operator": "or",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02JXVCLPZI1B57K0ikwiASFbOGtI5dhM3Qp.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                                                  "operator": "ne",
                                                  "right_operand": "true"
                                                }
                                              },
                                              "operator": "or",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02JXVGIEQADC51P0WKCd9yqpYcGei3JGnLA.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                                                "operator": "ne",
                                                "right_operand": "true"
                                              }
                                            },
                                            "operator": "or",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02JXVEAOLRS8F6Qe2bZnzdDqypVDfLoRDNq.output.variable_workflow_027MR8CHBCP4Z6SugO88nxcdWtJR6cD7mwD$",
                                              "operator": "ne",
                                              "right_operand": "started-polling"
                                            }
                                          },
                                          "operator": "or",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02JXYX3A5SUY73mDHyiHl33NZq1UdCGfmj6.output.error.code$",
                                            "operator": "ne",
                                            "right_operand": "200"
                                          }
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02JXZ9DSDGDX41YSLYicOsgCMbYNiWNgkug.output.error.code$",
                                          "operator": "ne",
                                          "right_operand": "200"
                                        }
                                      },
                                      "operator": "or",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02JXZKKYY8YT62UvJIQwe3YD8V9H7elAHCE.output.error.code$",
                                        "operator": "ne",
                                        "right_operand": "200"
                                      }
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02JXZNECMM35A3rh0qjSZYekv4WqT47HAGb.output.error.code$",
                                      "operator": "ne",
                                      "right_operand": "200"
                                    }
                                  },
                                  "operator": "or",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02JXZO5BLYRZ11NC7OikcBqpsHOi0IZSHjh.output.jsonpath_queries.imported_pr_rule_status$",
                                    "operator": "ne",
                                    "right_operand": "started-polling"
                                  }
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02JXZNV5970033HrXOHlpuRszvA4eIHdb0G.output.error.code$",
                                  "operator": "ne",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02JXZP8V9KOXO4jtyUZ0lXvdahGYWUfyBlf.output.jsonpath_queries.imported_st_rule_status$",
                                "operator": "ne",
                                "right_operand": "started-polling"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02JXZQGB3X6534X1JG1RVb77VNYrIdOmyvH.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                              "operator": "ne",
                              "right_operand": "true"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02JXZQGB40JD22Z9Xn9AgHZFAZbcIv1rvbo.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                            "operator": "ne",
                            "right_operand": "true"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02JXZQGB41B7D0beZsAZFxSbiud8Z7uDW3W.output.variable_workflow_027GQAZSMHA526UFqAQCkVsycl7lWJM9WQh$",
                          "operator": "ne",
                          "right_operand": "true"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "FailCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02JXZTGJ3X9PS1EDhboqxKhbla2qdYdt3Lh",
                        "name": "Set Variables",
                        "title": "FailCase",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "FailCase",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXFREM05ON7kRFovqWaq5V5HNtURLoOO$",
                              "variable_value_new": "Fail"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02JXXHQLHW0440WFgrYCrvEi2GmfwYVZl06",
            "name": "Parallel Branch",
            "title": "Playbook Rule Creation with New Status",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Playbook Rule Creation with New Status",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02JXY0BVOXY416cuRsh1NFmFWjLDJOQuedR",
                "name": "XDR-Automation-Atomic-Creating WF Using Template",
                "title": "XDR-Automation-Atomic-Creating WF Using Template",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "XDR-Automation-Atomic-Creating WF Using Template",
                  "input": {
                    "variable_workflow_02AOGHGZ8XXJF6VakCwn6dN4seKUIJrF8f0": "",
                    "variable_workflow_02AOGHQKS7LN56QFlKiV2wbkRZSd0GFgDQH": "",
                    "variable_workflow_02AOGO15MTXWY7gRFaKV67BXJbsg2gqhlEG": "playbook",
                    "variable_workflow_02AOGV0KB4F0Y45c4CJjE27IPMfBC8D2abG": "\"domain\",\"email\",\"hostname\",\"ip\",\"ipv6\",\"md5\",\"sha1\",\"sha256\",\"url\",\"user\",\"amp_computer_guid\",\"certificate_common_name\",\"certificate_issuer\",\"certificate_serial\",\"cisco_cm_id\",\"cisco_mid\",\"cisco_uc_id\",\"cortex_agent_id\",\"crowdstrike_id\",\"cybereason_id\",\"darktrace_id\",\"device\",\"email_messageid\",\"email_subject\",\"file_name\",\"file_path\",\"imei\",\"imsi\",\"mac_address\",\"ms_machine_id\",\"mutex\",\"ngfw_id\",\"ngfw_name\",\"odns_identity\",\"odns_identity_label\",\"orbital_node_id\",\"pki_serial\",\"process_args\",\"process_hash\",\"process_name\",\"process_path\",\"process_username\",\"processor_id\",\"registry_key\",\"registry_name\",\"registry_path\",\"s1_agent_id\",\"serial_number\",\"swc_device_id\",\"trend_micro_id\",\"user_agent\"",
                    "variable_workflow_02AOHOFCO0W784sXKcSgMEXqzBeSKbjdUQp": "\"approval_task.rule_event\",\"email.rule_event\",\"incident.rule_event\",\"schedule.rule_schedule\",\"webhook.rule_event\"",
                    "variable_workflow_02CFFIYZV06IZ3wdWvM06g4g5F3hnIlkAyR": "\"alert\", \"allow\", \"augment\", \"contain\", \"delete\", \"deny\", \"detonate\", \"distill\", \"get\", \"investigate\", \"locate\", \"mitigate\", \"modify\", \"move\", \"notify\", \"other\", \"pause\", \"query\", \"redirect\", \"remediate\", \"report\", \"response\", \"restart\", \"restore\", \"resume\", \"save\", \"scan\", \"set\", \"snapshot\", \"start\", \"stop\", \"substitute\", \"sync\", \"throttle\", \"update\"",
                    "variable_workflow_02D0TE1W3DNPI0E7Y3cWuaGsOkohRFFj04e": "",
                    "variable_workflow_02EK2LG16ABES6OWMTx3XYK3R2OS9tXJVGj": "playbook-WF-NewStatus",
                    "variable_workflow_02GH1JMP9C6UJ2IDEbIY6hozlPWXuFa2hS3": ", \"actuator\": \"endpoint\""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
                  "workflow_name": "XDR-Automation-Atomic-Creating WF Using Template"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXY1Z20BKPO6CKmOEVD2Rnn0yWjuGdDty",
                "name": "XDR -- Create a Playbook Resuable WF",
                "title": "XDR -- Create a Playbook Resuable WF",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "XDR -- Create a Playbook Resuable WF",
                  "input": {
                    "variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl": "Authorization",
                    "variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8": "Bearer ",
                    "variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg": "$activity.definition_activity_02JXY0BVOXY416cuRsh1NFmFWjLDJOQuedR.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:playbook;playbook-apis$",
                    "target_type": "web-service.endpoint"
                  },
                  "workflow_id": "definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U",
                  "workflow_name": "XDR -- Create a Playbook Resuable WF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXY2S4QYWIZ6tfLW5smeUKtOy9mHm3WEE",
                "name": "XDR - Assignment Rule Creation",
                "title": "XDR - Assignment Rule Creation",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "XDR - Assignment Rule Creation",
                  "input": {
                    "variable_workflow_02CHZW8683OFY40aC7O1gvgSgTCYuTVQubp": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": {\n          \"left_operand\": {\n            \"left_operand\": {\n              \"left_operand\": {\n                \"left_operand\": {\n                  \"left_operand\": {\n                    \"left_operand\": {\n                      \"left_operand\": {\n                        \"left_operand\": {\n                          \"left_operand\": {\n                            \"left_operand\": {\n                              \"left_operand\": {\n                                \"left_operand\": {\n                                  \"left_operand\": {\n                                    \"left_operand\": {\n                                      \"left_operand\": {\n                                        \"left_operand\": {\n                                          \"left_operand\": {\n                                            \"left_operand\": {\n                                              \"left_operand\": {\n                                                \"left_operand\": {\n                                                  \"left_operand\": {\n                                                    \"left_operand\": {\n                                                      \"left_operand\": {\n                                                        \"left_operand\": {\n                                                          \"left_operand\": {\n                                                            \"left_operand\": {\n                                                              \"left_operand\": \"$output.incident.status$\",\n                                                              \"operator\": \"eq\",\n                                                              \"right_operand\": \"Open\"\n                                                            },\n                                                            \"right_operand\": {\n                                                              \"left_operand\": \"$output.incident.title$\",\n                                                              \"operator\": \"mw\",\n                                                              \"right_operand\": \"new status\"\n                                                            },\n                                                            \"operator\": \"and\"\n                                                          },\n                                                          \"right_operand\": {\n                                                            \"left_operand\": \"$output.incident.status$\",\n                                                            \"operator\": \"eq\",\n                                                            \"right_operand\": \"Closed: Confirmed Threat\"\n                                                          },\n                                                          \"operator\": \"and\"\n                                                        },\n                                                        \"right_operand\": {\n                                                          \"left_operand\": \"$output.incident.status$\",\n                                                          \"operator\": \"eq\",\n                                                          \"right_operand\": \"Closed: False Positive\"\n                                                        },\n                                                        \"operator\": \"and\"\n                                                      },\n                                                      \"right_operand\": {\n                                                        \"left_operand\": \"$output.incident.status$\",\n                                                        \"operator\": \"eq\",\n                                                        \"right_operand\": \"Closed: Merged\"\n                                                      },\n                                                      \"operator\": \"and\"\n                                                    },\n                                                    \"right_operand\": {\n                                                      \"left_operand\": \"$output.incident.status$\",\n                                                      \"operator\": \"eq\",\n                                                      \"right_operand\": \"Closed: Near-Miss\"\n                                                    },\n                                                    \"operator\": \"and\"\n                                                  },\n                                                  \"right_operand\": {\n                                                    \"left_operand\": \"$output.incident.status$\",\n                                                    \"operator\": \"eq\",\n                                                    \"right_operand\": \"Closed: Other\"\n                                                  },\n                                                  \"operator\": \"and\"\n                                                },\n                                                \"right_operand\": {\n                                                  \"left_operand\": \"$output.incident.status$\",\n                                                  \"operator\": \"eq\",\n                                                  \"right_operand\": \"Closed: Suspected\"\n                                                },\n                                                \"operator\": \"and\"\n                                              },\n                                              \"right_operand\": {\n                                                \"left_operand\": \"$output.incident.status$\",\n                                                \"operator\": \"ne\",\n                                                \"right_operand\": \"Closed: Under Review\"\n                                              },\n                                              \"operator\": \"and\"\n                                            },\n                                            \"right_operand\": {\n                                              \"left_operand\": \"$output.incident.status$\",\n                                              \"operator\": \"eq\",\n                                              \"right_operand\": \"Containment Achieved\"\n                                            },\n                                            \"operator\": \"and\"\n                                          },\n                                          \"right_operand\": {\n                                            \"left_operand\": \"$output.incident.status$\",\n                                            \"operator\": \"eq\",\n                                            \"right_operand\": \"Containment Achieved\"\n                                          },\n                                          \"operator\": \"and\"\n                                        },\n                                        \"right_operand\": {\n                                          \"left_operand\": \"$output.incident.status$\",\n                                          \"operator\": \"eq\",\n                                          \"right_operand\": \"Hold: External\"\n                                        },\n                                        \"operator\": \"and\"\n                                      },\n                                      \"right_operand\": {\n                                        \"left_operand\": \"$output.incident.status$\",\n                                        \"operator\": \"eq\",\n                                        \"right_operand\": \"Hold: Internal\"\n                                      },\n                                      \"operator\": \"and\"\n                                    },\n                                    \"right_operand\": {\n                                      \"left_operand\": \"$output.incident.status$\",\n                                      \"operator\": \"eq\",\n                                      \"right_operand\": \"Hold: Legal\"\n                                    },\n                                    \"operator\": \"and\"\n                                  },\n                                  \"right_operand\": {\n                                    \"left_operand\": \"$output.incident.status$\",\n                                    \"operator\": \"eq\",\n                                    \"right_operand\": \"New\"\n                                  },\n                                  \"operator\": \"and\"\n                                },\n                                \"right_operand\": {\n                                  \"left_operand\": \"$output.incident.status$\",\n                                  \"operator\": \"ne\",\n                                  \"right_operand\": \"New: Processing\"\n                                },\n                                \"operator\": \"and\"\n                              },\n                              \"right_operand\": {\n                                \"left_operand\": \"$output.incident.status$\",\n                                \"operator\": \"eq\",\n                                \"right_operand\": \"New: Processing\"\n                              },\n                              \"operator\": \"and\"\n                            },\n                            \"right_operand\": {\n                              \"left_operand\": \"$output.incident.status$\",\n                              \"operator\": \"eq\",\n                              \"right_operand\": \"Open\"\n                            },\n                            \"operator\": \"and\"\n                          },\n                          \"right_operand\": {\n                            \"left_operand\": \"$output.incident.status$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": \"Open: Contained\"\n                          },\n                          \"operator\": \"and\"\n                        },\n                        \"right_operand\": {\n                          \"left_operand\": \"$output.incident.status$\",\n                          \"operator\": \"eq\",\n                          \"right_operand\": \"Open: Investigating\"\n                        },\n                        \"operator\": \"and\"\n                      },\n                      \"right_operand\": {\n                        \"left_operand\": \"$output.incident.status$\",\n                        \"operator\": \"mw\",\n                        \"right_operand\": \"Open: Recovered\"\n                      },\n                      \"operator\": \"and\"\n                    },\n                    \"right_operand\": {\n                      \"left_operand\": \"$output.incident.status$\",\n                      \"operator\": \"mw\",\n                      \"right_operand\": \"Open: Reported\"\n                    },\n                    \"operator\": \"and\"\n                  },\n                  \"right_operand\": {\n                    \"left_operand\": \"$output.incident.status$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": \"Rejected\"\n                  },\n                  \"operator\": \"and\"\n                },\n                \"right_operand\": {\n                  \"left_operand\": \"$output.incident.status$\",\n                  \"operator\": \"ne\",\n                  \"right_operand\": \"Restoration Achieved\"\n                },\n                \"operator\": \"and\"\n              },\n              \"right_operand\": {\n                \"left_operand\": \"$output.incident.status$\",\n                \"operator\": \"eq\",\n                \"right_operand\": \"Stalled\"\n              },\n              \"operator\": \"and\"\n            },\n            \"right_operand\": {\n              \"left_operand\": \"$output.incident.confidence$\",\n              \"right_operand\": \"High\",\n              \"operator\": \"eq\"\n            },\n            \"operator\": \"and\"\n          },\n          \"right_operand\": {\n            \"left_operand\": \"$output.incident.severity$\",\n            \"right_operand\": \"Critical\",\n            \"operator\": \"eq\"\n          },\n          \"operator\": \"and\"\n        },\n        \"right_operand\": {\n          \"left_operand\": \"$output.incident.scores.global$\",\n          \"right_operand\": \"500\",\n          \"operator\": \"gte\"\n        },\n        \"operator\": \"and\"\n      },\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.source$\",\n        \"right_operand\": \"Umbrella\",\n        \"operator\": \"eq\"\n      },\n      \"operator\": \"and\"\n    },",
                    "variable_workflow_02CHZYW0O09R90uaINBHRHbWmY00eSJeSDF": "$activity.definition_activity_02JXY1Z20BKPO6CKmOEVD2Rnn0yWjuGdDty.output.variable_workflow_02CHYY4GY92VF1xlgdyxXQ2kuqTnHhnMFyy$",
                    "variable_workflow_02CHZZ30F8WSW0Klz4asuNPA4Hg7NqSphtO": "Authorization",
                    "variable_workflow_02CHZZD46895S5pCr050k95x91ktdU9LCYG": "Bearer "
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:sxo;automation-apis$",
                    "target_type": "web-service.endpoint"
                  },
                  "workflow_id": "definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb",
                  "workflow_name": "XDR - Assignment Rule Creation"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYOQBDX9IG6txGVskX60mShRyL4cmK4H",
                "name": "HTTP Request",
                "title": "GET Assignment Rule",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "display_name": "GET Assignment Rule",
                  "method": "GET",
                  "relative_url": "api/v1/rules/$activity.definition_activity_02JXY2S4QYWIZ6tfLW5smeUKtOy9mHm3WEE.output.variable_workflow_02CI036PKZ9DV3rbNAs3xb1cihTJ5kqgxlk$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYP7UYH37Y3QRaVtClW49v8VRQIN1t1S",
                "name": "JSONPath Query",
                "title": "Fetch Playbook Rule Status and Conditions",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Fetch Playbook Rule Status and Conditions",
                  "input_json": "$activity.definition_activity_02JXYOQBDX9IG6txGVskX60mShRyL4cmK4H.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.properties..status.state",
                      "jsonpath_query_name": "Playbook_Rule_Status",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.properties.conditions",
                      "jsonpath_query_name": "Conditions from Created Playbook Rule",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYQ7Y9LAG94qPv0f5sFm62ocwCjlYaL5",
                "name": "Sleep",
                "title": "Sleep for 10s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 10s",
                  "skip_execution": false,
                  "sleep_interval": 10
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYO1UROX087Cy7mbXoaMZGQTlfSOFtxq",
                "name": "HTTP Request",
                "title": "Delete Assignment Rule",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Delete Assignment Rule",
                  "method": "DELETE",
                  "relative_url": "api/v1/rules/$activity.definition_activity_02JXY2S4QYWIZ6tfLW5smeUKtOy9mHm3WEE.output.variable_workflow_02CI036PKZ9DV3rbNAs3xb1cihTJ5kqgxlk$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYOWNXU9UO2S5kgiHmE4yCfwC2J9YPm3",
                "name": "Sleep",
                "title": "Sleep for 10s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 10s",
                  "skip_execution": false,
                  "sleep_interval": 10
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYNHFUMEH52hRPvc3sCeymciBw1tQgMI",
                "name": "HTTP Request",
                "title": "Delete Playbook",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Delete Playbook",
                  "method": "DELETE",
                  "relative_url": "/v1/playbook/$activity.definition_activity_02JXY1Z20BKPO6CKmOEVD2Rnn0yWjuGdDty.output.variable_workflow_02CHYY4GY92VF1xlgdyxXQ2kuqTnHhnMFyy$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:playbook;playbook-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYQFX809T12J70mzpNUcGoGzpOdgJVko",
                "name": "Automation - Delete a Workflow",
                "title": "Automation - Delete a Workflow",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Delete a Workflow",
                  "input": {
                    "variable_workflow_026R3PNDY8RA95VaRgAjXzUEj3wGr6HPAdD": "",
                    "variable_workflow_026R3PNDY92910xa97iBzDFhQpIJHMWlqMC": "$activity.definition_activity_02JXY0BVOXY416cuRsh1NFmFWjLDJOQuedR.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$",
                    "variable_workflow_026R3PNDY9ASP1QCJH3aMfMJWdd40fPA4eY": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_026R3PNDMKDIO0lhGr43dUx4CkVU7BTcx2i",
                  "workflow_name": "Automation - Delete a Workflow"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYQQLPQ9LF6vUQOgnBwHcrf9xXYlFTAD",
                "name": "Condition Block",
                "title": "Verify Creation of Playbook rule with New status",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "conditions": [],
                  "continue_on_failure": false,
                  "display_name": "Verify Creation of Playbook rule with New status",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02JXYQQLYS1K73kZE5P82etm590DmVoX9Z2",
                    "name": "Condition Branch",
                    "title": "PassCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": "$activity.definition_activity_02JXY0BVOXY416cuRsh1NFmFWjLDJOQuedR.output.variable_workflow_02AOGXA7XQSF64NtRUgXzsjtkh9e76Bsarj$",
                                      "operator": "eq",
                                      "right_operand": "Pass"
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02JXY1Z20BKPO6CKmOEVD2Rnn0yWjuGdDty.output.variable_workflow_02CHZ0L5T65J16l6YsDSeW2hCHxu7cuNo3W$",
                                      "operator": "eq",
                                      "right_operand": "Pass"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02JXY2S4QYWIZ6tfLW5smeUKtOy9mHm3WEE.output.variable_workflow_02CI00LAKCWS118urvq5G6kwVDQSSqPVAI8$",
                                    "operator": "eq",
                                    "right_operand": "Pass"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02JXYOQBDX9IG6txGVskX60mShRyL4cmK4H.output.error.code$",
                                  "operator": "eq",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02JXYP7UYH37Y3QRaVtClW49v8VRQIN1t1S.output.jsonpath_queries.Playbook_Rule_Status$",
                                "operator": "eq",
                                "right_operand": "started-polling"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02JXYO1UROX087Cy7mbXoaMZGQTlfSOFtxq.output.error.code$",
                              "operator": "eq",
                              "right_operand": "200"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02JXYNHFUMEH52hRPvc3sCeymciBw1tQgMI.output.error.code$",
                            "operator": "eq",
                            "right_operand": "200"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02JXYQFX809T12J70mzpNUcGoGzpOdgJVko.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                          "operator": "eq",
                          "right_operand": "true"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02JXYVASNV7FM05GxkmA5uiph9BvuvCUJ9h",
                        "name": "Set Variables",
                        "title": "PassCase",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "PassCase",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXG08KJ1O80oiGZKvVgqbJgsqwJy8GI8$",
                              "variable_value_new": "Pass"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_02JXYVRS5MQF86IGiqxROqSnHiCMRPAgBdo",
                    "name": "Condition Branch",
                    "title": "FailCase",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": "$activity.definition_activity_02JXY0BVOXY416cuRsh1NFmFWjLDJOQuedR.output.variable_workflow_02AOGXA7XQSF64NtRUgXzsjtkh9e76Bsarj$",
                                      "operator": "ne",
                                      "right_operand": "Pass"
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02JXY1Z20BKPO6CKmOEVD2Rnn0yWjuGdDty.output.variable_workflow_02CHZ0L5T65J16l6YsDSeW2hCHxu7cuNo3W$",
                                      "operator": "ne",
                                      "right_operand": "Pass"
                                    }
                                  },
                                  "operator": "or",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02JXY2S4QYWIZ6tfLW5smeUKtOy9mHm3WEE.output.variable_workflow_02CI00LAKCWS118urvq5G6kwVDQSSqPVAI8$",
                                    "operator": "ne",
                                    "right_operand": "Pass"
                                  }
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02JXYOQBDX9IG6txGVskX60mShRyL4cmK4H.output.error.code$",
                                  "operator": "ne",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02JXYP7UYH37Y3QRaVtClW49v8VRQIN1t1S.output.jsonpath_queries.Playbook_Rule_Status$",
                                "operator": "ne",
                                "right_operand": "started-polling"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02JXYO1UROX087Cy7mbXoaMZGQTlfSOFtxq.output.error.code$",
                              "operator": "ne",
                              "right_operand": "200"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02JXYNHFUMEH52hRPvc3sCeymciBw1tQgMI.output.error.code$",
                            "operator": "ne",
                            "right_operand": "200"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02JXYQFX809T12J70mzpNUcGoGzpOdgJVko.output.variable_workflow_026R3PNDY9HWM1EAkKFEmXGbAori52GEZrE$",
                          "operator": "ne",
                          "right_operand": "true"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "FailCase",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02JXYVRS5NP8V0gJa8V5ezk4MG7DzI2GpZF",
                        "name": "Set Variables",
                        "title": "FailCase",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "FailCase",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXG08KJ1O80oiGZKvVgqbJgsqwJy8GI8$",
                              "variable_value_new": "Fail"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02JXYY8O0KNY43lZyKlq4FQLKfNUbvfBB7P",
        "name": "Condition Block",
        "title": "Verify XDR-12041 Overall TestStatus",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "conditions": [],
          "continue_on_failure": false,
          "display_name": "Verify XDR-12041 Overall TestStatus",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02JXYY8O8PME45TnreXR6FCGLxTYKDTpKrG",
            "name": "Condition Branch",
            "title": "PassCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXFREM05ON7kRFovqWaq5V5HNtURLoOO$",
                  "operator": "eq",
                  "right_operand": "Pass"
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXG08KJ1O80oiGZKvVgqbJgsqwJy8GI8$",
                  "operator": "eq",
                  "right_operand": "Pass"
                }
              },
              "continue_on_failure": false,
              "display_name": "PassCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02JXYYUY52IXP5ZqdaFw14NmgH8n7yPXEZz",
                "name": "Set Variables",
                "title": "PassCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "PassCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXYY4SFE6HX6Jwpc4W15PN5IqZlDWtEhs$",
                      "variable_value_new": "Pass"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02JXYZ56URT7U0Q9LfpVZgNMgyx6V9OYnr8",
            "name": "Condition Branch",
            "title": "FailCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXFREM05ON7kRFovqWaq5V5HNtURLoOO$",
                  "operator": "ne",
                  "right_operand": "Pass"
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXXG08KJ1O80oiGZKvVgqbJgsqwJy8GI8$",
                  "operator": "ne",
                  "right_operand": "Pass"
                }
              },
              "continue_on_failure": false,
              "display_name": "FailCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02JXYZ56USRTA1ef1RFFQ5owNNV0RsK2Yut",
                "name": "Set Variables",
                "title": "FailCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "FailCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02JXSY4T7OVMG09BeMJsce7n9C7CHmmkJXz.output.variable_workflow_02JXYY4SFE6HX6Jwpc4W15PN5IqZlDWtEhs$",
                      "variable_value_new": "Fail"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02JXYZNXFPKCX5XGZET136JOlfuhY3TuSU6",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ],
    "template_type": "template_workflow.incident_response"
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh",
        "name": "XDR -- UnLock LockedWorkflow Reusable",
        "title": "XDR -- UnLock LockedWorkflow Reusable",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "WF_UnLocked_Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT166HD1lJuHe4AGwB8e0OKoMJYGd",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Provide WF_ID to UnLock",
              "type": "datatype.string",
              "description": "Provide WF_ID to Lock",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Bearer ",
              "scope": "input",
              "name": "Provide the Token",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "UnLock Test Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "XDR -- UnLock LockedWorkflow Reusable",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC",
            "name": "HTTP Request",
            "title": "UnLock the WF",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck$"
                }
              ],
              "display_name": "UnLock the WF",
              "method": "PUT",
              "relative_url": "/api/v1/workflows/$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69$/unlock",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKWOJ0ML0DY6Rk2gDVnApSyhBiIEXC",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt",
            "name": "JSONPath Query",
            "title": "Fetch UnLocked Status",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch UnLocked Status",
              "input_json": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.locked",
                  "jsonpath_query_name": "locked_status_after_Unlocking",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA",
            "name": "HTTP Request",
            "title": "UnLock the WF (again-- Expected to fail)",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT15OAS2QBrFJR41WkaFXVSoSTRck$"
                }
              ],
              "display_name": "UnLock the WF (again-- Expected to fail)",
              "method": "PUT",
              "relative_url": "/api/v1/workflows/$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.input.variable_workflow_02CZUIKT16K8H5Wp7je5UCel7MZ8PINlo69$/unlock",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CZUIKYX7PSM6PX1OfNGMGxCTddihZhhNQ",
            "name": "Condition Block",
            "title": "Verify UnLock Status",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify UnLock Status",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02CZUIKZRXCH9759d6Fol388ieNGGEl8GaX",
                "name": "Condition Branch",
                "title": "WF is UnLocked",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$",
                        "operator": "eq",
                        "right_operand": "false"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "WF is UnLocked",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CZUIL1S1MT44IzcG3HjvEAyR6ZgRDjLFZ",
                    "name": "Set Variables",
                    "title": "Store Locked and TestStatus",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Store Locked and TestStatus",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.output.variable_workflow_02CZUIKT16DDF0RnhzTGfLTdOCDHhbib8P5$",
                          "variable_value_new": "Pass"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh.output.variable_workflow_02CZUIKT166HD1lJuHe4AGwB8e0OKoMJYGd$",
                          "variable_value_new": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02CZUIL303S1W4UnmWHY77WfjiaLLddoLf9",
                "name": "Condition Branch",
                "title": "WF is Not UnLocked",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKVYIT896xOUJPPZOaID36FdFEZQfC.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CZUIKXA7K8S5UMQplxA9hWP0B4zBwSvwt.output.jsonpath_queries.locked_status_after_Unlocking$",
                        "operator": "ne",
                        "right_operand": "false"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CZUIKY8VVJK2tWkFjARQoCmsN1z2EwsxA.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "WF is Not UnLocked",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CZUIL4ARKM42dn3P6XUuFJvzeTxDXsqWV",
                    "name": "Completed",
                    "title": "Mark As Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Mark As Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U",
        "name": "XDR -- Create a Playbook Resuable WF",
        "title": "XDR -- Create a Playbook Resuable WF",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Playbook_ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHYY4GY92VF1xlgdyxXQ2kuqTnHhnMFyy",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Recovery TaskID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI0Q6QOAOSP0TnfwX4cV9s3AMmFn5nt2M",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Containment Task ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI0PNBUIJ390iRttPbuBFFLx7KNGcCvRq",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Bearer ",
              "scope": "input",
              "name": "Provide Token",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "Playbook Creation Test Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHZ0L5T65J16l6YsDSeW2hCHxu7cuNo3W",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "null",
              "scope": "input",
              "name": "worklfow ID",
              "type": "datatype.string",
              "description": "pass null if no workflow or else pass Valid wf id",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Eradiation Task ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI0Q1J4P72Z4b8u4FpyU6r41RDz9pdwJ1",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Identification Task ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI0PDCJFLNK40rtcDYBsmutiDHTFQgvKX",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Authorization",
              "scope": "input",
              "name": "Authorization",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "XDR -- Create a Playbook Resuable WF",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m",
            "name": "Execute Python Script",
            "title": "Generate Random String",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Generate Random String",
              "script": "import random\nimport string\n\ndef get_random_string(length):\n    # choose from all lowercase letter\n    letters = string.ascii_lowercase\n    result_str = ''.join(random.choice(letters) for i in range(length))\n    print(result_str)\n\nget_random_string(8)",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYDPWSTZ821j3S03TCyaJsiqO513Caew",
            "name": "HTTP Request",
            "title": "Create Default Phases",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                  "value": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$"
                }
              ],
              "display_name": "Create Default Phases",
              "method": "POST",
              "relative_url": "/v1/phase/create-defaults",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYFNSBTI9H23Lsgig1qf0UFGVHcB4yXb",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc",
            "name": "JSONPath Query",
            "title": "Fetch Phases for Playbook",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Phases for Playbook",
              "input_json": "$activity.definition_activity_02CHYDPWSTZ821j3S03TCyaJsiqO513Caew.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$[?(@.stage==\"Identification\")].id",
                  "jsonpath_query_name": "Identification_Phase",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$[?(@.stage==\"Containment\")].id",
                  "jsonpath_query_name": "Containment_Phase",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$[?(@.stage==\"Eradication\")].id",
                  "jsonpath_query_name": "Eradication_Phase",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$[?(@.stage==\"Recovery\")].id",
                  "jsonpath_query_name": "Recovery_Phase",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYJGKTG94P79HHOHzZyX47nl1ec04bXx",
            "name": "XDR - Creating Task for Playbook - Task1",
            "title": "XDR - Creating Task for Playbook - Task1",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR - Creating Task for Playbook - Task1",
              "input": {
                "variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                "variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$",
                "variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO": "Placeholder task description.",
                "variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1": "Placeholder Task Title-Identification-$activity.definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m.output.response_body$",
                "variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH",
              "workflow_name": "XDR - Creating Task for Playbook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYJLZT3CSB5ex6DqwUzbwNz5wYwXwwKm",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYRWUJGDED7eYg8cKoKF56GiFkegHeaD",
            "name": "XDR - Creating Task for Playbook - Task2",
            "title": "XDR - Creating Task for Playbook - Task2",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR - Creating Task for Playbook - Task2",
              "input": {
                "variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                "variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$",
                "variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO": "Placeholder task description.",
                "variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1": "Placeholder Task Title-Containment-$activity.definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m.output.response_body$",
                "variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH",
              "workflow_name": "XDR - Creating Task for Playbook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYS3EAFD381pKUz7lDn7IUCU4oi7ahyN",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYSAFB2G3N5n8JEQcBAeTLYYFDZNdzvL",
            "name": "XDR - Creating Task for Playbook - Task3",
            "title": "XDR - Creating Task for Playbook - Task3",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR - Creating Task for Playbook - Task3",
              "input": {
                "variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                "variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$",
                "variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO": "Placeholder task description.",
                "variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1": "Placeholder Task Title-Eradication-$activity.definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m.output.response_body$",
                "variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH",
              "workflow_name": "XDR - Creating Task for Playbook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYS4CJWL3472WkCpUdt5jN7R3ha2vHRL",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYSJI028BL6HW3yPtd9p3P1tWiYHLxL0",
            "name": "XDR - Creating Task for Playbook - Task4",
            "title": "XDR - Creating Task for Playbook - Task4",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "XDR - Creating Task for Playbook - Task4",
              "input": {
                "variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                "variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$",
                "variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO": "Placeholder task description.",
                "variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1": "Placeholder Task Title-Recovery-$activity.definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m.output.response_body$",
                "variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CI1OOCB490E6hV6iJRTVR2YyjxAMyEMAg$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "target_type": "web-service.endpoint",
                "use_workflow_target": true
              },
              "workflow_id": "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH",
              "workflow_name": "XDR - Creating Task for Playbook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYSRLTM9C314kUPWWkFva8NQXwx3F6PS",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYJ30TA8ZC4BbQ08UG7OgvodtLIBZWeQ",
            "name": "HTTP Request",
            "title": "Create Playbook",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"title\": \"Playbook-title-$activity.definition_activity_02CHZ3QRXO4W94dxXq4nxFN9vu2Cz0pbm9m.output.response_body$\",\n  \"short_description\": \"Playbook-Short-Desc\",\n  \"description\": \"Playbook-Description  \",\n  \"phases\": [\n    {\n      \"phase_id\": \"$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.jsonpath_queries.Identification_Phase$\",\n      \"tasks\": [\n        \"$activity.definition_activity_02CHYJGKTG94P79HHOHzZyX47nl1ec04bXx.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$\"\n      ]\n    },\n    {\n      \"phase_id\": \"$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.jsonpath_queries.Containment_Phase$\",\n      \"tasks\": [\n        \"$activity.definition_activity_02CHYRWUJGDED7eYg8cKoKF56GiFkegHeaD.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$\"\n      ]\n    },\n    {\n      \"phase_id\": \"$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.jsonpath_queries.Eradication_Phase$\",\n      \"tasks\": [\n        \"$activity.definition_activity_02CHYSAFB2G3N5n8JEQcBAeTLYYFDZNdzvL.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$\"\n      ]\n    },\n    {\n      \"phase_id\": \"$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.jsonpath_queries.Recovery_Phase$\",\n      \"tasks\": [\n        \"$activity.definition_activity_02CHYSJI028BL6HW3yPtd9p3P1tWiYHLxL0.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$\"\n      ]\n    }\n  ]\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF14ICJKP5Ts02Ys2LtHWcvilRfP2dl$",
                  "value": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.input.variable_workflow_02CHYF8TSBG1M4ZYIRvOTW7jmT0LyiMJar8$"
                }
              ],
              "display_name": "Create Playbook",
              "method": "POST",
              "relative_url": "/v1/playbook",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYWR10AYPA6HLS699iMcexSNrCotO5YF",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYWWTJWQ434D5iAfiGIZ77eSJ9BV5Gbt",
            "name": "JSONPath Query",
            "title": "Fetch Playbook ID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Playbook ID",
              "input_json": "$activity.definition_activity_02CHYJ30TA8ZC4BbQ08UG7OgvodtLIBZWeQ.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.id",
                  "jsonpath_query_name": "Playbook_ID",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHYYCHXT2RU41P5YUEg1KGXrMAEY5G8ZU",
            "name": "Condition Block",
            "title": "Verify Playbook Creation",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify Playbook Creation",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02CHYYCI3YSR84hKGqlQqsiUaH774CQ5Mfn",
                "name": "Condition Branch",
                "title": "Playbook Created",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_02CHYDPWSTZ821j3S03TCyaJsiqO513Caew.output.error.code$",
                                  "operator": "eq",
                                  "right_operand": "200"
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.error.code$",
                                  "operator": "eq",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02CHYJGKTG94P79HHOHzZyX47nl1ec04bXx.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                                "operator": "eq",
                                "right_operand": "Pass"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02CHYRWUJGDED7eYg8cKoKF56GiFkegHeaD.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                              "operator": "eq",
                              "right_operand": "Pass"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02CHYSAFB2G3N5n8JEQcBAeTLYYFDZNdzvL.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                            "operator": "eq",
                            "right_operand": "Pass"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02CHYSJI028BL6HW3yPtd9p3P1tWiYHLxL0.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                          "operator": "eq",
                          "right_operand": "Pass"
                        }
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CHYJ30TA8ZC4BbQ08UG7OgvodtLIBZWeQ.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CHYWWTJWQ434D5iAfiGIZ77eSJ9BV5Gbt.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Playbook Created",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CHZ0PUVP2XL6znyckQC1eYJd9Y1JYtrPl",
                    "name": "Set Variables",
                    "title": "Store Playbook ID and Set as Pased",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Store Playbook ID and Set as Pased",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CHYY4GY92VF1xlgdyxXQ2kuqTnHhnMFyy$",
                          "variable_value_new": "$activity.definition_activity_02CHYWWTJWQ434D5iAfiGIZ77eSJ9BV5Gbt.output.jsonpath_queries.Playbook_ID$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CHZ0L5T65J16l6YsDSeW2hCHxu7cuNo3W$",
                          "variable_value_new": "Pass"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CI0PDCJFLNK40rtcDYBsmutiDHTFQgvKX$",
                          "variable_value_new": "$activity.definition_activity_02CHYJGKTG94P79HHOHzZyX47nl1ec04bXx.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CI0PNBUIJ390iRttPbuBFFLx7KNGcCvRq$",
                          "variable_value_new": "$activity.definition_activity_02CHYRWUJGDED7eYg8cKoKF56GiFkegHeaD.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CI0Q1J4P72Z4b8u4FpyU6r41RDz9pdwJ1$",
                          "variable_value_new": "$activity.definition_activity_02CHYSAFB2G3N5n8JEQcBAeTLYYFDZNdzvL.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U.output.variable_workflow_02CI0Q6QOAOSP0TnfwX4cV9s3AMmFn5nt2M$",
                          "variable_value_new": "$activity.definition_activity_02CHYSJI028BL6HW3yPtd9p3P1tWiYHLxL0.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02CHZ2577LDWD1fg5mAXvlnPBbyeSsTQJmz",
                "name": "Condition Branch",
                "title": "Playbook Not Created",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_02CHYDPWSTZ821j3S03TCyaJsiqO513Caew.output.error.code$",
                                  "operator": "ne",
                                  "right_operand": "200"
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02CHYFZOWVK4W7QT3jaw6RtdMU3eP6WKYyc.output.error.code$",
                                  "operator": "ne",
                                  "right_operand": "200"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02CHYJGKTG94P79HHOHzZyX47nl1ec04bXx.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                                "operator": "ne",
                                "right_operand": "Pass"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02CHYRWUJGDED7eYg8cKoKF56GiFkegHeaD.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                              "operator": "ne",
                              "right_operand": "Pass"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02CHYSAFB2G3N5n8JEQcBAeTLYYFDZNdzvL.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                            "operator": "ne",
                            "right_operand": "Pass"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02CHYSJI028BL6HW3yPtd9p3P1tWiYHLxL0.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                          "operator": "ne",
                          "right_operand": "Pass"
                        }
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CHYJ30TA8ZC4BbQ08UG7OgvodtLIBZWeQ.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CHYWWTJWQ434D5iAfiGIZ77eSJ9BV5Gbt.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Playbook Not Created",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CHZ39I4X4XW0q5S9Hu8c6q447WsgnHjPy",
                    "name": "Completed",
                    "title": "Set as Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Set as Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      },
      "subworkflows": [
        {
          "workflow": {
            "unique_name": "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH",
            "name": "XDR - Creating Task for Playbook",
            "title": "XDR - Creating Task for Playbook",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Task_ID",
                  "type": "datatype.string",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "Workflow_ID",
                  "type": "datatype.string",
                  "description": "pass null if no workflow or else pass Valid Workflow id ",
                  "is_required": true,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Task_Title_OP",
                  "type": "datatype.string",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFPQQO3ZBH63X1dTkoJ72JSce1XFBLpbZ",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "Authorization",
                  "scope": "input",
                  "name": "Authorization",
                  "type": "datatype.string",
                  "is_required": true,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "Placeholder Task Title",
                  "scope": "input",
                  "name": "Task_Title",
                  "type": "datatype.string",
                  "is_required": true,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "Fail",
                  "scope": "output",
                  "name": "Task Creation",
                  "type": "datatype.string",
                  "is_required": false,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "Bearer ",
                  "scope": "input",
                  "name": "Provide Token",
                  "type": "datatype.string",
                  "is_required": true,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "Placeholder task description.",
                  "scope": "input",
                  "name": "Task_Description",
                  "type": "datatype.string",
                  "is_required": true,
                  "display_on_wizard": false,
                  "is_invisible": false,
                  "variable_string_format": ""
                },
                "unique_name": "variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "display_name": "XDR - Creating Task for Playbook",
              "runtime_user": {
                "target_default": true
              },
              "target": {
                "target_type": "web-service.endpoint",
                "specify_on_workflow_start": true
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_02CFN1XRNGPRQ48WRuPdACumYCWL3cpe7d9",
                "name": "HTTP Request",
                "title": "Creating Tasks",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"description\": \"$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO$\",\n  \"short_description\": \"$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN3IGON1KY42YOU5MTp38ikZIjm02rhO$\",\n  \"title\": \"$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN3Y1DZYTI4L2gForlOGNd41cAMbyLr1$\",\n  \"workflow_external_id\": \"$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN4TCZXZBN1rt2HcXpvKA2sS6eI2qnHN$\",\n  \"efficacy\": \"unknown\"\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN1MP10HRH6IrcclzfRISlbFXwj6XeL8$",
                      "value": "$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.input.variable_workflow_02CFN1V4449HT5oi0hQB4WwRq3zxw1MZzAF$"
                    }
                  ],
                  "display_name": "Creating Tasks",
                  "method": "POST",
                  "relative_url": "v1/task",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02CFN6DNGYQJH60eb6PRh8EmicZDv51ZVlw",
                "name": "JSONPath Query",
                "title": "Fetch Task ID and title",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Fetch Task ID and title",
                  "input_json": "$activity.definition_activity_02CFN1XRNGPRQ48WRuPdACumYCWL3cpe7d9.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.id",
                      "jsonpath_query_name": "Task_ID",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    },
                    {
                      "jsonpath_query": "$.title",
                      "jsonpath_query_name": "Task_Title",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02CFN6SDD9VHO6dBsEYfcNXm3Aj5Vyg8yqx",
                "name": "Condition Block",
                "title": "Verify Task Creation",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Verify Task Creation",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_02CFN6SDIPJFL6g8vdkdOBvBl4j4g8vvntc",
                    "name": "Condition Branch",
                    "title": "Created Task",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_02CFN1XRNGPRQ48WRuPdACumYCWL3cpe7d9.output.error.code$",
                          "operator": "eq",
                          "right_operand": "200"
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02CFN6DNGYQJH60eb6PRh8EmicZDv51ZVlw.output.error.code$",
                          "operator": "eq",
                          "right_operand": "200"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Created Task",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02CFN7VVIY2Z060EPWvwhk2pJCnFoCBvyeP",
                        "name": "Set Variables",
                        "title": "Task Created and Store the ID",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Task Created and Store the ID",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.output.variable_workflow_02CFN69QVQA4L7bymvWnFoT1f1R3nxLnjMX$",
                              "variable_value_new": "$activity.definition_activity_02CFN6DNGYQJH60eb6PRh8EmicZDv51ZVlw.output.jsonpath_queries.Task_ID$"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.output.variable_workflow_02CFNQ4QD93HE7SFPb9kg6TzMCVp4VAPkHA$",
                              "variable_value_new": "Pass"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH.output.variable_workflow_02CFPQQO3ZBH63X1dTkoJ72JSce1XFBLpbZ$",
                              "variable_value_new": "$activity.definition_activity_02CFN6DNGYQJH60eb6PRh8EmicZDv51ZVlw.output.jsonpath_queries.Task_Title$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_02CFN8D35RGFU4lgSnGkOpUnswTnFVNEDNz",
                    "name": "Condition Branch",
                    "title": "Task Not Created",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_02CFN1XRNGPRQ48WRuPdACumYCWL3cpe7d9.output.error.code$",
                          "operator": "ne",
                          "right_operand": "200"
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02CFN6DNGYQJH60eb6PRh8EmicZDv51ZVlw.output.error.code$",
                          "operator": "ne",
                          "right_operand": "200"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Task Not Created",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_02CFN8VP8E6R637p0cGzRUGaIvRYw3yQpwz",
                        "name": "Completed",
                        "title": "Completed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Completed",
                          "result_message": "Failed",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ],
            "categories": [
              "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
            ]
          }
        }
      ],
      "dependent_workflows": [
        "definition_workflow_02CFN17WUN0A03qDL0Q3Cc5lKjFgp9yT7LH"
      ]
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb",
        "name": "XDR - Assignment Rule Creation",
        "title": "XDR - Assignment Rule Creation",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Assignment Rule ID",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI036PKZ9DV3rbNAs3xb1cihTJ5kqgxlk",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Plabook_ID",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHZYW0O09R90uaINBHRHbWmY00eSJeSDF",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": {\n          \"left_operand\": {\n            \"left_operand\": {\n              \"left_operand\": {\n                \"left_operand\": {\n                  \"left_operand\": {\n                    \"left_operand\": {\n                      \"left_operand\": {\n                        \"left_operand\": {\n                          \"left_operand\": {\n                            \"left_operand\": {\n                              \"left_operand\": {\n                                \"left_operand\": {\n                                  \"left_operand\": {\n                                    \"left_operand\": {\n                                      \"left_operand\": {\n                                        \"left_operand\": \"$output.incident.description$\",\n                                        \"operator\": \"mw\",\n                                        \"right_operand\": \"*incident*\"\n                                      },\n                                      \"right_operand\": {\n                                        \"left_operand\": \"$output.incident.status$\",\n                                        \"operator\": \"eq\",\n                                        \"right_operand\": \"New\"\n                                      },\n                                      \"operator\": \"and\"\n                                    },\n                                    \"right_operand\": {\n                                      \"left_operand\": \"$output.incident.source$\",\n                                      \"operator\": \"eq\",\n                                      \"right_operand\": \"Umbrella\"\n                                    },\n                                    \"operator\": \"and\"\n                                  },\n                                  \"right_operand\": {\n                                    \"left_operand\": \"$output.incident.tlp$\",\n                                    \"operator\": \"eq\",\n                                    \"right_operand\": \"amber\"\n                                  },\n                                  \"operator\": \"and\"\n                                },\n                                \"right_operand\": {\n                                  \"left_operand\": \"$output.incident.id$\",\n                                  \"operator\": \"mw\",\n                                  \"right_operand\": \"https://private.intel*iroh.site:443/ctia/incident/incident*\"\n                                },\n                                \"operator\": \"and\"\n                              },\n                              \"right_operand\": {\n                                \"left_operand\": \"$output.source.totalCount$\",\n                                \"operator\": \"gte\",\n                                \"right_operand\": 0\n                              },\n                              \"operator\": \"and\"\n                            },\n                            \"right_operand\": {\n                              \"left_operand\": \"$output.targets.totalCount$\",\n                              \"operator\": \"gte\",\n                              \"right_operand\": 0\n                            },\n                            \"operator\": \"and\"\n                          },\n                          \"right_operand\": {\n                            \"left_operand\": \"$output.incident.scores.asset$\",\n                            \"operator\": \"gte\",\n                            \"right_operand\": 0\n                          },\n                          \"operator\": \"and\"\n                        },\n                        \"right_operand\": {\n                          \"left_operand\": \"$output.incident.scores.global$\",\n                          \"operator\": \"gte\",\n                          \"right_operand\": 0\n                        },\n                        \"operator\": \"and\"\n                      },\n                      \"right_operand\": {\n                        \"left_operand\": \"$output.incident.scores.ttp$\",\n                        \"operator\": \"gte\",\n                        \"right_operand\": 0\n                      },\n                      \"operator\": \"and\"\n                    },\n                    \"right_operand\": {\n                      \"left_operand\": \"$output.eventsCount$\",\n                      \"operator\": \"gte\",\n                      \"right_operand\": 0\n                    },\n                    \"operator\": \"and\"\n                  },\n                  \"right_operand\": {\n                    \"left_operand\": \"$output.incident.confidence$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": \"High\"\n                  },\n                  \"operator\": \"and\"\n                },\n                \"right_operand\": {\n                  \"left_operand\": \"$output.firstEventDate$\",\n                  \"operator\": \"ne\",\n                  \"right_operand\": \"2023-01-01\"\n                },\n                \"operator\": \"or\"\n              },\n              \"right_operand\": {\n                \"left_operand\": \"$output.indicators.totalCount$\",\n                \"operator\": \"gte\",\n                \"right_operand\": 0\n              },\n              \"operator\": \"or\"\n            },\n            \"right_operand\": {\n              \"left_operand\": \"$output.mitreData.totalCount$\",\n              \"operator\": \"gte\",\n              \"right_operand\": 0\n            },\n            \"operator\": \"or\"\n          },\n          \"right_operand\": {\n            \"left_operand\": \"$output.observables.totalCount$\",\n            \"operator\": \"gte\",\n            \"right_operand\": 0\n          },\n          \"operator\": \"or\"\n        },\n        \"right_operand\": {\n          \"left_operand\": \"$output.observables.data[*].type$\",\n          \"operator\": \"eq\",\n          \"right_operand\": \"domain\"\n        },\n        \"operator\": \"or\"\n      },\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.title$\",\n        \"right_operand\": \"*Automation Rule and Playbook Testing-25189*\",\n        \"operator\": \"mw\"\n      },\n      \"operator\": \"and\"\n    },",
              "scope": "input",
              "name": "Conditions_For_Assignment_Rule",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHZW8683OFY40aC7O1gvgSgTCYuTVQubp",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Authorization",
              "scope": "input",
              "name": "Authorization",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHZZ30F8WSW0Klz4asuNPA4Hg7NqSphtO",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Bearer ",
              "scope": "input",
              "name": "Provide Token to Create a Rule",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CHZZD46895S5pCr050k95x91ktdU9LCYG",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "Creation of Assignment Rule",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02CI00LAKCWS118urvq5G6kwVDQSSqPVAI8",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Rule_name",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02EVTZN0INLKY7NWn7eQ96rlugG02FmdqMh",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "XDR - Assignment Rule Creation",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "target_id": "$module_target;Cisco XDR;securex:ao:sxo;automation-apis$",
            "execute_on_workflow_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02CHZU3VR2D1M3lrTkCqKTRfGkCr7O13OUF",
            "name": "Execute Python Script",
            "title": "Generate Random String",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Generate Random String",
              "script": "import random\nimport string\n\ndef get_random_string(length):\n    # choose from all lowercase letter\n    letters = string.ascii_lowercase\n    result_str = ''.join(random.choice(letters) for i in range(length))\n    print(result_str)\n\nget_random_string(8)",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CHZT7XM2L8L6xTRN9lYUzbITerBKjqZ3E",
            "name": "HTTP Request",
            "title": "Create Assignment Rule",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"title\": \"Rule-Title-$activity.definition_activity_02CHZU3VR2D1M3lrTkCqKTRfGkCr7O13OUF.output.response_body$\",\n  \"description\": \"Rule-Description--$activity.definition_activity_02CHZU3VR2D1M3lrTkCqKTRfGkCr7O13OUF.output.response_body$\",\n  \"type\": \"Playbook Assignment Rule\",\n  $workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZW8683OFY40aC7O1gvgSgTCYuTVQubp$\n  \"playbook_id\": \"$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZYW0O09R90uaINBHRHbWmY00eSJeSDF$\",\n  \"type\": \"playbook_assignment.rule_event\",\n  \"properties\": {\n    \"group_by\": true,\n    \"disabled\": false,\n    \"rule_type\": \"rule_event\",\n    \"title\": \"Rule-Title-$activity.definition_activity_02CHZU3VR2D1M3lrTkCqKTRfGkCr7O13OUF.output.response_body$\",\n    \"description\": \"Rule-Description-$activity.definition_activity_02CHZU3VR2D1M3lrTkCqKTRfGkCr7O13OUF.output.response_body$\",\n    \"type\": \"Playbook Assignment Rule\",\n    $workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZW8683OFY40aC7O1gvgSgTCYuTVQubp$\n    \"playbook_id\": \"$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZYW0O09R90uaINBHRHbWmY00eSJeSDF$\"\n  }\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZZ30F8WSW0Klz4asuNPA4Hg7NqSphtO$",
                  "value": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZZD46895S5pCr050k95x91ktdU9LCYG$"
                }
              ],
              "display_name": "Create Assignment Rule",
              "method": "POST",
              "relative_url": "/api/v1/rules",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CIOT8TEQCEL176B2rkduudzkl3vmvOC9e",
            "name": "Sleep",
            "title": "Sleep for 10s",
            "type": "core.sleep",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Sleep for 10s",
              "skip_execution": false,
              "sleep_interval": 10
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN",
            "name": "JSONPath Query",
            "title": "Fetch Rule ID and Name",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch Rule ID and Name",
              "input_json": "$activity.definition_activity_02CHZT7XM2L8L6xTRN9lYUzbITerBKjqZ3E.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.id",
                  "jsonpath_query_name": "Rule_ID",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                },
                {
                  "jsonpath_query": "$.name",
                  "jsonpath_query_name": "Rule_name",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CIOT45JYRJH5qXyJi9JEuexXQdlJfBmQP",
            "name": "HTTP Request",
            "title": "Set Assignment Rule Priority to 1",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"previous_rule\": {},\n  \"rule\": {\n    \"id\": \"$activity.definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN.output.jsonpath_queries.Rule_ID$\"\n  },\n  \"type\": \"playbook_assignment.rule_event\"\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZZ30F8WSW0Klz4asuNPA4Hg7NqSphtO$",
                  "value": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.input.variable_workflow_02CHZZD46895S5pCr050k95x91ktdU9LCYG$"
                }
              ],
              "display_name": "Set Assignment Rule Priority to 1",
              "method": "PATCH",
              "relative_url": "/api/v1/rules/priority",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02CI01WCMMZLP6q1RxUNMcQCvdIFy4X2hCr",
            "name": "Condition Block",
            "title": "Verify Creation of Assignment Rule",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify Creation of Assignment Rule",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02CI01WCSYI9F3YdWX6fiCGcvTE6KOwtyoQ",
                "name": "Condition Branch",
                "title": "Rule Created",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CHZT7XM2L8L6xTRN9lYUzbITerBKjqZ3E.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CIOT45JYRJH5qXyJi9JEuexXQdlJfBmQP.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Rule Created",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CI02PL3NEO74PvoQcyD7vvAHJ64nqsSRG",
                    "name": "Set Variables",
                    "title": "Store Rule ID ",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Store Rule ID ",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.output.variable_workflow_02CI036PKZ9DV3rbNAs3xb1cihTJ5kqgxlk$",
                          "variable_value_new": "$activity.definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN.output.jsonpath_queries.Rule_ID$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.output.variable_workflow_02CI00LAKCWS118urvq5G6kwVDQSSqPVAI8$",
                          "variable_value_new": "Pass"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb.output.variable_workflow_02EVTZN0INLKY7NWn7eQ96rlugG02FmdqMh$",
                          "variable_value_new": "$activity.definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN.output.jsonpath_queries.Rule_name$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02CI01WD1R2HX48xd3ZP2uLZtbOrNpLemCA",
                "name": "Condition Branch",
                "title": "Rule not Created",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02CHZT7XM2L8L6xTRN9lYUzbITerBKjqZ3E.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02CI03SKOLU352WdDUEZFL0JgC124dXZgAN.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02CIOT45JYRJH5qXyJi9JEuexXQdlJfBmQP.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Rule not Created",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02CI04LG5IFQW2BSUZMqa5Lq5BmTcJnGJki",
                    "name": "Completed",
                    "title": "Mark as Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Mark as Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_026R3PNDMKDIO0lhGr43dUx4CkVU7BTcx2i",
    "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
    "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k"
  ],
  "dependent_workflows": [
    "definition_workflow_026R3ITF54S7O4wvqSwgTIkJRUX5qYemcV6",
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_02CZUIKSHTSJP14v9sKhPiI05zAP6K4Iboh",
    "definition_workflow_026R3PNDMKDIO0lhGr43dUx4CkVU7BTcx2i",
    "definition_workflow_027GQAYE0W6X67juPzyGd7sktWy7AjA9CZT",
    "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
    "definition_workflow_02CHYD73QN6486UYsL8h2wsUqXyBqM5Oe3U",
    "definition_workflow_02CHZSTLCFSZN3bYaQOfP2LjTbuZps6BYsb"
  ],
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:sxo",
      "proxy_endpoint_metadata_id": "automation-apis"
    },
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:playbook",
      "proxy_endpoint_metadata_id": "playbook-apis"
    }
  ]
}