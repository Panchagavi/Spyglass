{
  "workflow": {
    "unique_name": "definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM",
    "name": "XDR-MVP Automation",
    "title": "XDR-MVP Automation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "client-bd4bb237-0127-49f2-9849-69f60488bb50",
          "scope": "local",
          "name": "Content Admin Clent ID",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85AI5AINTM0YGNvLJQghqXQTcETgO4It",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "TAC Token",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "VPw_V7mKkayFeQkpFbUyVjpxzZvAZCxwk-20jXiDubn78LgJ8qA0eQ",
          "scope": "local",
          "name": "TAC User Client Secret",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85BA8URZGN3G37D9uEgiNnpiH3MaW2go",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "esqhD5Q68aKMUjt9RzCMYdG0edDPphyAim3C0mzG4SLC4L2A6i_LYQ",
          "scope": "local",
          "name": "Admin User Client Secret",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85BVQRRBO872ifwpNs6HaMOwh7sWc30g",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "client-d10bd0b9-9be8-4d93-abae-4b8d70db6666",
          "scope": "local",
          "name": "TAC User Client ID",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85B2INN6IL4DKBdvBjz2t6ZZautwpBkS",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Fail",
          "scope": "output",
          "name": "MVP Automation TEST Status",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I857O440CKM0dmvi98h6gPFFcK5Ip41zE",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Content Token",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Hn_OXIlXcwDXTdaDN8vt77w6gghvAM7hFrsZdWeTQ3E2UdD_aOeGZw",
          "scope": "local",
          "name": "Content Admin Clent Secret",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85APLGII7N3ZLiByP6YqHA9hWTpuID8t",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Admin Token",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Enter the Token for TAC User (Without Bearer)",
          "type": "datatype.string",
          "description": "This is token needs to entered manually as API client cannot generate token with cisco/tac. \n\nNote -- Admin, Content Admin and TAC User should be in same tenant. ",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": "text"
        },
        "unique_name": "variable_workflow_02IBI4UB6KC5W0xiAg6er1XGxoGFwEdP6UC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "client-17fe6fc8-352f-49a1-be01-5d82fcedf188",
          "scope": "local",
          "name": "Admin User Client ID",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02I85BKCO9EUK5xOhrYJGhVEe277SvxSSCL",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "Generate Tokens for Content Admin , TAC User and Admin User\nCreate a Incident analysis wf from content admin\nImport a Incident analysis wf from content admin\nGET API for above created WF_ID from Admin User and TAC User\nImport a Incident analysis wf from admin and TAC user \nRun Incident Analysis wf from Admin , Content Admin and TAC user\nDelete WF",
      "display_name": "XDR-MVP Automation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "target_id": "definition_target_02CJRFC3P3FC304KnTutXoejdmZDYNUMkJR",
        "execute_on_workflow_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02I82VSFF351B6Uds7w0trL02IKMQpW5yNh",
        "name": "Generate Token For Content Admin",
        "title": "Generate Token For Content Admin",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Generate Token For Content Admin",
          "input": {
            "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85AI5AINTM0YGNvLJQghqXQTcETgO4It$",
            "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85APLGII7N3ZLiByP6YqHA9hWTpuID8t$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "execute_on_this_target": true,
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
          "workflow_name": "SXO- Create Token-Generate Token"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I8307Y0I1HB2MAk0qCqzradACjM8g08x8",
        "name": "Generate Token For Admin",
        "title": "Generate Token For Admin",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Generate Token For Admin",
          "input": {
            "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85BKCO9EUK5xOhrYJGhVEe277SvxSSCL$",
            "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85BVQRRBO872ifwpNs6HaMOwh7sWc30g$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "execute_on_this_target": true,
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
          "workflow_name": "SXO- Create Token-Generate Token"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I830KYS3TXR6zaHE9X1eoX1dGTU57cnaO",
        "name": "Generate Token For TAC",
        "title": "Generate Token For TAC",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Generate Token For TAC",
          "input": {
            "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85B2INN6IL4DKBdvBjz2t6ZZautwpBkS$",
            "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I85BA8URZGN3G37D9uEgiNnpiH3MaW2go$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": true,
          "target": {
            "execute_on_this_target": true,
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
          "workflow_name": "SXO- Create Token-Generate Token"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I8344RE3TSE39EpCi0OFrmDWSAEhehS5X",
        "name": "Set Variables",
        "title": "Store Tokens",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Store Tokens",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$",
              "variable_value_new": "Bearer $activity.definition_activity_02I82VSFF351B6Uds7w0trL02IKMQpW5yNh.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$"
            },
            {
              "variable_to_update": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$",
              "variable_value_new": "Bearer $activity.definition_activity_02I8307Y0I1HB2MAk0qCqzradACjM8g08x8.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$"
            },
            {
              "variable_to_update": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$",
              "variable_value_new": "Bearer $workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.input.variable_workflow_02IBI4UB6KC5W0xiAg6er1XGxoGFwEdP6UC$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I8326M9YB6V1NxP47OdwRefzqLo5S1Zdc",
        "name": "HTTP Request",
        "title": "Create Incident Analysis Workflow from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n    \"type\": \"template_workflow.incident_analysis\",\n    \"base_type\": \"template_workflow\",\n    \"properties\": {\n        \"workflow\": {\n            \"display_name\": \"inc-analysis-wf-$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.output.instance_id$\"\n        }\n    }\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Create Incident Analysis Workflow from Content Admin",
          "method": "POST",
          "relative_url": "/api/v2/workflows",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP",
        "name": "JSONPath Query",
        "title": "Fetch Created WF_ID",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Fetch Created WF_ID",
          "input_json": "$activity.definition_activity_02I8326M9YB6V1NxP47OdwRefzqLo5S1Zdc.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.id",
              "jsonpath_query_name": "Created_WF_ID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGD9A108II0oZfC9c1ggxj3WZ3oC5wgo",
        "name": "Automation - AddIng an Action to the Workflow",
        "title": "Automation - AddIng an Action to the Workflow",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Automation - AddIng an Action to the Workflow",
          "input": {
            "variable_workflow_01TNRGULATIS12xwBtFh5vlzkvz7165Gb4O": "{\n\"previous_action\": {\n    \"id\": \"$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\"\n  },\n  \"action\": {\n    \"type\": \"core.sleep\",\n    \"base_type\": \"activity\",\n    \"name\": \"Sleep\",\n    \"properties\": {\n      \"continue_on_failure\": false,\n      \"skip_execution\": false,\n\"sleep_interval\":1,\n      \"display_name\": \"Sleep\"\n    },\n    \"title\": \"Sleep\"\n  }\n}",
            "variable_workflow_01TNRGULATYCS3YZOCTsAzqIqmW6pJXPjXH": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$",
            "variable_workflow_01TNRGULAU5VJ5MZJeczlceLJVuSNTUGx9Y": "$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
            "variable_workflow_01TNRGULAUKSY47ElJvhRkMLUfZ28jBg6Hb": "Authorization"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
          "workflow_name": "Automation - AddIng an Action to the Workflow"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH1KSGK26H49k12ap5jlbdSfO4vHadrk",
        "name": "HTTP Request",
        "title": "GET by WF ID  from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "GET by WF ID  from Content Admin",
          "method": "GET",
          "relative_url": "api/v1/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$?exclude_variables=false",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAHBOD1JFQI4bjGoeVmMfARHp7I0oqMSy",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAII9QJJNZX5HfPYrkjT2GaQfv6nn8gRA",
        "name": "HTTP Request",
        "title": "GET Schema  from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "GET Schema  from Content Admin",
          "method": "GET",
          "relative_url": "/api/v1/schemas?type=datatype.string\u0026base_type=datatype\u0026schema_type=view",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAIL17F2BHB09CbWGEBlyIvIFrcSRHmSt",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAIIXPKFZPG2bKMnCOKOjdyhxBm3FkLZl",
        "name": "JSONPath Query",
        "title": "Fetch Schema ID for String DataType Variable",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Fetch Schema ID for String DataType Variable",
          "input_json": "$activity.definition_activity_02IAII9QJJNZX5HfPYrkjT2GaQfv6nn8gRA.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.[?(@.type==\"datatype.string\")].schema_id",
              "jsonpath_query_name": "Schema_ID",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz",
        "name": "JSONPath Query",
        "title": "Fetch variables ID and UniqueName",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Fetch variables ID and UniqueName",
          "input_json": "$activity.definition_activity_02IAH1KSGK26H49k12ap5jlbdSfO4vHadrk.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"chain_id\")].id",
              "jsonpath_query_name": "Chain_ID_Variable_ID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"observables\")].id",
              "jsonpath_query_name": "Observable_Variable_ID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"observables\")].unique_name",
              "jsonpath_query_name": "Observable_Variable_UniqueName",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"chain_id\")].unique_name",
              "jsonpath_query_name": "Chain_ID_Variable_UniqueName",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"mode\")].id",
              "jsonpath_query_name": "Mode_VariableID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            },
            {
              "jsonpath_query": "$.variables[?(@.properties.name==\"mode\")].unique_name",
              "jsonpath_query_name": "Mode_UniqueName",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH3UDX20TQ0Rw8lNaRlXXxGM5UBpGpmx",
        "name": "HTTP Request",
        "title": "Update Observable Variables with Value",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"schema_id\": \"$activity.definition_activity_02IAIIXPKFZPG2bKMnCOKOjdyhxBm3FkLZl.output.jsonpath_queries.Schema_ID$\",\n  \"title\": \"observables\",\n  \"object_type\": \"variable_workflow\",\n  \"unique_name\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Observable_Variable_UniqueName$\",\n  \"properties\": {\n    \"value\": \"{\\n  \\\"critical\\\": [\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"cisco.com\\\"\\n    }\\n  ]\\n}\",\n    \"scope\": \"input\",\n    \"name\": \"observables\",\n    \"type\": \"datatype.string\",\n    \"description\": \"Observables\",\n    \"is_required\": true,\n    \"display_on_wizard\": false,\n    \"is_invisible\": false,\n    \"variable_string_format\": \"json\"\n  },\n  \"id\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Observable_Variable_ID$\"\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Update Observable Variables with Value",
          "method": "PUT",
          "relative_url": "/api/v2/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$/variables/$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Observable_Variable_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAHBE6OAOXY5JUSt4NIa0TejLFf7pi1o7",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH7HKZGST80LJG2nJgrTIa9j73s633L0",
        "name": "HTTP Request",
        "title": "Update Chain_ID Variables with Value",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"schema_id\": \"$activity.definition_activity_02IAIIXPKFZPG2bKMnCOKOjdyhxBm3FkLZl.output.jsonpath_queries.Schema_ID$\",\n  \"title\": \"chain_id\",\n  \"object_type\": \"variable_workflow\",\n  \"unique_name\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Chain_ID_Variable_UniqueName$\",\n  \"properties\": {\n    \"value\": \"1234\",\n    \"scope\": \"input\",\n    \"name\": \"chain_id\",\n    \"type\": \"datatype.string\",\n    \"description\": \"ChainID\",\n    \"is_required\": true,\n    \"display_on_wizard\": false,\n    \"is_invisible\": false,\n    \"variable_string_format\": \"text\"\n  },\n  \"id\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Chain_ID_Variable_ID$\"\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Update Chain_ID Variables with Value",
          "method": "PUT",
          "relative_url": "/api/v2/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$/variables/$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Chain_ID_Variable_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAHBIJ8HJBK0yiCw7SDwLYxLiev1B4sEq",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7AEK6A8NJ2G5fFMD059TOXWArIrVaQa",
        "name": "HTTP Request",
        "title": "Update Mode Variables with Value",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"schema_id\": \"$activity.definition_activity_02IAIIXPKFZPG2bKMnCOKOjdyhxBm3FkLZl.output.jsonpath_queries.Schema_ID$\",\n  \"title\": \"mode\",\n  \"object_type\": \"variable_workflow\",\n  \"unique_name\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Mode_UniqueName$\",\n  \"properties\": {\n    \"value\": \"quite\",\n    \"scope\": \"input\",\n    \"name\": \"mode\",\n    \"type\": \"datatype.string\",\n    \"description\": \"Mode\",\n    \"is_required\": true,\n    \"display_on_wizard\": false,\n    \"is_invisible\": false,\n    \"variable_string_format\": \"text\"\n  },\n  \"id\": \"$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Mode_VariableID$\"\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Update Mode Variables with Value",
          "method": "PUT",
          "relative_url": "/api/v2/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$/variables/$activity.definition_activity_02IAH1GPGAZN977l2W1448cN6WAjfav6kKz.output.jsonpath_queries.Mode_VariableID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7AHXMB9C20xkTh1V5inTs1SiHIaha6D",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGGPKT35F64CjouHi5BSsvRzYxZwoJHI",
        "name": "Automation - Validate Workflow",
        "title": "Automation - Validate Workflow",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Automation - Validate Workflow",
          "input": {
            "variable_workflow_026R3MTZOT2EW1USQRiDliyt5aa93GWmfiK": "Authorization",
            "variable_workflow_026R3MTZOTILC1W3cvTmVhLsJWBnHC3vcH4": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$",
            "variable_workflow_026R3MTZOTPNC64XRWBcpmPc5VhBJBNaxj0": "$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "target_type": "web-service.endpoint",
            "use_workflow_target": true
          },
          "workflow_id": "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa",
          "workflow_name": "Automation - Validate Workflow"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7X4XPEA2A52kxs4hP356lQ8qqYKEkD1",
        "name": "HTTP Request",
        "title": "GET Created Workflow by ID from TAC Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "GET Created Workflow by ID from TAC Admin",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7X8WYB25V5fH5ePCMoopzthYBfuZtpy",
        "name": "HTTP Request",
        "title": "GET Created Workflow by ID from Admin (Expected to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "GET Created Workflow by ID from Admin (Expected to Fail)",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7WI2LIS6W3lPE9Ys1SjANB241WSDrBw",
        "name": "HTTP Request",
        "title": "GET Created Workflow by ID from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "GET Created Workflow by ID from Content Admin",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGQKX1N0FN4KA96aJ5oXA5anPZyRBTHF",
        "name": "HTTP Request",
        "title": "Export Created Incident Analysis WF from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Export Created Incident Analysis WF from Content Admin",
          "method": "GET",
          "relative_url": "/exchange/api/v1/workflows/export?workflow_id=$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGELU2ZY936ppJmHfcTqS3QNFODHRQ1T",
        "name": "HTTP Request",
        "title": "Search Incident Analysis System WF from Content Admin User",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"categories\": [],\n  \"owner\": [],\n  \"rule_types\": [],\n  \"exclude_rule_types\": []\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Search Incident Analysis System WF from Content Admin User",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows?is_atomic=false\u0026start=0\u0026limit=48\u0026sort_by=updated_on\u0026search=XDR%20-%20Observable%20Investigation",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGFXUEJR971IdPe3pZHTsYoRoeufvLrZ",
        "name": "JSONPath Query",
        "title": "Fetch System WF ID",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": true,
          "display_name": "Fetch System WF ID",
          "input_json": "$activity.definition_activity_02IAGELU2ZY936ppJmHfcTqS3QNFODHRQ1T.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.results..id",
              "jsonpath_query_name": "System_WF_ID",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB7Z80AXVLO5J0T7nH5okl7uy6yK8PNhc",
        "name": "HTTP Request",
        "title": "GET System WF by ID from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "GET System WF by ID from Content Admin",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02IAGFXUEJR971IdPe3pZHTsYoRoeufvLrZ.output.jsonpath_queries.System_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB801GN7F8W1NG4UiZjjpjHVj6l9KsAd7",
        "name": "HTTP Request",
        "title": "GET System WF by ID from TAC user",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "GET System WF by ID from TAC user",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02IAGFXUEJR971IdPe3pZHTsYoRoeufvLrZ.output.jsonpath_queries.System_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IB80CPAWRD73yonxDt64p4TbWkcBe4iYi",
        "name": "HTTP Request",
        "title": "GET System WF by ID from Admin (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "GET System WF by ID from Admin (Exp to Fail)",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02IAGFXUEJR971IdPe3pZHTsYoRoeufvLrZ.output.jsonpath_queries.System_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAGKLUS1SLX3oOTYNH5xnSwfR7JRRiYcP",
        "name": "Execute Python Script",
        "title": "Execute Python Script from Content User",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Execute Python Script from Content User",
          "script": "import requests\n\nurl = \"https://$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.target.web-service endpoint.input.host$/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02IAGFXUEJR971IdPe3pZHTsYoRoeufvLrZ.output.jsonpath_queries.System_WF_ID$\"\n\npayload = {'request_body': '{\"02I7E5877XF3Y6ZBij2xvVZLlE9lWn2iTdL\":\"{\\\\n  \\\\\"critical\\\\\": [\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"sha256\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"9095bcc875a27852ea329bab7ffd490f13a07244a36f9637c67b0c9dcc3d523f\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ip\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"192.168.76.22\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ipv6\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"2001:0000:130F:0000:0000:09C0:876A:130B\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"domain\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"somethingmalicious.com\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"url\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"https://internetbadguys.com/some/path\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"email\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"cheesecake@gmail.com\\\\\"\\\\n    }\\\\n  ],\\\\n  \\\\\"high\\\\\": [\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"sha256\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"72f4d481924479030db441ef1054b3a80d440e4b6479f16fa0228d7915c47107\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ip\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"8.78.33.44\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ipv6\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"1050:0:0:0:5:600:300c:326b\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"domain\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"anotherdomain.com\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"url\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"https://cisco.com/en-us/whatever\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"email\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"anotheremail@somedomain.com\\\\\"\\\\n    }\\\\n  ],\\\\n  \\\\\"medium\\\\\": [\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"sha256\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"72f4d481924479030db441ef1054b3a80d552e4b6479f16fa0228d7915c26587\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ip\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"87.33.89.2\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ipv6\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"1050:0:0:0:5:500:300c:326b\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"domain\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"asupercoolwebsite.com\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"url\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"https://somewhereamazing.com/blog/blog2.html\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"email\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"user76@somedomain.com\\\\\"\\\\n    }\\\\n  ],\\\\n  \\\\\"low\\\\\": [\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"sha256\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"72f4d568542158630db441ef1054b3a80d552e4b6479f16fa0228d7915c12358\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ip\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"167.7.22.89\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"ipv6\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"1050:0:0:0:5:400:300c:326b\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"domain\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"mywebsiteisamazing.com\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"url\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"https://cnn.com/some/random/news\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\"type\\\\\": \\\\\"email\\\\\",\\\\n      \\\\\"value\\\\\": \\\\\"bob_jones@anotherdomain.com\\\\\"\\\\n    }\\\\n  ]\\\\n}\",\"02I7E5877YBY46MduBIqafPGMsgAmQs6gnr\":\"quiet\",\"02I7E58782IH258LEObHonZlLNJLxXC83CT\":\"1234\"}'}\nfiles=[\n\n]\nheaders = {\n  'accept': 'application/json, text/plain, */*',\n  'accept-language': 'en-IN,en;q=0.9',\n  'authorization': '$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$',\n  'cache-control': 'no-cache',\n  'origin': 'https://xdr.int.iroh.site',\n  'pragma': 'no-cache',\n  'priority': 'u=1, i',\n  'sec-ch-ua': '\"Google Chrome\";v=\"129\", \"Not=A?Brand\";v=\"8\", \"Chromium\";v=\"129\"',\n  'sec-ch-ua-mobile': '?0',\n  'sec-ch-ua-platform': '\"macOS\"',\n  'sec-fetch-dest': 'empty',\n  'sec-fetch-mode': 'cors',\n  'sec-fetch-site': 'same-site',\n  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36',\n  'x-csco-trxid': 'd56b9625'\n}\n\nresponse = requests.request(\"POST\", url, headers=headers, data=payload, files=files)\n\nprint(response.text)",
          "skip_execution": true
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83732NNNIA7AwEmUUtxzko1lGdzGBcMI",
        "name": "HTTP Request",
        "title": "Import Incident Analysis Workflow from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"workflow\": {\n    \"unique_name\": \"definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC\",\n    \"name\": \"XDR-Incident Analysis WF\",\n    \"title\": \"XDR-Incident Analysis WF\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\",\n    \"variables\": [\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"\",\n          \"scope\": \"local\",\n          \"name\": \"file_path\",\n          \"type\": \"datatype.string\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"sha256,process_name,process_hash,ip,ipv6,url,user\",\n          \"scope\": \"local\",\n          \"name\": \"Supported Observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A comma-separated list of observable types the workflow should support and investigate. Observables with a type not in this list will be ignored\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"{\\n  \\\"critical\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"9095bcc875a27852ea329bab7ffd490f13a07244a36f9637c67b0c9dcc3d523f\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"192.168.76.22\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"2001:0000:130F:0000:0000:09C0:876A:130B\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"somethingmalicious.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://internetbadguys.com/some/path\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"cheesecake@gmail.com\\\"\\n    }\\n  ],\\n  \\\"high\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d440e4b6479f16fa0228d7915c47107\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"8.78.33.44\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:600:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"anotherdomain.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cisco.com/en-us/whatever\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"anotheremail@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"medium\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d552e4b6479f16fa0228d7915c26587\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"87.33.89.2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:500:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"asupercoolwebsite.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://somewhereamazing.com/blog/blog2.html\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"user76@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"low\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d568542158630db441ef1054b3a80d552e4b6479f16fa0228d7915c12358\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"167.7.22.89\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:400:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"mywebsiteisamazing.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cnn.com/some/random/news\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"bob_jones@anotherdomain.com\\\"\\n    }\\n  ]\\n}\",\n          \"scope\": \"input\",\n          \"name\": \"observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A JSON-formatted list of prioritized observables. Supported priorities include: critical, high, medium, low\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"quiet\",\n          \"scope\": \"input\",\n          \"name\": \"mode\",\n          \"type\": \"datatype.string\",\n          \"description\": \"Which investigation mode to use. This must be one of: quiet, moderate, noisy\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"[]\",\n          \"scope\": \"local\",\n          \"name\": \"Observables to Investigate\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A list of filtered observables to investigate. This will be populated automatically\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"1234\",\n          \"scope\": \"input\",\n          \"name\": \"chain_id\",\n          \"type\": \"datatype.string\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ\",\n        \"object_type\": \"variable_workflow\"\n      }\n    ],\n    \"properties\": {\n      \"atomic\": {\n        \"is_atomic\": false\n      },\n      \"delete_workflow_instance\": false,\n      \"description\": \"This workflow parses and investigates a list of prioritized observables from the Cisco XDR data platform.\\n\\nTargets: Automation APIs, Conure APIs, Platform APIs\\n\\nSteps:\\n[] Process the available XDR integrations\\n[] Process and filter the observables provided\\n[] For each observable type:\\n[]\u003e Which investigation mode is being requested?\\n[]\u003e\u003e If the mode is quiet: deliberate the observables and filter out observables with a clean disposition\\n[]\u003e\u003e If the mode is moderate or noisy: use the observable list unfiltered\\n[]\u003e Build the investigation request payload\\n[]\u003e Request an investigation be created\\n[]\u003e Check if the request was successful:\\n[]\u003e\u003e If it was, attempt to extract the investigation ID and append it to the output list\\n[]\u003e\u003e If it wasn't, output an error\",\n      \"display_name\": \"XDR-Incident Analysis WF\",\n      \"runtime_user\": {\n        \"target_default\": true\n      },\n      \"target\": {\n        \"execute_on_target_group\": true,\n        \"target_group\": {\n          \"target_group_id\": \"target_group_01HLKTH50I3ZU5IfL3dwQos38eRFcE5gYjM\",\n          \"run_on_all_targets\": false,\n          \"selected_target_types\": [\n            \"web-service.endpoint\"\n          ],\n          \"use_criteria\": {\n            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n            \"conditions\": [\n              {\n                \"operator\": \"eqi\",\n                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                \"right_operand\": \"Automation APIs\"\n              }\n            ]\n          }\n        }\n      },\n      \"wf_metadata\": {\n        \"coa\": {\n          \"intent\": \"incident_analysis\"\n        }\n      }\n    },\n    \"object_type\": \"definition_workflow\",\n    \"actions\": [\n      {\n        \"unique_name\": \"definition_activity_02I7SLWVONIYD1cKaqhLHUqOZa2LXPODA42\",\n        \"name\": \"Group\",\n        \"title\": \"Process integrations\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process integrations\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H\",\n            \"name\": \"XDR - Administration - Get Integration Instances\",\n            \"title\": \"XDR - Administration - Get Integration Instances\",\n            \"type\": \"workflow.atomic_workflow\",\n            \"base_type\": \"subworkflow\",\n            \"properties\": {\n              \"continue_on_failure\": false,\n              \"display_name\": \"XDR - Administration - Get Integration Instances\",\n              \"input\": {\n                \"variable_workflow_02I0BA092EDR01iwLcaRQb5LD2fTIOaDjJn\": \"\"\n              },\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Platform APIs\"\n                      }\n                    ]\n                  }\n                }\n              },\n              \"workflow_id\": \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n              \"workflow_name\": \"XDR - Administration - Get Integration Instances\"\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Process integrations\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Process integrations\",\n              \"script\": \"import sys\\nimport json\\n\\nintegrations = json.loads(sys.argv[1])\\n\\nintegrationCategories = {\\n  'endpoint': [\\n    '180768a2-375d-4aa1-84c1-f3c7da8aa7a8', # Palo Alto Networks Cortex XDR\\n  ],\\n  'dns': [\\n    '188d70f7-29d5-5069-9098-d83a3ec8e797', # Umbrella\\n    '3cba0c69-31a4-47ba-96c0-8aab4c75fc36', # Cisco Secure Access\\n  ],\\n  'network': [\\n    '65226ec8-2501-4028-88b8-87a3713cf44c', # Exabeam (NAM)\\n    '62d6dc99-9c7e-49e1-b5cc-bc708428258a', # Exabeam (EU)\\n    'ce7b814c-a146-4167-b44c-6cadfc347fa6', # Exabeam (APJC)\\n    '14cc299f-d0ca-4f3a-8ee4-0faeea39d1d7', # Darktrace /NETWORK\\n  ],\\n  'email': [\\n    '5c0b669f-ed4b-5d7f-a892-117d09bd9b85', # Secure Email and Web Manager\\n    'b2219f60-8ccf-5b1d-afb0-778ccd72dcdd', # Secure Email Appliance\\n  ],\\n  'firewall': [\\n    '699f0419-9565-4f42-b206-bf39b7a9f626', # Check Point Quantum Smart-1 Cloud\\n    'daea880c-eec4-4a20-93d9-bd47185228dc', # Palo Alto Networks Firewalls with Strata Logging Service\\n    '544e6371-9f0c-573e-a31c-d44f7ae65c92', # Secure Firewall\\n  ]\\n}\\n\\nintegrationMap = {\\n  'sha256': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_name': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_hash': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ip': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ipv6': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'url': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'user': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'email': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] }\\n}\\n\\nfor integration in integrations:\\n  for observableType in integrationMap:\\n    if integration['module_type_id'] in integrationMap[observableType]['supported']:\\n      integrationMap[observableType]['discovered'].append({\\n        'name': integration['name'],\\n        'module_type_id': integration['module_type_id'],\\n        'module_instance_id': integration['id']\\n      })\\n      \\n      integrationMap[observableType]['discoveredModuleInstances'].append(integration['id'])\\n\\nintegrationsOut = {}\\n\\nfor observableType in integrationMap:\\n  integrationsOut[observableType] = integrationMap[observableType]['discoveredModuleInstances']\\n\\nintegrationsOut = json.dumps(integrationsOut)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H.output.variable_workflow_02HSRQ9SQ5TQU2jP192QwMXBnGcvHQlpFaj$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"integrationsOut\",\n                  \"script_query_name\": \"integrationsOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX1MSSY8090bo6LJN56jxdDvWprUIE\",\n        \"name\": \"Group\",\n        \"title\": \"Process observables\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process observables\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Format observables\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Format observables\",\n              \"script\": \"import sys\\nimport json\\n\\nobservableInput = json.loads(sys.argv[1])\\nsupportedObservables = sys.argv[2].split(',')\\nmode = sys.argv[3]\\n\\nobservablesByType = {}\\nobservablesOut = []\\n\\nfor severity, observables in observableInput.items():\\n  if mode in [ 'quiet', 'moderate' ] and severity not in [ 'critical', 'high' ]: continue\\n\\n  for observable in observables:\\n    if observable['type'] in observablesByType and observable not in observablesByType[observable['type']]:\\n      observablesByType[observable['type']].append(observable)\\n    else:\\n      observablesByType[observable['type']] = [ observable ]\\n\\nfor observableType in observablesByType:\\n  if observableType not in supportedObservables: continue\\n\\n  observablesOut.append({\\n    'type': observableType,\\n    'observables': observablesByType[observableType]\\n  })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n              \"script_arguments\": [\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"observablesOut\",\n                  \"script_query_name\": \"observablesOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh\",\n            \"name\": \"Read Table from JSON\",\n            \"title\": \"Read observables to table\",\n            \"type\": \"corejava.read_table_from_json\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Read observables to table\",\n              \"input_json\": \"$activity.definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V.output.script_queries.observablesOut$\",\n              \"jsonpath_query\": \"$.\",\n              \"persist_output\": false,\n              \"populate_columns\": false,\n              \"skip_execution\": false,\n              \"table_columns\": [\n                {\n                  \"column_name\": \"type\",\n                  \"column_type\": \"string\"\n                },\n                {\n                  \"column_name\": \"observables\",\n                  \"column_type\": \"string\"\n                }\n              ]\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV\",\n        \"name\": \"For Each\",\n        \"title\": \"For each observable type\",\n        \"type\": \"logic.for_each\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"For each observable type\",\n          \"skip_execution\": false,\n          \"source_array\": \"$activity.definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh.output.read_table_from_json$\"\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX91D0RD6s3YlvWuK258SltFmRgDgx\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Which mode is being used?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Which mode is being used?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXA4WA6Z2b5LIKlLqojsuMc0SN67Zw\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Quiet\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                    \"operator\": \"eqi\",\n                    \"right_operand\": \"quiet\"\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Quiet\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0\",\n                    \"name\": \"XDR - Investigate - Deliberate Observables\",\n                    \"title\": \"XDR - Investigate - Deliberate Observables\",\n                    \"type\": \"workflow.atomic_workflow\",\n                    \"base_type\": \"subworkflow\",\n                    \"properties\": {\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"XDR - Investigate - Deliberate Observables\",\n                      \"input\": {\n                        \"variable_workflow_029824ANUJZ160sI3iLAAzmNA9jO0LTSy4z\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                      },\n                      \"runtime_user\": {\n                        \"target_default\": true\n                      },\n                      \"skip_execution\": false,\n                      \"target\": {\n                        \"override_workflow_target_group_criteria\": true,\n                        \"target_group\": {\n                          \"run_on_all_targets\": false,\n                          \"use_criteria\": {\n                            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                            \"conditions\": [\n                              {\n                                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                                \"operator\": \"eqi\",\n                                \"right_operand\": \"Platform APIs\"\n                              }\n                            ]\n                          }\n                        }\n                      },\n                      \"workflow_id\": \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\",\n                      \"workflow_name\": \"XDR - Investigate - Deliberate Observables\"\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXEDWGQW0kTsZetOJN8OSoJiuqxSxp\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was deliberation successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was deliberation successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXFOTC2M0wD8XDMzr0WlX03LBqfQY7\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXH7IAIG3G4ll5aJg5yYgoRymFPDz3\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to deliberate for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Process the deliberation results\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Process the deliberation results\",\n                      \"script\": \"import sys\\nimport json\\n\\nallObservables = json.loads(sys.argv[1])\\ndeliberateResults = json.loads(sys.argv[2])\\n\\nobservablesReturned = {}\\n\\nif 'data' in deliberateResults:\\n  for module in deliberateResults['data']:\\n    if 'verdicts' in module['data']:\\n      if 'docs' in module['data']['verdicts']:\\n        for verdict in module['data']['verdicts']['docs']:\\n          observableKey = verdict['observable']['type'] + ':' + verdict['observable']['value']\\n          \\n          if observableKey in observablesReturned and verdict['disposition_name'].lower() in [ 'clean', 'malicious', 'suspicious', 'unknown' ]:\\n            observablesReturned[observableKey][verdict['disposition_name'].lower() + '_count'] += 1;\\n          else:\\n            observablesReturned[observableKey] = {\\n              'type': verdict['observable']['type'],\\n              'value': verdict['observable']['value'],\\n              'clean_count': 1 if verdict['disposition_name'].lower() == 'clean' else 0,\\n              'malicious_count': 1 if verdict['disposition_name'].lower() == 'malicious' else 0,\\n              'suspicious_count': 1 if verdict['disposition_name'].lower() == 'suspicious' else 0,\\n              'unknown_count': 1 if verdict['disposition_name'].lower() == 'unknown' else 0\\n            }\\n\\nfor observable in allObservables:\\n  observableKey = observable['type'] + ':' + observable['value']\\n  \\n  if observableKey not in observablesReturned:\\n    observablesReturned[observableKey] = {\\n      'type': observable['type'],\\n      'value': observable['value'],\\n      'clean_count': 0,\\n      'malicious_count': 0,\\n      'suspicious_count': 0,\\n      'unknown_count': 0\\n    }\\n\\nobservablesOut = []\\n\\nfor observableKey in observablesReturned:\\n  observable = observablesReturned[observableKey]\\n  \\n  if observable['clean_count'] == 0:\\n    observablesOut.append({\\n      'type': observable['type'],\\n      'value': observable['value']\\n    })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n                      \"script_arguments\": [\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\",\n                        \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.variable_workflow_029824ANUJACZ0uBon29pn4OPF7PkXpbQM6$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"observablesOut\",\n                          \"script_query_name\": \"observablesOut\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXKCP0572NE4rY3mPCvcELDTyR53ld\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0.output.script_queries.observablesOut$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLXLU9R2S2xGrqmoUEaGDgmcs0XHj3I\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Moderate or Noisy\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"moderate\"\n                    },\n                    \"operator\": \"or\",\n                    \"right_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"noisy\"\n                    }\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Moderate or Noisy\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXNIZFED1301LobMg5PSDvCgdLMdIR\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Build the request payload\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Build the request payload\",\n              \"script\": \"import sys\\nimport json\\nfrom datetime import datetime, timedelta\\n\\nobservableType = sys.argv[1]\\nobservables = json.loads(sys.argv[2])\\nintegrations = json.loads(sys.argv[3])\\n\\nnow = datetime.now()\\nthirtyDaysAgo = now - timedelta(days=30)\\n\\npayload = {\\n  \\\"observables\\\": observables,\\n  \\\"modules\\\": integrations[observableType],\\n  \\\"time_window\\\": {\\n    \\\"start_time\\\": thirtyDaysAgo.isoformat(),\\n    \\\"end_time\\\": now.isoformat()\\n  },\\n  \\\"source\\\": \\\"Cisco XDR Automated Question\\\",\\n  \\\"title\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\",\\n  \\\"description\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\"\\n}\\n\\npayload = json.dumps(payload)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                \"$activity.definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw.output.script_queries.integrationsOut$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"payload\",\n                  \"script_query_name\": \"payload\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK\",\n            \"name\": \"HTTP Request\",\n            \"title\": \"Create the investigation\",\n            \"type\": \"web-service.http_request\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"accept\": \"application/json\",\n              \"action_timeout\": 180,\n              \"allow_auto_redirect\": true,\n              \"allow_headers_redirect\": false,\n              \"body\": \"$activity.definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP.output.script_queries.payload$\",\n              \"content_type\": \"application/json\",\n              \"continue_on_error_status_code\": true,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Create the investigation\",\n              \"method\": \"POST\",\n              \"relative_url\": \"/v2/investigation\",\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Conure APIs\"\n                      }\n                    ]\n                  }\n                }\n              }\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXS78SY95mkGqRGILc8NX3ILgj2cVe\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Was the request successful?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Was the request successful?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXTEUOH118hLb2L01dnNdNZ4NfaetT\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"200/Success\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"200/Success\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4\",\n                    \"name\": \"JSONPath Query\",\n                    \"title\": \"Extract the investigation ID\",\n                    \"type\": \"corejava.jsonpathquery\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"Extract the investigation ID\",\n                      \"input_json\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"jsonpath_queries\": [\n                        {\n                          \"jsonpath_query\": \"$.investigation_id\",\n                          \"jsonpath_query_name\": \"investigationId\",\n                          \"jsonpath_query_type\": \"string\",\n                          \"zdate_type_format\": \"yyyy-MM-dd'T'HH:mm:ssZ\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXWLN6046008yoGxYyIUsDbUMgQXdy\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was extraction successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was extraction successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXXXF0WB34BuPx5fVPlrD7gdTw2hDt\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXZEZ6AI4pKeCQuKJnCkKx8FE2JpA7\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to extract the investigation ID\\n\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Add the investigation ID to the list\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Add the investigation ID to the list\",\n                      \"script\": \"import sys\\nimport json\\n\\ninvestigationIds = sys.argv[1]\\ninvestigationId = sys.argv[2]\\nobservableType = sys.argv[3]\\n\\nif len(investigationIds) \u003e 0:\\n  investigationIds = json.loads(investigationIds)\\nelse:\\n  investigationIds = []\\n\\n#investigationIds.append({\\n#  'observableType': observableType,\\n#  'investigationId': investigationId\\n#})\\n\\ninvestigationIds.append(investigationId)\\n\\ninvestigationIds = json.dumps(investigationIds)\",\n                      \"script_arguments\": [\n                        \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                        \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.jsonpath_queries.investigationId$\",\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"investigationIds\",\n                          \"script_query_name\": \"investigationIds\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY2ENE416OU6KhOPdPLTp93d4amZVq\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Update local variables\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Update local variables\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH.output.script_queries.investigationIds$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLY43PTBF1jjX8UaTLUPunvaqDDndNJ\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Anything else\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"ne\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Anything else\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY5PKXS13vSQ4qTIuoDQtvKMzpMoZD\",\n                    \"name\": \"Completed\",\n                    \"title\": \"Failed\",\n                    \"type\": \"logic.completed\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"completion_type\": \"failed-completed\",\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Failed\",\n                      \"result_message\": \"Failed to create the investigation for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\\n\\nStatus code: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLY73GCYC58Rsn0tiazys08j048xxkX\",\n        \"name\": \"Set Variables\",\n        \"title\": \"Set file path\",\n        \"type\": \"core.set_multiple_variables\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Set file path\",\n          \"skip_execution\": false,\n          \"variables_to_update\": [\n            {\n              \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx$\",\n              \"variable_value_new\": \"chain_id=$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ$/$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.instance_id$.json\"\n            }\n          ]\n        },\n        \"object_type\": \"definition_activity\"\n      }\n    ],\n    \"categories\": [\n      \"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf\"\n    ]\n  },\n  \"atomic_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ],\n  \"dependent_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ]\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Import Incident Analysis Workflow from Content Admin",
          "method": "POST",
          "relative_url": "exchange/api/v1/workflows/import?create_new=true\u0026overwrite=false\u0026workflow_unique_name=definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83NGAK6ONW7enFBZB81C2KvUWq4tFWjt",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A",
        "name": "JSONPath Query",
        "title": "Fetch Imported WF ID",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": true,
          "display_name": "Fetch Imported WF ID",
          "input_json": "$activity.definition_activity_02I83732NNNIA7AwEmUUtxzko1lGdzGBcMI.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$..id",
              "jsonpath_query_name": "Import_WF_ID",
              "jsonpath_query_type": "string",
              "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83MRMZ8SAH42aqFt8CxGRQy77psFtkag",
        "name": "HTTP Request",
        "title": "Validate Import wf from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Validate Import wf from Content Admin",
          "method": "POST",
          "relative_url": "be-console/api/v1/workflows/$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$/validate",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83NKF7NP2X3uv4wc7Eh7asP6TMS10iCV",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83OOFGIUG33awzr8vvSikhgLPQ97ccOH",
        "name": "HTTP Request",
        "title": "GET Imported wf from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "GET Imported wf from Content Admin",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83P8ZXKSNS55XAYTJY0x6gCYfXEr3aaN",
        "name": "HTTP Request",
        "title": "GET Imported wf from Admin (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "GET Imported wf from Admin (Exp to Fail)",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83PGJ03Z3M4dedegpZjsVhRZ8KC1s7XN",
        "name": "HTTP Request",
        "title": "GET Imported wf from TAC User",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "GET Imported wf from TAC User",
          "method": "GET",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83NS3A2SC15BEU9VRa1Vo7jm010dxlGJ",
        "name": "HTTP Request",
        "title": "Import Incident Analysis Workflow from Admin (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"workflow\": {\n    \"unique_name\": \"definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC\",\n    \"name\": \"XDR-Incident Analysis WF\",\n    \"title\": \"XDR-Incident Analysis WF\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\",\n    \"variables\": [\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"\",\n          \"scope\": \"local\",\n          \"name\": \"file_path\",\n          \"type\": \"datatype.string\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"sha256,process_name,process_hash,ip,ipv6,url,user\",\n          \"scope\": \"local\",\n          \"name\": \"Supported Observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A comma-separated list of observable types the workflow should support and investigate. Observables with a type not in this list will be ignored\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"{\\n  \\\"critical\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"9095bcc875a27852ea329bab7ffd490f13a07244a36f9637c67b0c9dcc3d523f\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"192.168.76.22\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"2001:0000:130F:0000:0000:09C0:876A:130B\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"somethingmalicious.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://internetbadguys.com/some/path\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"cheesecake@gmail.com\\\"\\n    }\\n  ],\\n  \\\"high\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d440e4b6479f16fa0228d7915c47107\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"8.78.33.44\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:600:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"anotherdomain.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cisco.com/en-us/whatever\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"anotheremail@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"medium\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d552e4b6479f16fa0228d7915c26587\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"87.33.89.2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:500:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"asupercoolwebsite.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://somewhereamazing.com/blog/blog2.html\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"user76@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"low\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d568542158630db441ef1054b3a80d552e4b6479f16fa0228d7915c12358\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"167.7.22.89\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:400:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"mywebsiteisamazing.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cnn.com/some/random/news\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"bob_jones@anotherdomain.com\\\"\\n    }\\n  ]\\n}\",\n          \"scope\": \"input\",\n          \"name\": \"observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A JSON-formatted list of prioritized observables. Supported priorities include: critical, high, medium, low\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"quiet\",\n          \"scope\": \"input\",\n          \"name\": \"mode\",\n          \"type\": \"datatype.string\",\n          \"description\": \"Which investigation mode to use. This must be one of: quiet, moderate, noisy\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"[]\",\n          \"scope\": \"local\",\n          \"name\": \"Observables to Investigate\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A list of filtered observables to investigate. This will be populated automatically\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"1234\",\n          \"scope\": \"input\",\n          \"name\": \"chain_id\",\n          \"type\": \"datatype.string\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ\",\n        \"object_type\": \"variable_workflow\"\n      }\n    ],\n    \"properties\": {\n      \"atomic\": {\n        \"is_atomic\": false\n      },\n      \"delete_workflow_instance\": false,\n      \"description\": \"This workflow parses and investigates a list of prioritized observables from the Cisco XDR data platform.\\n\\nTargets: Automation APIs, Conure APIs, Platform APIs\\n\\nSteps:\\n[] Process the available XDR integrations\\n[] Process and filter the observables provided\\n[] For each observable type:\\n[]\u003e Which investigation mode is being requested?\\n[]\u003e\u003e If the mode is quiet: deliberate the observables and filter out observables with a clean disposition\\n[]\u003e\u003e If the mode is moderate or noisy: use the observable list unfiltered\\n[]\u003e Build the investigation request payload\\n[]\u003e Request an investigation be created\\n[]\u003e Check if the request was successful:\\n[]\u003e\u003e If it was, attempt to extract the investigation ID and append it to the output list\\n[]\u003e\u003e If it wasn't, output an error\",\n      \"display_name\": \"XDR-Incident Analysis WF\",\n      \"runtime_user\": {\n        \"target_default\": true\n      },\n      \"target\": {\n        \"execute_on_target_group\": true,\n        \"target_group\": {\n          \"target_group_id\": \"target_group_01HLKTH50I3ZU5IfL3dwQos38eRFcE5gYjM\",\n          \"run_on_all_targets\": false,\n          \"selected_target_types\": [\n            \"web-service.endpoint\"\n          ],\n          \"use_criteria\": {\n            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n            \"conditions\": [\n              {\n                \"operator\": \"eqi\",\n                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                \"right_operand\": \"Automation APIs\"\n              }\n            ]\n          }\n        }\n      },\n      \"wf_metadata\": {\n        \"coa\": {\n          \"intent\": \"incident_analysis\"\n        }\n      }\n    },\n    \"object_type\": \"definition_workflow\",\n    \"actions\": [\n      {\n        \"unique_name\": \"definition_activity_02I7SLWVONIYD1cKaqhLHUqOZa2LXPODA42\",\n        \"name\": \"Group\",\n        \"title\": \"Process integrations\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process integrations\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H\",\n            \"name\": \"XDR - Administration - Get Integration Instances\",\n            \"title\": \"XDR - Administration - Get Integration Instances\",\n            \"type\": \"workflow.atomic_workflow\",\n            \"base_type\": \"subworkflow\",\n            \"properties\": {\n              \"continue_on_failure\": false,\n              \"display_name\": \"XDR - Administration - Get Integration Instances\",\n              \"input\": {\n                \"variable_workflow_02I0BA092EDR01iwLcaRQb5LD2fTIOaDjJn\": \"\"\n              },\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Platform APIs\"\n                      }\n                    ]\n                  }\n                }\n              },\n              \"workflow_id\": \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n              \"workflow_name\": \"XDR - Administration - Get Integration Instances\"\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Process integrations\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Process integrations\",\n              \"script\": \"import sys\\nimport json\\n\\nintegrations = json.loads(sys.argv[1])\\n\\nintegrationCategories = {\\n  'endpoint': [\\n    '180768a2-375d-4aa1-84c1-f3c7da8aa7a8', # Palo Alto Networks Cortex XDR\\n  ],\\n  'dns': [\\n    '188d70f7-29d5-5069-9098-d83a3ec8e797', # Umbrella\\n    '3cba0c69-31a4-47ba-96c0-8aab4c75fc36', # Cisco Secure Access\\n  ],\\n  'network': [\\n    '65226ec8-2501-4028-88b8-87a3713cf44c', # Exabeam (NAM)\\n    '62d6dc99-9c7e-49e1-b5cc-bc708428258a', # Exabeam (EU)\\n    'ce7b814c-a146-4167-b44c-6cadfc347fa6', # Exabeam (APJC)\\n    '14cc299f-d0ca-4f3a-8ee4-0faeea39d1d7', # Darktrace /NETWORK\\n  ],\\n  'email': [\\n    '5c0b669f-ed4b-5d7f-a892-117d09bd9b85', # Secure Email and Web Manager\\n    'b2219f60-8ccf-5b1d-afb0-778ccd72dcdd', # Secure Email Appliance\\n  ],\\n  'firewall': [\\n    '699f0419-9565-4f42-b206-bf39b7a9f626', # Check Point Quantum Smart-1 Cloud\\n    'daea880c-eec4-4a20-93d9-bd47185228dc', # Palo Alto Networks Firewalls with Strata Logging Service\\n    '544e6371-9f0c-573e-a31c-d44f7ae65c92', # Secure Firewall\\n  ]\\n}\\n\\nintegrationMap = {\\n  'sha256': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_name': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_hash': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ip': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ipv6': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'url': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'user': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'email': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] }\\n}\\n\\nfor integration in integrations:\\n  for observableType in integrationMap:\\n    if integration['module_type_id'] in integrationMap[observableType]['supported']:\\n      integrationMap[observableType]['discovered'].append({\\n        'name': integration['name'],\\n        'module_type_id': integration['module_type_id'],\\n        'module_instance_id': integration['id']\\n      })\\n      \\n      integrationMap[observableType]['discoveredModuleInstances'].append(integration['id'])\\n\\nintegrationsOut = {}\\n\\nfor observableType in integrationMap:\\n  integrationsOut[observableType] = integrationMap[observableType]['discoveredModuleInstances']\\n\\nintegrationsOut = json.dumps(integrationsOut)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H.output.variable_workflow_02HSRQ9SQ5TQU2jP192QwMXBnGcvHQlpFaj$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"integrationsOut\",\n                  \"script_query_name\": \"integrationsOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX1MSSY8090bo6LJN56jxdDvWprUIE\",\n        \"name\": \"Group\",\n        \"title\": \"Process observables\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process observables\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Format observables\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Format observables\",\n              \"script\": \"import sys\\nimport json\\n\\nobservableInput = json.loads(sys.argv[1])\\nsupportedObservables = sys.argv[2].split(',')\\nmode = sys.argv[3]\\n\\nobservablesByType = {}\\nobservablesOut = []\\n\\nfor severity, observables in observableInput.items():\\n  if mode in [ 'quiet', 'moderate' ] and severity not in [ 'critical', 'high' ]: continue\\n\\n  for observable in observables:\\n    if observable['type'] in observablesByType and observable not in observablesByType[observable['type']]:\\n      observablesByType[observable['type']].append(observable)\\n    else:\\n      observablesByType[observable['type']] = [ observable ]\\n\\nfor observableType in observablesByType:\\n  if observableType not in supportedObservables: continue\\n\\n  observablesOut.append({\\n    'type': observableType,\\n    'observables': observablesByType[observableType]\\n  })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n              \"script_arguments\": [\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"observablesOut\",\n                  \"script_query_name\": \"observablesOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh\",\n            \"name\": \"Read Table from JSON\",\n            \"title\": \"Read observables to table\",\n            \"type\": \"corejava.read_table_from_json\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Read observables to table\",\n              \"input_json\": \"$activity.definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V.output.script_queries.observablesOut$\",\n              \"jsonpath_query\": \"$.\",\n              \"persist_output\": false,\n              \"populate_columns\": false,\n              \"skip_execution\": false,\n              \"table_columns\": [\n                {\n                  \"column_name\": \"type\",\n                  \"column_type\": \"string\"\n                },\n                {\n                  \"column_name\": \"observables\",\n                  \"column_type\": \"string\"\n                }\n              ]\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV\",\n        \"name\": \"For Each\",\n        \"title\": \"For each observable type\",\n        \"type\": \"logic.for_each\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"For each observable type\",\n          \"skip_execution\": false,\n          \"source_array\": \"$activity.definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh.output.read_table_from_json$\"\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX91D0RD6s3YlvWuK258SltFmRgDgx\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Which mode is being used?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Which mode is being used?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXA4WA6Z2b5LIKlLqojsuMc0SN67Zw\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Quiet\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                    \"operator\": \"eqi\",\n                    \"right_operand\": \"quiet\"\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Quiet\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0\",\n                    \"name\": \"XDR - Investigate - Deliberate Observables\",\n                    \"title\": \"XDR - Investigate - Deliberate Observables\",\n                    \"type\": \"workflow.atomic_workflow\",\n                    \"base_type\": \"subworkflow\",\n                    \"properties\": {\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"XDR - Investigate - Deliberate Observables\",\n                      \"input\": {\n                        \"variable_workflow_029824ANUJZ160sI3iLAAzmNA9jO0LTSy4z\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                      },\n                      \"runtime_user\": {\n                        \"target_default\": true\n                      },\n                      \"skip_execution\": false,\n                      \"target\": {\n                        \"override_workflow_target_group_criteria\": true,\n                        \"target_group\": {\n                          \"run_on_all_targets\": false,\n                          \"use_criteria\": {\n                            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                            \"conditions\": [\n                              {\n                                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                                \"operator\": \"eqi\",\n                                \"right_operand\": \"Platform APIs\"\n                              }\n                            ]\n                          }\n                        }\n                      },\n                      \"workflow_id\": \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\",\n                      \"workflow_name\": \"XDR - Investigate - Deliberate Observables\"\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXEDWGQW0kTsZetOJN8OSoJiuqxSxp\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was deliberation successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was deliberation successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXFOTC2M0wD8XDMzr0WlX03LBqfQY7\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXH7IAIG3G4ll5aJg5yYgoRymFPDz3\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to deliberate for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Process the deliberation results\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Process the deliberation results\",\n                      \"script\": \"import sys\\nimport json\\n\\nallObservables = json.loads(sys.argv[1])\\ndeliberateResults = json.loads(sys.argv[2])\\n\\nobservablesReturned = {}\\n\\nif 'data' in deliberateResults:\\n  for module in deliberateResults['data']:\\n    if 'verdicts' in module['data']:\\n      if 'docs' in module['data']['verdicts']:\\n        for verdict in module['data']['verdicts']['docs']:\\n          observableKey = verdict['observable']['type'] + ':' + verdict['observable']['value']\\n          \\n          if observableKey in observablesReturned and verdict['disposition_name'].lower() in [ 'clean', 'malicious', 'suspicious', 'unknown' ]:\\n            observablesReturned[observableKey][verdict['disposition_name'].lower() + '_count'] += 1;\\n          else:\\n            observablesReturned[observableKey] = {\\n              'type': verdict['observable']['type'],\\n              'value': verdict['observable']['value'],\\n              'clean_count': 1 if verdict['disposition_name'].lower() == 'clean' else 0,\\n              'malicious_count': 1 if verdict['disposition_name'].lower() == 'malicious' else 0,\\n              'suspicious_count': 1 if verdict['disposition_name'].lower() == 'suspicious' else 0,\\n              'unknown_count': 1 if verdict['disposition_name'].lower() == 'unknown' else 0\\n            }\\n\\nfor observable in allObservables:\\n  observableKey = observable['type'] + ':' + observable['value']\\n  \\n  if observableKey not in observablesReturned:\\n    observablesReturned[observableKey] = {\\n      'type': observable['type'],\\n      'value': observable['value'],\\n      'clean_count': 0,\\n      'malicious_count': 0,\\n      'suspicious_count': 0,\\n      'unknown_count': 0\\n    }\\n\\nobservablesOut = []\\n\\nfor observableKey in observablesReturned:\\n  observable = observablesReturned[observableKey]\\n  \\n  if observable['clean_count'] == 0:\\n    observablesOut.append({\\n      'type': observable['type'],\\n      'value': observable['value']\\n    })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n                      \"script_arguments\": [\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\",\n                        \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.variable_workflow_029824ANUJACZ0uBon29pn4OPF7PkXpbQM6$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"observablesOut\",\n                          \"script_query_name\": \"observablesOut\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXKCP0572NE4rY3mPCvcELDTyR53ld\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0.output.script_queries.observablesOut$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLXLU9R2S2xGrqmoUEaGDgmcs0XHj3I\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Moderate or Noisy\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"moderate\"\n                    },\n                    \"operator\": \"or\",\n                    \"right_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"noisy\"\n                    }\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Moderate or Noisy\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXNIZFED1301LobMg5PSDvCgdLMdIR\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Build the request payload\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Build the request payload\",\n              \"script\": \"import sys\\nimport json\\nfrom datetime import datetime, timedelta\\n\\nobservableType = sys.argv[1]\\nobservables = json.loads(sys.argv[2])\\nintegrations = json.loads(sys.argv[3])\\n\\nnow = datetime.now()\\nthirtyDaysAgo = now - timedelta(days=30)\\n\\npayload = {\\n  \\\"observables\\\": observables,\\n  \\\"modules\\\": integrations[observableType],\\n  \\\"time_window\\\": {\\n    \\\"start_time\\\": thirtyDaysAgo.isoformat(),\\n    \\\"end_time\\\": now.isoformat()\\n  },\\n  \\\"source\\\": \\\"Cisco XDR Automated Question\\\",\\n  \\\"title\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\",\\n  \\\"description\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\"\\n}\\n\\npayload = json.dumps(payload)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                \"$activity.definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw.output.script_queries.integrationsOut$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"payload\",\n                  \"script_query_name\": \"payload\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK\",\n            \"name\": \"HTTP Request\",\n            \"title\": \"Create the investigation\",\n            \"type\": \"web-service.http_request\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"accept\": \"application/json\",\n              \"action_timeout\": 180,\n              \"allow_auto_redirect\": true,\n              \"allow_headers_redirect\": false,\n              \"body\": \"$activity.definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP.output.script_queries.payload$\",\n              \"content_type\": \"application/json\",\n              \"continue_on_error_status_code\": true,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Create the investigation\",\n              \"method\": \"POST\",\n              \"relative_url\": \"/v2/investigation\",\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Conure APIs\"\n                      }\n                    ]\n                  }\n                }\n              }\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXS78SY95mkGqRGILc8NX3ILgj2cVe\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Was the request successful?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Was the request successful?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXTEUOH118hLb2L01dnNdNZ4NfaetT\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"200/Success\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"200/Success\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4\",\n                    \"name\": \"JSONPath Query\",\n                    \"title\": \"Extract the investigation ID\",\n                    \"type\": \"corejava.jsonpathquery\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"Extract the investigation ID\",\n                      \"input_json\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"jsonpath_queries\": [\n                        {\n                          \"jsonpath_query\": \"$.investigation_id\",\n                          \"jsonpath_query_name\": \"investigationId\",\n                          \"jsonpath_query_type\": \"string\",\n                          \"zdate_type_format\": \"yyyy-MM-dd'T'HH:mm:ssZ\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXWLN6046008yoGxYyIUsDbUMgQXdy\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was extraction successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was extraction successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXXXF0WB34BuPx5fVPlrD7gdTw2hDt\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXZEZ6AI4pKeCQuKJnCkKx8FE2JpA7\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to extract the investigation ID\\n\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Add the investigation ID to the list\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Add the investigation ID to the list\",\n                      \"script\": \"import sys\\nimport json\\n\\ninvestigationIds = sys.argv[1]\\ninvestigationId = sys.argv[2]\\nobservableType = sys.argv[3]\\n\\nif len(investigationIds) \u003e 0:\\n  investigationIds = json.loads(investigationIds)\\nelse:\\n  investigationIds = []\\n\\n#investigationIds.append({\\n#  'observableType': observableType,\\n#  'investigationId': investigationId\\n#})\\n\\ninvestigationIds.append(investigationId)\\n\\ninvestigationIds = json.dumps(investigationIds)\",\n                      \"script_arguments\": [\n                        \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                        \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.jsonpath_queries.investigationId$\",\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"investigationIds\",\n                          \"script_query_name\": \"investigationIds\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY2ENE416OU6KhOPdPLTp93d4amZVq\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Update local variables\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Update local variables\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH.output.script_queries.investigationIds$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLY43PTBF1jjX8UaTLUPunvaqDDndNJ\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Anything else\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"ne\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Anything else\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY5PKXS13vSQ4qTIuoDQtvKMzpMoZD\",\n                    \"name\": \"Completed\",\n                    \"title\": \"Failed\",\n                    \"type\": \"logic.completed\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"completion_type\": \"failed-completed\",\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Failed\",\n                      \"result_message\": \"Failed to create the investigation for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\\n\\nStatus code: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLY73GCYC58Rsn0tiazys08j048xxkX\",\n        \"name\": \"Set Variables\",\n        \"title\": \"Set file path\",\n        \"type\": \"core.set_multiple_variables\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Set file path\",\n          \"skip_execution\": false,\n          \"variables_to_update\": [\n            {\n              \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx$\",\n              \"variable_value_new\": \"chain_id=$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ$/$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.instance_id$.json\"\n            }\n          ]\n        },\n        \"object_type\": \"definition_activity\"\n      }\n    ],\n    \"categories\": [\n      \"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf\"\n    ]\n  },\n  \"atomic_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ],\n  \"dependent_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ]\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "Import Incident Analysis Workflow from Admin (Exp to Fail)",
          "method": "POST",
          "relative_url": "exchange/api/v1/workflows/import?create_new=true\u0026overwrite=false\u0026workflow_unique_name=definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83Q4KYK8PV1oP39By1PFbfsBqKpQ3euj",
        "name": "HTTP Request",
        "title": "Import Incident Analysis Workflow from TAC (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n  \"workflow\": {\n    \"unique_name\": \"definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC\",\n    \"name\": \"XDR-Incident Analysis WF\",\n    \"title\": \"XDR-Incident Analysis WF\",\n    \"type\": \"generic.workflow\",\n    \"base_type\": \"workflow\",\n    \"variables\": [\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"\",\n          \"scope\": \"local\",\n          \"name\": \"file_path\",\n          \"type\": \"datatype.string\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"sha256,process_name,process_hash,ip,ipv6,url,user\",\n          \"scope\": \"local\",\n          \"name\": \"Supported Observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A comma-separated list of observable types the workflow should support and investigate. Observables with a type not in this list will be ignored\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"{\\n  \\\"critical\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"9095bcc875a27852ea329bab7ffd490f13a07244a36f9637c67b0c9dcc3d523f\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"192.168.76.22\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"2001:0000:130F:0000:0000:09C0:876A:130B\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"somethingmalicious.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://internetbadguys.com/some/path\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"cheesecake@gmail.com\\\"\\n    }\\n  ],\\n  \\\"high\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d440e4b6479f16fa0228d7915c47107\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"8.78.33.44\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:600:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"anotherdomain.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cisco.com/en-us/whatever\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"anotheremail@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"medium\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d481924479030db441ef1054b3a80d552e4b6479f16fa0228d7915c26587\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"87.33.89.2\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:500:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"asupercoolwebsite.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://somewhereamazing.com/blog/blog2.html\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"user76@somedomain.com\\\"\\n    }\\n  ],\\n  \\\"low\\\": [\\n    {\\n      \\\"type\\\": \\\"sha256\\\",\\n      \\\"value\\\": \\\"72f4d568542158630db441ef1054b3a80d552e4b6479f16fa0228d7915c12358\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ip\\\",\\n      \\\"value\\\": \\\"167.7.22.89\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"ipv6\\\",\\n      \\\"value\\\": \\\"1050:0:0:0:5:400:300c:326b\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"domain\\\",\\n      \\\"value\\\": \\\"mywebsiteisamazing.com\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"url\\\",\\n      \\\"value\\\": \\\"https://cnn.com/some/random/news\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"email\\\",\\n      \\\"value\\\": \\\"bob_jones@anotherdomain.com\\\"\\n    }\\n  ]\\n}\",\n          \"scope\": \"input\",\n          \"name\": \"observables\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A JSON-formatted list of prioritized observables. Supported priorities include: critical, high, medium, low\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"quiet\",\n          \"scope\": \"input\",\n          \"name\": \"mode\",\n          \"type\": \"datatype.string\",\n          \"description\": \"Which investigation mode to use. This must be one of: quiet, moderate, noisy\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"[]\",\n          \"scope\": \"local\",\n          \"name\": \"Observables to Investigate\",\n          \"type\": \"datatype.string\",\n          \"description\": \"A list of filtered observables to investigate. This will be populated automatically\",\n          \"is_required\": false,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"json\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn\",\n        \"object_type\": \"variable_workflow\"\n      },\n      {\n        \"schema_id\": \"datatype.string\",\n        \"properties\": {\n          \"value\": \"1234\",\n          \"scope\": \"input\",\n          \"name\": \"chain_id\",\n          \"type\": \"datatype.string\",\n          \"is_required\": true,\n          \"display_on_wizard\": false,\n          \"is_invisible\": false,\n          \"variable_string_format\": \"text\"\n        },\n        \"unique_name\": \"variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ\",\n        \"object_type\": \"variable_workflow\"\n      }\n    ],\n    \"properties\": {\n      \"atomic\": {\n        \"is_atomic\": false\n      },\n      \"delete_workflow_instance\": false,\n      \"description\": \"This workflow parses and investigates a list of prioritized observables from the Cisco XDR data platform.\\n\\nTargets: Automation APIs, Conure APIs, Platform APIs\\n\\nSteps:\\n[] Process the available XDR integrations\\n[] Process and filter the observables provided\\n[] For each observable type:\\n[]\u003e Which investigation mode is being requested?\\n[]\u003e\u003e If the mode is quiet: deliberate the observables and filter out observables with a clean disposition\\n[]\u003e\u003e If the mode is moderate or noisy: use the observable list unfiltered\\n[]\u003e Build the investigation request payload\\n[]\u003e Request an investigation be created\\n[]\u003e Check if the request was successful:\\n[]\u003e\u003e If it was, attempt to extract the investigation ID and append it to the output list\\n[]\u003e\u003e If it wasn't, output an error\",\n      \"display_name\": \"XDR-Incident Analysis WF\",\n      \"runtime_user\": {\n        \"target_default\": true\n      },\n      \"target\": {\n        \"execute_on_target_group\": true,\n        \"target_group\": {\n          \"target_group_id\": \"target_group_01HLKTH50I3ZU5IfL3dwQos38eRFcE5gYjM\",\n          \"run_on_all_targets\": false,\n          \"selected_target_types\": [\n            \"web-service.endpoint\"\n          ],\n          \"use_criteria\": {\n            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n            \"conditions\": [\n              {\n                \"operator\": \"eqi\",\n                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                \"right_operand\": \"Automation APIs\"\n              }\n            ]\n          }\n        }\n      },\n      \"wf_metadata\": {\n        \"coa\": {\n          \"intent\": \"incident_analysis\"\n        }\n      }\n    },\n    \"object_type\": \"definition_workflow\",\n    \"actions\": [\n      {\n        \"unique_name\": \"definition_activity_02I7SLWVONIYD1cKaqhLHUqOZa2LXPODA42\",\n        \"name\": \"Group\",\n        \"title\": \"Process integrations\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process integrations\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H\",\n            \"name\": \"XDR - Administration - Get Integration Instances\",\n            \"title\": \"XDR - Administration - Get Integration Instances\",\n            \"type\": \"workflow.atomic_workflow\",\n            \"base_type\": \"subworkflow\",\n            \"properties\": {\n              \"continue_on_failure\": false,\n              \"display_name\": \"XDR - Administration - Get Integration Instances\",\n              \"input\": {\n                \"variable_workflow_02I0BA092EDR01iwLcaRQb5LD2fTIOaDjJn\": \"\"\n              },\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Platform APIs\"\n                      }\n                    ]\n                  }\n                }\n              },\n              \"workflow_id\": \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n              \"workflow_name\": \"XDR - Administration - Get Integration Instances\"\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Process integrations\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Process integrations\",\n              \"script\": \"import sys\\nimport json\\n\\nintegrations = json.loads(sys.argv[1])\\n\\nintegrationCategories = {\\n  'endpoint': [\\n    '180768a2-375d-4aa1-84c1-f3c7da8aa7a8', # Palo Alto Networks Cortex XDR\\n  ],\\n  'dns': [\\n    '188d70f7-29d5-5069-9098-d83a3ec8e797', # Umbrella\\n    '3cba0c69-31a4-47ba-96c0-8aab4c75fc36', # Cisco Secure Access\\n  ],\\n  'network': [\\n    '65226ec8-2501-4028-88b8-87a3713cf44c', # Exabeam (NAM)\\n    '62d6dc99-9c7e-49e1-b5cc-bc708428258a', # Exabeam (EU)\\n    'ce7b814c-a146-4167-b44c-6cadfc347fa6', # Exabeam (APJC)\\n    '14cc299f-d0ca-4f3a-8ee4-0faeea39d1d7', # Darktrace /NETWORK\\n  ],\\n  'email': [\\n    '5c0b669f-ed4b-5d7f-a892-117d09bd9b85', # Secure Email and Web Manager\\n    'b2219f60-8ccf-5b1d-afb0-778ccd72dcdd', # Secure Email Appliance\\n  ],\\n  'firewall': [\\n    '699f0419-9565-4f42-b206-bf39b7a9f626', # Check Point Quantum Smart-1 Cloud\\n    'daea880c-eec4-4a20-93d9-bd47185228dc', # Palo Alto Networks Firewalls with Strata Logging Service\\n    '544e6371-9f0c-573e-a31c-d44f7ae65c92', # Secure Firewall\\n  ]\\n}\\n\\nintegrationMap = {\\n  'sha256': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_name': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'process_hash': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ip': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'ipv6': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'url': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'user': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] },\\n  'email': { 'supported': integrationCategories['endpoint'] + integrationCategories['email'] + integrationCategories['network'] + integrationCategories['firewall'], 'discovered': [], 'discoveredModuleInstances': [] }\\n}\\n\\nfor integration in integrations:\\n  for observableType in integrationMap:\\n    if integration['module_type_id'] in integrationMap[observableType]['supported']:\\n      integrationMap[observableType]['discovered'].append({\\n        'name': integration['name'],\\n        'module_type_id': integration['module_type_id'],\\n        'module_instance_id': integration['id']\\n      })\\n      \\n      integrationMap[observableType]['discoveredModuleInstances'].append(integration['id'])\\n\\nintegrationsOut = {}\\n\\nfor observableType in integrationMap:\\n  integrationsOut[observableType] = integrationMap[observableType]['discoveredModuleInstances']\\n\\nintegrationsOut = json.dumps(integrationsOut)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLWY5UARJ6kAP6EbRzxXHYibvqgNH8H.output.variable_workflow_02HSRQ9SQ5TQU2jP192QwMXBnGcvHQlpFaj$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"integrationsOut\",\n                  \"script_query_name\": \"integrationsOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX1MSSY8090bo6LJN56jxdDvWprUIE\",\n        \"name\": \"Group\",\n        \"title\": \"Process observables\",\n        \"type\": \"logic.group\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Process observables\",\n          \"skip_execution\": false\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Format observables\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Format observables\",\n              \"script\": \"import sys\\nimport json\\n\\nobservableInput = json.loads(sys.argv[1])\\nsupportedObservables = sys.argv[2].split(',')\\nmode = sys.argv[3]\\n\\nobservablesByType = {}\\nobservablesOut = []\\n\\nfor severity, observables in observableInput.items():\\n  if mode in [ 'quiet', 'moderate' ] and severity not in [ 'critical', 'high' ]: continue\\n\\n  for observable in observables:\\n    if observable['type'] in observablesByType and observable not in observablesByType[observable['type']]:\\n      observablesByType[observable['type']].append(observable)\\n    else:\\n      observablesByType[observable['type']] = [ observable ]\\n\\nfor observableType in observablesByType:\\n  if observableType not in supportedObservables: continue\\n\\n  observablesOut.append({\\n    'type': observableType,\\n    'observables': observablesByType[observableType]\\n  })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n              \"script_arguments\": [\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG267W78c8ppu8iWsZKBMMYB54wf$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG3FFL4Bxnn35oEO9fMlnRkzLTth$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"observablesOut\",\n                  \"script_query_name\": \"observablesOut\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh\",\n            \"name\": \"Read Table from JSON\",\n            \"title\": \"Read observables to table\",\n            \"type\": \"corejava.read_table_from_json\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Read observables to table\",\n              \"input_json\": \"$activity.definition_activity_02I7SLX3CHTFY5Hh62OvjOxTssEL5gLZZ5V.output.script_queries.observablesOut$\",\n              \"jsonpath_query\": \"$.\",\n              \"persist_output\": false,\n              \"populate_columns\": false,\n              \"skip_execution\": false,\n              \"table_columns\": [\n                {\n                  \"column_name\": \"type\",\n                  \"column_type\": \"string\"\n                },\n                {\n                  \"column_name\": \"observables\",\n                  \"column_type\": \"string\"\n                }\n              ]\n            },\n            \"object_type\": \"definition_activity\"\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV\",\n        \"name\": \"For Each\",\n        \"title\": \"For each observable type\",\n        \"type\": \"logic.for_each\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"For each observable type\",\n          \"skip_execution\": false,\n          \"source_array\": \"$activity.definition_activity_02I7SLX4Z9Q0N3z6DuSV0SLVmN8jgV9qEnh.output.read_table_from_json$\"\n        },\n        \"object_type\": \"definition_activity\",\n        \"actions\": [\n          {\n            \"unique_name\": \"definition_activity_02I7SLX91D0RD6s3YlvWuK258SltFmRgDgx\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Which mode is being used?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Which mode is being used?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXA4WA6Z2b5LIKlLqojsuMc0SN67Zw\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Quiet\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                    \"operator\": \"eqi\",\n                    \"right_operand\": \"quiet\"\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Quiet\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0\",\n                    \"name\": \"XDR - Investigate - Deliberate Observables\",\n                    \"title\": \"XDR - Investigate - Deliberate Observables\",\n                    \"type\": \"workflow.atomic_workflow\",\n                    \"base_type\": \"subworkflow\",\n                    \"properties\": {\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"XDR - Investigate - Deliberate Observables\",\n                      \"input\": {\n                        \"variable_workflow_029824ANUJZ160sI3iLAAzmNA9jO0LTSy4z\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                      },\n                      \"runtime_user\": {\n                        \"target_default\": true\n                      },\n                      \"skip_execution\": false,\n                      \"target\": {\n                        \"override_workflow_target_group_criteria\": true,\n                        \"target_group\": {\n                          \"run_on_all_targets\": false,\n                          \"use_criteria\": {\n                            \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                            \"conditions\": [\n                              {\n                                \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                                \"operator\": \"eqi\",\n                                \"right_operand\": \"Platform APIs\"\n                              }\n                            ]\n                          }\n                        }\n                      },\n                      \"workflow_id\": \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\",\n                      \"workflow_name\": \"XDR - Investigate - Deliberate Observables\"\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXEDWGQW0kTsZetOJN8OSoJiuqxSxp\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was deliberation successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was deliberation successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXFOTC2M0wD8XDMzr0WlX03LBqfQY7\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXH7IAIG3G4ll5aJg5yYgoRymFPDz3\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to deliberate for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Process the deliberation results\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Process the deliberation results\",\n                      \"script\": \"import sys\\nimport json\\n\\nallObservables = json.loads(sys.argv[1])\\ndeliberateResults = json.loads(sys.argv[2])\\n\\nobservablesReturned = {}\\n\\nif 'data' in deliberateResults:\\n  for module in deliberateResults['data']:\\n    if 'verdicts' in module['data']:\\n      if 'docs' in module['data']['verdicts']:\\n        for verdict in module['data']['verdicts']['docs']:\\n          observableKey = verdict['observable']['type'] + ':' + verdict['observable']['value']\\n          \\n          if observableKey in observablesReturned and verdict['disposition_name'].lower() in [ 'clean', 'malicious', 'suspicious', 'unknown' ]:\\n            observablesReturned[observableKey][verdict['disposition_name'].lower() + '_count'] += 1;\\n          else:\\n            observablesReturned[observableKey] = {\\n              'type': verdict['observable']['type'],\\n              'value': verdict['observable']['value'],\\n              'clean_count': 1 if verdict['disposition_name'].lower() == 'clean' else 0,\\n              'malicious_count': 1 if verdict['disposition_name'].lower() == 'malicious' else 0,\\n              'suspicious_count': 1 if verdict['disposition_name'].lower() == 'suspicious' else 0,\\n              'unknown_count': 1 if verdict['disposition_name'].lower() == 'unknown' else 0\\n            }\\n\\nfor observable in allObservables:\\n  observableKey = observable['type'] + ':' + observable['value']\\n  \\n  if observableKey not in observablesReturned:\\n    observablesReturned[observableKey] = {\\n      'type': observable['type'],\\n      'value': observable['value'],\\n      'clean_count': 0,\\n      'malicious_count': 0,\\n      'suspicious_count': 0,\\n      'unknown_count': 0\\n    }\\n\\nobservablesOut = []\\n\\nfor observableKey in observablesReturned:\\n  observable = observablesReturned[observableKey]\\n  \\n  if observable['clean_count'] == 0:\\n    observablesOut.append({\\n      'type': observable['type'],\\n      'value': observable['value']\\n    })\\n\\nobservablesOut = json.dumps(observablesOut)\",\n                      \"script_arguments\": [\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\",\n                        \"$activity.definition_activity_02I7SLXCFR8US2m984x9Ju1rg1Z0YDEUun0.output.variable_workflow_029824ANUJACZ0uBon29pn4OPF7PkXpbQM6$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"observablesOut\",\n                          \"script_query_name\": \"observablesOut\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXKCP0572NE4rY3mPCvcELDTyR53ld\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLXIIGWUR1ELLfDN9m3yMir2eewgkG0.output.script_queries.observablesOut$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLXLU9R2S2xGrqmoUEaGDgmcs0XHj3I\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Moderate or Noisy\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"moderate\"\n                    },\n                    \"operator\": \"or\",\n                    \"right_operand\": {\n                      \"left_operand\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG36EW63idWgtbMVyCBu094Ufp8D$\",\n                      \"operator\": \"eqi\",\n                      \"right_operand\": \"noisy\"\n                    }\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Moderate or Noisy\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXNIZFED1301LobMg5PSDvCgdLMdIR\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Set local variable\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Set local variable\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].observables$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP\",\n            \"name\": \"Execute Python Script\",\n            \"title\": \"Build the request payload\",\n            \"type\": \"python3.script\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"action_timeout\": 180,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Build the request payload\",\n              \"script\": \"import sys\\nimport json\\nfrom datetime import datetime, timedelta\\n\\nobservableType = sys.argv[1]\\nobservables = json.loads(sys.argv[2])\\nintegrations = json.loads(sys.argv[3])\\n\\nnow = datetime.now()\\nthirtyDaysAgo = now - timedelta(days=30)\\n\\npayload = {\\n  \\\"observables\\\": observables,\\n  \\\"modules\\\": integrations[observableType],\\n  \\\"time_window\\\": {\\n    \\\"start_time\\\": thirtyDaysAgo.isoformat(),\\n    \\\"end_time\\\": now.isoformat()\\n  },\\n  \\\"source\\\": \\\"Cisco XDR Automated Question\\\",\\n  \\\"title\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\",\\n  \\\"description\\\": \\\"Automated investigation for \\\" + str(len(observables)) + \\\" \\\" + observableType + \\\" observables\\\"\\n}\\n\\npayload = json.dumps(payload)\",\n              \"script_arguments\": [\n                \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\",\n                \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2HWI48YbsBhzkzvZ4gpadrMUyn$\",\n                \"$activity.definition_activity_02I7SLX01VIT62ks2ASqfP2szCkqP4niOfw.output.script_queries.integrationsOut$\"\n              ],\n              \"script_queries\": [\n                {\n                  \"script_query\": \"payload\",\n                  \"script_query_name\": \"payload\",\n                  \"script_query_type\": \"string\"\n                }\n              ],\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK\",\n            \"name\": \"HTTP Request\",\n            \"title\": \"Create the investigation\",\n            \"type\": \"web-service.http_request\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"accept\": \"application/json\",\n              \"action_timeout\": 180,\n              \"allow_auto_redirect\": true,\n              \"allow_headers_redirect\": false,\n              \"body\": \"$activity.definition_activity_02I7SLXOZY1700CSSITXri44FMPxRA5OdmP.output.script_queries.payload$\",\n              \"content_type\": \"application/json\",\n              \"continue_on_error_status_code\": true,\n              \"continue_on_failure\": false,\n              \"display_name\": \"Create the investigation\",\n              \"method\": \"POST\",\n              \"relative_url\": \"/v2/investigation\",\n              \"runtime_user\": {\n                \"target_default\": true\n              },\n              \"skip_execution\": false,\n              \"target\": {\n                \"override_workflow_target_group_criteria\": true,\n                \"target_group\": {\n                  \"run_on_all_targets\": false,\n                  \"use_criteria\": {\n                    \"choose_target_using_algorithm\": \"choose_first_with_matching_criteria\",\n                    \"conditions\": [\n                      {\n                        \"left_operand\": \"$targetgroup.web-service endpoint.input.display_name$\",\n                        \"operator\": \"eqi\",\n                        \"right_operand\": \"Conure APIs\"\n                      }\n                    ]\n                  }\n                }\n              }\n            },\n            \"object_type\": \"definition_activity\"\n          },\n          {\n            \"unique_name\": \"definition_activity_02I7SLXS78SY95mkGqRGILc8NX3ILgj2cVe\",\n            \"name\": \"Condition Block\",\n            \"title\": \"Was the request successful?\",\n            \"type\": \"logic.if_else\",\n            \"base_type\": \"activity\",\n            \"properties\": {\n              \"conditions\": [],\n              \"continue_on_failure\": false,\n              \"display_name\": \"Was the request successful?\",\n              \"skip_execution\": false\n            },\n            \"object_type\": \"definition_activity\",\n            \"blocks\": [\n              {\n                \"unique_name\": \"definition_activity_02I7SLXTEUOH118hLb2L01dnNdNZ4NfaetT\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"200/Success\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"200/Success\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4\",\n                    \"name\": \"JSONPath Query\",\n                    \"title\": \"Extract the investigation ID\",\n                    \"type\": \"corejava.jsonpathquery\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": true,\n                      \"display_name\": \"Extract the investigation ID\",\n                      \"input_json\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"jsonpath_queries\": [\n                        {\n                          \"jsonpath_query\": \"$.investigation_id\",\n                          \"jsonpath_query_name\": \"investigationId\",\n                          \"jsonpath_query_type\": \"string\",\n                          \"zdate_type_format\": \"yyyy-MM-dd'T'HH:mm:ssZ\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLXWLN6046008yoGxYyIUsDbUMgQXdy\",\n                    \"name\": \"Condition Block\",\n                    \"title\": \"Was extraction successful?\",\n                    \"type\": \"logic.if_else\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"conditions\": [],\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Was extraction successful?\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\",\n                    \"blocks\": [\n                      {\n                        \"unique_name\": \"definition_activity_02I7SLXXXF0WB34BuPx5fVPlrD7gdTw2hDt\",\n                        \"name\": \"Condition Branch\",\n                        \"title\": \"No\",\n                        \"type\": \"logic.condition_block\",\n                        \"base_type\": \"activity\",\n                        \"properties\": {\n                          \"condition\": {\n                            \"left_operand\": \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.succeeded$\",\n                            \"operator\": \"eq\",\n                            \"right_operand\": false\n                          },\n                          \"continue_on_failure\": false,\n                          \"display_name\": \"No\",\n                          \"skip_execution\": false\n                        },\n                        \"object_type\": \"definition_activity\",\n                        \"actions\": [\n                          {\n                            \"unique_name\": \"definition_activity_02I7SLXZEZ6AI4pKeCQuKJnCkKx8FE2JpA7\",\n                            \"name\": \"Completed\",\n                            \"title\": \"Failed\",\n                            \"type\": \"logic.completed\",\n                            \"base_type\": \"activity\",\n                            \"properties\": {\n                              \"completion_type\": \"failed-completed\",\n                              \"continue_on_failure\": false,\n                              \"display_name\": \"Failed\",\n                              \"result_message\": \"Failed to extract the investigation ID\\n\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                              \"skip_execution\": false\n                            },\n                            \"object_type\": \"definition_activity\"\n                          }\n                        ]\n                      }\n                    ]\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH\",\n                    \"name\": \"Execute Python Script\",\n                    \"title\": \"Add the investigation ID to the list\",\n                    \"type\": \"python3.script\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"action_timeout\": 180,\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Add the investigation ID to the list\",\n                      \"script\": \"import sys\\nimport json\\n\\ninvestigationIds = sys.argv[1]\\ninvestigationId = sys.argv[2]\\nobservableType = sys.argv[3]\\n\\nif len(investigationIds) \u003e 0:\\n  investigationIds = json.loads(investigationIds)\\nelse:\\n  investigationIds = []\\n\\n#investigationIds.append({\\n#  'observableType': observableType,\\n#  'investigationId': investigationId\\n#})\\n\\ninvestigationIds.append(investigationId)\\n\\ninvestigationIds = json.dumps(investigationIds)\",\n                      \"script_arguments\": [\n                        \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                        \"$activity.definition_activity_02I7SLXV4O7RR2uK120umnBFB3YsAdlPCu4.output.jsonpath_queries.investigationId$\",\n                        \"$activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$\"\n                      ],\n                      \"script_queries\": [\n                        {\n                          \"script_query\": \"investigationIds\",\n                          \"script_query_name\": \"investigationIds\",\n                          \"script_query_type\": \"string\"\n                        }\n                      ],\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  },\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY2ENE416OU6KhOPdPLTp93d4amZVq\",\n                    \"name\": \"Set Variables\",\n                    \"title\": \"Update local variables\",\n                    \"type\": \"core.set_multiple_variables\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Update local variables\",\n                      \"skip_execution\": false,\n                      \"variables_to_update\": [\n                        {\n                          \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.workflow_results$\",\n                          \"variable_value_new\": \"$activity.definition_activity_02I7SLY0I7WNF1vUXugIXVF6IsaBosEYYzH.output.script_queries.investigationIds$\"\n                        }\n                      ]\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              },\n              {\n                \"unique_name\": \"definition_activity_02I7SLY43PTBF1jjX8UaTLUPunvaqDDndNJ\",\n                \"name\": \"Condition Branch\",\n                \"title\": \"Anything else\",\n                \"type\": \"logic.condition_block\",\n                \"base_type\": \"activity\",\n                \"properties\": {\n                  \"condition\": {\n                    \"left_operand\": \"$activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\",\n                    \"operator\": \"ne\",\n                    \"right_operand\": 200\n                  },\n                  \"continue_on_failure\": false,\n                  \"display_name\": \"Anything else\",\n                  \"skip_execution\": false\n                },\n                \"object_type\": \"definition_activity\",\n                \"actions\": [\n                  {\n                    \"unique_name\": \"definition_activity_02I7SLY5PKXS13vSQ4qTIuoDQtvKMzpMoZD\",\n                    \"name\": \"Completed\",\n                    \"title\": \"Failed\",\n                    \"type\": \"logic.completed\",\n                    \"base_type\": \"activity\",\n                    \"properties\": {\n                      \"completion_type\": \"failed-completed\",\n                      \"continue_on_failure\": false,\n                      \"display_name\": \"Failed\",\n                      \"result_message\": \"Failed to create the investigation for $activity.definition_activity_02I7SLX722SQZ5qnd7Mk2oMX2Str2AI7FmV.input.source_array[@].type$ observables\\n\\nStatus code: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.status_code$\\nResponse body: $activity.definition_activity_02I7SLXQONEPR643szYLy5hKuXgxSwg0yWK.output.response_body$\",\n                      \"skip_execution\": false\n                    },\n                    \"object_type\": \"definition_activity\"\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"unique_name\": \"definition_activity_02I7SLY73GCYC58Rsn0tiazys08j048xxkX\",\n        \"name\": \"Set Variables\",\n        \"title\": \"Set file path\",\n        \"type\": \"core.set_multiple_variables\",\n        \"base_type\": \"activity\",\n        \"properties\": {\n          \"continue_on_failure\": false,\n          \"display_name\": \"Set file path\",\n          \"skip_execution\": false,\n          \"variables_to_update\": [\n            {\n              \"variable_to_update\": \"$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.local.variable_workflow_02I7SLWQG2QSU6S29vhMjFkAkDmq3zfPkYx$\",\n              \"variable_value_new\": \"chain_id=$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.input.variable_workflow_02I7SLWQG2YYY3c9nqBK1ZEtuiwfg8gYUyZ$/$workflow.definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC.output.instance_id$.json\"\n            }\n          ]\n        },\n        \"object_type\": \"definition_activity\"\n      }\n    ],\n    \"categories\": [\n      \"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf\"\n    ]\n  },\n  \"atomic_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ],\n  \"dependent_workflows\": [\n    \"definition_workflow_02HSRQ9SJD8SX2olZihv5ICOd5MggSxVfUD\",\n    \"definition_workflow_029824AN9OC6K34kBzqjL6SXC0s68449YGU\"\n  ]\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "Import Incident Analysis Workflow from TAC (Exp to Fail)",
          "method": "POST",
          "relative_url": "exchange/api/v1/workflows/import?create_new=true\u0026overwrite=false\u0026workflow_unique_name=definition_workflow_02I7SLWPWTELD4xowUQOLkKNMOLrmPHu9QC",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I835W4H5PFR7Co5aIv56ZOItcaN9PB7x1",
        "name": "HTTP Request",
        "title": "Create Incident Analysis Workflow from Admin (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n    \"type\": \"template_workflow.incident_analysis\",\n    \"base_type\": \"template_workflow\",\n    \"properties\": {\n        \"workflow\": {\n            \"display_name\": \"inc-analysis-admin-wf-$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.output.instance_id$\"\n        }\n    }\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "Create Incident Analysis Workflow from Admin (Exp to Fail)",
          "method": "POST",
          "relative_url": "/api/v2/workflows",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I836G6NU04O22883RIXlBjWwF5VMdtFOB",
        "name": "HTTP Request",
        "title": "Create Incident Analysis Workflow from TAC (Exp to Fail)",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "body": "{\n    \"type\": \"template_workflow.incident_analysis\",\n    \"base_type\": \"template_workflow\",\n    \"properties\": {\n        \"workflow\": {\n            \"display_name\": \"inc-analysis-TAC-wf-$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.output.instance_id$\"\n        }\n    }\n}",
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "Create Incident Analysis Workflow from TAC (Exp to Fail)",
          "method": "POST",
          "relative_url": "/api/v2/workflows",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH9N5O37JM497g0HLA4V0yAUkAdPWqiL",
        "name": "HTTP Request",
        "title": "Run Created Workflow from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Run Created Workflow from Content Admin",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH9SGTXRO06ZPfeCNfEeqyaw3OcL2YOW",
        "name": "HTTP Request",
        "title": "Run Created Workflow from Tac User",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "Run Created Workflow from Tac User",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IAH9YAHB1TF4lCHjXbRXcx2H8AEIRans4",
        "name": "HTTP Request",
        "title": "Run Created Workflow from Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "Run Created Workflow from Admin",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83BQIWON6I0YdysdEyv7FvcWV20Jz3l2",
        "name": "HTTP Request",
        "title": "Run Import Workflow from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Run Import Workflow from Content Admin",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83D6M24MWI4kZr0D8LV3QnejVvfMFVOf",
        "name": "HTTP Request",
        "title": "Run Import Workflow from TAC User",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I83404YAQ323vgA8h7rJmfSVazCWYqYBu$"
            }
          ],
          "display_name": "Run Import Workflow from TAC User",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83DFLPY4Z65EHRew64jYnGmLrtHd4lZO",
        "name": "HTTP Request",
        "title": "Run Import Workflow from Admin User",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833HTAVHFY6PeP9b2UJICStCJg0ybyNe$"
            }
          ],
          "display_name": "Run Import Workflow from Admin User",
          "method": "POST",
          "relative_url": "/api/v1.1/workflows/ui/start?workflow_id=$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83QJUKJUKW5vqchvIB7wPTfPaf0QLhbN",
        "name": "HTTP Request",
        "title": "Delete Import wf from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Delete Import wf from Content Admin",
          "method": "DELETE",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83CF69MTUI3DoKrrHAiPzmENZKgIKd9A.output.jsonpath_queries.Import_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02I83QSIJO4T24FAVmleAcHbCpkkUFLi0Mg",
        "name": "HTTP Request",
        "title": "Delete Created wf from Content Admin",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "allow_headers_redirect": false,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": true,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.local.variable_workflow_02I833A9P70B90jaPhyYwxPJ65x31g7iC5w$"
            }
          ],
          "display_name": "Delete Created wf from Content Admin",
          "method": "DELETE",
          "relative_url": "/api/v1/workflows/$activity.definition_activity_02I83R1IBQ6CF3uYwZa7pjKmuE0o9g21HfP.output.jsonpath_queries.Created_WF_ID$",
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target": true
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02IBF4MRGPJCT13eUhG6UXSEckl5l1tFnJE",
        "name": "Condition Block",
        "title": "Verify MVP Cases",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "conditions": [],
          "continue_on_failure": false,
          "display_name": "Verify MVP Cases",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02IBF4MRS3MWW3cS58RSA7tgmW3vuNbkzPa",
            "name": "Condition Branch",
            "title": "PassCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": {
                                                                    "left_operand": {
                                                                      "left_operand": {
                                                                        "left_operand": {
                                                                          "left_operand": {
                                                                            "left_operand": {
                                                                              "left_operand": {
                                                                                "left_operand": {
                                                                                  "left_operand": {
                                                                                    "left_operand": {
                                                                                      "left_operand": {
                                                                                        "left_operand": {
                                                                                          "left_operand": {
                                                                                            "left_operand": {
                                                                                              "left_operand": "$activity.definition_activity_02I8326M9YB6V1NxP47OdwRefzqLo5S1Zdc.output.error.code$",
                                                                                              "operator": "eq",
                                                                                              "right_operand": "200"
                                                                                            },
                                                                                            "operator": "and",
                                                                                            "right_operand": {
                                                                                              "left_operand": "$activity.definition_activity_02IAGD9A108II0oZfC9c1ggxj3WZ3oC5wgo.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                                              "operator": "eq",
                                                                                              "right_operand": "true"
                                                                                            }
                                                                                          },
                                                                                          "operator": "and",
                                                                                          "right_operand": {
                                                                                            "left_operand": "$activity.definition_activity_02IAH1KSGK26H49k12ap5jlbdSfO4vHadrk.output.error.code$",
                                                                                            "operator": "eq",
                                                                                            "right_operand": "200"
                                                                                          }
                                                                                        },
                                                                                        "operator": "and",
                                                                                        "right_operand": {
                                                                                          "left_operand": "$activity.definition_activity_02IAII9QJJNZX5HfPYrkjT2GaQfv6nn8gRA.output.error.code$",
                                                                                          "operator": "eq",
                                                                                          "right_operand": "200"
                                                                                        }
                                                                                      },
                                                                                      "operator": "and",
                                                                                      "right_operand": {
                                                                                        "left_operand": "$activity.definition_activity_02IAH3UDX20TQ0Rw8lNaRlXXxGM5UBpGpmx.output.error.code$",
                                                                                        "operator": "eq",
                                                                                        "right_operand": "200"
                                                                                      }
                                                                                    },
                                                                                    "operator": "and",
                                                                                    "right_operand": {
                                                                                      "left_operand": "$activity.definition_activity_02IAH7HKZGST80LJG2nJgrTIa9j73s633L0.output.error.code$",
                                                                                      "operator": "eq",
                                                                                      "right_operand": "200"
                                                                                    }
                                                                                  },
                                                                                  "operator": "and",
                                                                                  "right_operand": {
                                                                                    "left_operand": "$activity.definition_activity_02IB7AEK6A8NJ2G5fFMD059TOXWArIrVaQa.output.error.code$",
                                                                                    "operator": "eq",
                                                                                    "right_operand": "200"
                                                                                  }
                                                                                },
                                                                                "operator": "and",
                                                                                "right_operand": {
                                                                                  "left_operand": "$activity.definition_activity_02IAGGPKT35F64CjouHi5BSsvRzYxZwoJHI.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                                  "operator": "eq",
                                                                                  "right_operand": "true"
                                                                                }
                                                                              },
                                                                              "operator": "and",
                                                                              "right_operand": {
                                                                                "left_operand": "$activity.definition_activity_02IB7X4XPEA2A52kxs4hP356lQ8qqYKEkD1.output.error.code$",
                                                                                "operator": "eq",
                                                                                "right_operand": "200"
                                                                              }
                                                                            },
                                                                            "operator": "and",
                                                                            "right_operand": {
                                                                              "left_operand": "$activity.definition_activity_02IB7X8WYB25V5fH5ePCMoopzthYBfuZtpy.output.error.code$",
                                                                              "operator": "eq",
                                                                              "right_operand": "403"
                                                                            }
                                                                          },
                                                                          "operator": "and",
                                                                          "right_operand": {
                                                                            "left_operand": "$activity.definition_activity_02IB7X8WYB25V5fH5ePCMoopzthYBfuZtpy.output.error.message$",
                                                                            "operator": "mw",
                                                                            "right_operand": "Forbidden"
                                                                          }
                                                                        },
                                                                        "operator": "and",
                                                                        "right_operand": {
                                                                          "left_operand": "$activity.definition_activity_02IB7WI2LIS6W3lPE9Ys1SjANB241WSDrBw.output.error.code$",
                                                                          "operator": "eq",
                                                                          "right_operand": "200"
                                                                        }
                                                                      },
                                                                      "operator": "and",
                                                                      "right_operand": {
                                                                        "left_operand": "$activity.definition_activity_02IAGQKX1N0FN4KA96aJ5oXA5anPZyRBTHF.output.error.code$",
                                                                        "operator": "eq",
                                                                        "right_operand": "200"
                                                                      }
                                                                    },
                                                                    "operator": "and",
                                                                    "right_operand": {
                                                                      "left_operand": "$activity.definition_activity_02IAGELU2ZY936ppJmHfcTqS3QNFODHRQ1T.output.error.code$",
                                                                      "operator": "eq",
                                                                      "right_operand": "200"
                                                                    }
                                                                  },
                                                                  "operator": "and",
                                                                  "right_operand": {
                                                                    "left_operand": "$activity.definition_activity_02IB7Z80AXVLO5J0T7nH5okl7uy6yK8PNhc.output.error.code$",
                                                                    "operator": "eq",
                                                                    "right_operand": "200"
                                                                  }
                                                                },
                                                                "operator": "and",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02IB801GN7F8W1NG4UiZjjpjHVj6l9KsAd7.output.error.code$",
                                                                  "operator": "eq",
                                                                  "right_operand": "200"
                                                                }
                                                              },
                                                              "operator": "and",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02IB80CPAWRD73yonxDt64p4TbWkcBe4iYi.output.error.code$",
                                                                "operator": "eq",
                                                                "right_operand": "403"
                                                              }
                                                            },
                                                            "operator": "and",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02IB80CPAWRD73yonxDt64p4TbWkcBe4iYi.output.error.message$",
                                                              "operator": "mw",
                                                              "right_operand": "Forbidden"
                                                            }
                                                          },
                                                          "operator": "and",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02I83732NNNIA7AwEmUUtxzko1lGdzGBcMI.output.error.code$",
                                                            "operator": "eq",
                                                            "right_operand": "200"
                                                          }
                                                        },
                                                        "operator": "and",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02I83MRMZ8SAH42aqFt8CxGRQy77psFtkag.output.error.code$",
                                                          "operator": "eq",
                                                          "right_operand": "200"
                                                        }
                                                      },
                                                      "operator": "and",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02I83OOFGIUG33awzr8vvSikhgLPQ97ccOH.output.error.code$",
                                                        "operator": "eq",
                                                        "right_operand": "200"
                                                      }
                                                    },
                                                    "operator": "and",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02I83P8ZXKSNS55XAYTJY0x6gCYfXEr3aaN.output.error.code$",
                                                      "operator": "eq",
                                                      "right_operand": "403"
                                                    }
                                                  },
                                                  "operator": "and",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02I83P8ZXKSNS55XAYTJY0x6gCYfXEr3aaN.output.error.message$",
                                                    "operator": "mw",
                                                    "right_operand": "Forbidden"
                                                  }
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02I83PGJ03Z3M4dedegpZjsVhRZ8KC1s7XN.output.error.code$",
                                                  "operator": "eq",
                                                  "right_operand": "200"
                                                }
                                              },
                                              "operator": "and",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02I83NS3A2SC15BEU9VRa1Vo7jm010dxlGJ.output.error.code$",
                                                "operator": "eq",
                                                "right_operand": "400"
                                              }
                                            },
                                            "operator": "and",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02I83NS3A2SC15BEU9VRa1Vo7jm010dxlGJ.output.error.message$",
                                              "operator": "mw",
                                              "right_operand": "Workflows with Incident Analysis intents are not allowed to be created, updated or deleted"
                                            }
                                          },
                                          "operator": "and",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02I83Q4KYK8PV1oP39By1PFbfsBqKpQ3euj.output.error.code$",
                                            "operator": "eq",
                                            "right_operand": "400"
                                          }
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02I83Q4KYK8PV1oP39By1PFbfsBqKpQ3euj.output.error.message$",
                                          "operator": "mw",
                                          "right_operand": "Workflows with Incident Analysis intents are not allowed to be created, updated or deleted"
                                        }
                                      },
                                      "operator": "and",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02I835W4H5PFR7Co5aIv56ZOItcaN9PB7x1.output.error.code$",
                                        "operator": "eq",
                                        "right_operand": "403"
                                      }
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02I835W4H5PFR7Co5aIv56ZOItcaN9PB7x1.output.error.message$",
                                      "operator": "mw",
                                      "right_operand": "Forbidden"
                                    }
                                  },
                                  "operator": "and",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02I836G6NU04O22883RIXlBjWwF5VMdtFOB.output.error.code$",
                                    "operator": "eq",
                                    "right_operand": "403"
                                  }
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02I836G6NU04O22883RIXlBjWwF5VMdtFOB.output.error.message$",
                                  "operator": "mw",
                                  "right_operand": "Forbidden"
                                }
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02IAH9N5O37JM497g0HLA4V0yAUkAdPWqiL.output.error.code$",
                                "operator": "eq",
                                "right_operand": "200"
                              }
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02IAH9SGTXRO06ZPfeCNfEeqyaw3OcL2YOW.output.error.code$",
                              "operator": "eq",
                              "right_operand": "200"
                            }
                          },
                          "operator": "and",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02IAH9YAHB1TF4lCHjXbRXcx2H8AEIRans4.output.error.code$",
                            "operator": "eq",
                            "right_operand": "200"
                          }
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02I83BQIWON6I0YdysdEyv7FvcWV20Jz3l2.output.error.code$",
                          "operator": "eq",
                          "right_operand": "200"
                        }
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02I83D6M24MWI4kZr0D8LV3QnejVvfMFVOf.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02I83DFLPY4Z65EHRew64jYnGmLrtHd4lZO.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$activity.definition_activity_02I83QJUKJUKW5vqchvIB7wPTfPaf0QLhbN.output.error.code$",
                    "operator": "eq",
                    "right_operand": "200"
                  }
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$activity.definition_activity_02I83QSIJO4T24FAVmleAcHbCpkkUFLi0Mg.output.error.code$",
                  "operator": "eq",
                  "right_operand": "200"
                }
              },
              "continue_on_failure": false,
              "display_name": "PassCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02I850I5UDDOL3uZmQKquZk3BRlZ83tNYxS",
                "name": "Set Variables",
                "title": "PassCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "PassCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.output.variable_workflow_02I857O440CKM0dmvi98h6gPFFcK5Ip41zE$",
                      "variable_value_new": "Pass"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02IBH9XAP03IV6046BcuJXyM9WfYR9EC1O6",
            "name": "Condition Branch",
            "title": "FailCase",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": {
                            "left_operand": {
                              "left_operand": {
                                "left_operand": {
                                  "left_operand": {
                                    "left_operand": {
                                      "left_operand": {
                                        "left_operand": {
                                          "left_operand": {
                                            "left_operand": {
                                              "left_operand": {
                                                "left_operand": {
                                                  "left_operand": {
                                                    "left_operand": {
                                                      "left_operand": {
                                                        "left_operand": {
                                                          "left_operand": {
                                                            "left_operand": {
                                                              "left_operand": {
                                                                "left_operand": {
                                                                  "left_operand": {
                                                                    "left_operand": {
                                                                      "left_operand": {
                                                                        "left_operand": {
                                                                          "left_operand": {
                                                                            "left_operand": {
                                                                              "left_operand": {
                                                                                "left_operand": {
                                                                                  "left_operand": {
                                                                                    "left_operand": {
                                                                                      "left_operand": {
                                                                                        "left_operand": {
                                                                                          "left_operand": {
                                                                                            "left_operand": {
                                                                                              "left_operand": "$activity.definition_activity_02I8326M9YB6V1NxP47OdwRefzqLo5S1Zdc.output.error.code$",
                                                                                              "operator": "ne",
                                                                                              "right_operand": "200"
                                                                                            },
                                                                                            "operator": "or",
                                                                                            "right_operand": {
                                                                                              "left_operand": "$activity.definition_activity_02IAGD9A108II0oZfC9c1ggxj3WZ3oC5wgo.output.variable_workflow_01TNRGULATQQV6FYTr3qQGjSdO5JnudAeD5$",
                                                                                              "operator": "ne",
                                                                                              "right_operand": "true"
                                                                                            }
                                                                                          },
                                                                                          "operator": "or",
                                                                                          "right_operand": {
                                                                                            "left_operand": "$activity.definition_activity_02IAH1KSGK26H49k12ap5jlbdSfO4vHadrk.output.error.code$",
                                                                                            "operator": "ne",
                                                                                            "right_operand": "200"
                                                                                          }
                                                                                        },
                                                                                        "operator": "or",
                                                                                        "right_operand": {
                                                                                          "left_operand": "$activity.definition_activity_02IAII9QJJNZX5HfPYrkjT2GaQfv6nn8gRA.output.error.code$",
                                                                                          "operator": "ne",
                                                                                          "right_operand": "200"
                                                                                        }
                                                                                      },
                                                                                      "operator": "or",
                                                                                      "right_operand": {
                                                                                        "left_operand": "$activity.definition_activity_02IAH3UDX20TQ0Rw8lNaRlXXxGM5UBpGpmx.output.error.code$",
                                                                                        "operator": "ne",
                                                                                        "right_operand": "200"
                                                                                      }
                                                                                    },
                                                                                    "operator": "or",
                                                                                    "right_operand": {
                                                                                      "left_operand": "$activity.definition_activity_02IAH7HKZGST80LJG2nJgrTIa9j73s633L0.output.error.code$",
                                                                                      "operator": "ne",
                                                                                      "right_operand": "200"
                                                                                    }
                                                                                  },
                                                                                  "operator": "or",
                                                                                  "right_operand": {
                                                                                    "left_operand": "$activity.definition_activity_02IB7AEK6A8NJ2G5fFMD059TOXWArIrVaQa.output.error.code$",
                                                                                    "operator": "ne",
                                                                                    "right_operand": "200"
                                                                                  }
                                                                                },
                                                                                "operator": "or",
                                                                                "right_operand": {
                                                                                  "left_operand": "$activity.definition_activity_02IAGGPKT35F64CjouHi5BSsvRzYxZwoJHI.output.variable_workflow_026R3MTZOTY3X2eRCIpAVCPmZQ3fzHbYr3R$",
                                                                                  "operator": "ne",
                                                                                  "right_operand": "true"
                                                                                }
                                                                              },
                                                                              "operator": "or",
                                                                              "right_operand": {
                                                                                "left_operand": "$activity.definition_activity_02IB7X4XPEA2A52kxs4hP356lQ8qqYKEkD1.output.error.code$",
                                                                                "operator": "ne",
                                                                                "right_operand": "200"
                                                                              }
                                                                            },
                                                                            "operator": "or",
                                                                            "right_operand": {
                                                                              "left_operand": "$activity.definition_activity_02IB7X8WYB25V5fH5ePCMoopzthYBfuZtpy.output.error.code$",
                                                                              "operator": "ne",
                                                                              "right_operand": "403"
                                                                            }
                                                                          },
                                                                          "operator": "or",
                                                                          "right_operand": {
                                                                            "left_operand": "$activity.definition_activity_02IB7X8WYB25V5fH5ePCMoopzthYBfuZtpy.output.error.message$",
                                                                            "operator": "nmw",
                                                                            "right_operand": "Forbidden"
                                                                          }
                                                                        },
                                                                        "operator": "or",
                                                                        "right_operand": {
                                                                          "left_operand": "$activity.definition_activity_02IB7WI2LIS6W3lPE9Ys1SjANB241WSDrBw.output.error.code$",
                                                                          "operator": "ne",
                                                                          "right_operand": "200"
                                                                        }
                                                                      },
                                                                      "operator": "or",
                                                                      "right_operand": {
                                                                        "left_operand": "$activity.definition_activity_02IAGQKX1N0FN4KA96aJ5oXA5anPZyRBTHF.output.error.code$",
                                                                        "operator": "ne",
                                                                        "right_operand": "200"
                                                                      }
                                                                    },
                                                                    "operator": "or",
                                                                    "right_operand": {
                                                                      "left_operand": "$activity.definition_activity_02IAGELU2ZY936ppJmHfcTqS3QNFODHRQ1T.output.error.code$",
                                                                      "operator": "ne",
                                                                      "right_operand": "200"
                                                                    }
                                                                  },
                                                                  "operator": "or",
                                                                  "right_operand": {
                                                                    "left_operand": "$activity.definition_activity_02IB7Z80AXVLO5J0T7nH5okl7uy6yK8PNhc.output.error.code$",
                                                                    "operator": "ne",
                                                                    "right_operand": "200"
                                                                  }
                                                                },
                                                                "operator": "or",
                                                                "right_operand": {
                                                                  "left_operand": "$activity.definition_activity_02IB801GN7F8W1NG4UiZjjpjHVj6l9KsAd7.output.error.code$",
                                                                  "operator": "ne",
                                                                  "right_operand": "200"
                                                                }
                                                              },
                                                              "operator": "or",
                                                              "right_operand": {
                                                                "left_operand": "$activity.definition_activity_02IB80CPAWRD73yonxDt64p4TbWkcBe4iYi.output.error.code$",
                                                                "operator": "ne",
                                                                "right_operand": "403"
                                                              }
                                                            },
                                                            "operator": "or",
                                                            "right_operand": {
                                                              "left_operand": "$activity.definition_activity_02IB80CPAWRD73yonxDt64p4TbWkcBe4iYi.output.error.message$",
                                                              "operator": "nmw",
                                                              "right_operand": "Forbidden"
                                                            }
                                                          },
                                                          "operator": "or",
                                                          "right_operand": {
                                                            "left_operand": "$activity.definition_activity_02I83732NNNIA7AwEmUUtxzko1lGdzGBcMI.output.error.code$",
                                                            "operator": "ne",
                                                            "right_operand": "200"
                                                          }
                                                        },
                                                        "operator": "or",
                                                        "right_operand": {
                                                          "left_operand": "$activity.definition_activity_02I83MRMZ8SAH42aqFt8CxGRQy77psFtkag.output.error.code$",
                                                          "operator": "ne",
                                                          "right_operand": "200"
                                                        }
                                                      },
                                                      "operator": "or",
                                                      "right_operand": {
                                                        "left_operand": "$activity.definition_activity_02I83OOFGIUG33awzr8vvSikhgLPQ97ccOH.output.error.code$",
                                                        "operator": "ne",
                                                        "right_operand": "200"
                                                      }
                                                    },
                                                    "operator": "or",
                                                    "right_operand": {
                                                      "left_operand": "$activity.definition_activity_02I83P8ZXKSNS55XAYTJY0x6gCYfXEr3aaN.output.error.code$",
                                                      "operator": "ne",
                                                      "right_operand": "403"
                                                    }
                                                  },
                                                  "operator": "or",
                                                  "right_operand": {
                                                    "left_operand": "$activity.definition_activity_02I83P8ZXKSNS55XAYTJY0x6gCYfXEr3aaN.output.error.message$",
                                                    "operator": "nmw",
                                                    "right_operand": "Forbidden"
                                                  }
                                                },
                                                "operator": "or",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_02I83PGJ03Z3M4dedegpZjsVhRZ8KC1s7XN.output.error.code$",
                                                  "operator": "ne",
                                                  "right_operand": "200"
                                                }
                                              },
                                              "operator": "or",
                                              "right_operand": {
                                                "left_operand": "$activity.definition_activity_02I83NS3A2SC15BEU9VRa1Vo7jm010dxlGJ.output.error.code$",
                                                "operator": "ne",
                                                "right_operand": "400"
                                              }
                                            },
                                            "operator": "or",
                                            "right_operand": {
                                              "left_operand": "$activity.definition_activity_02I83NS3A2SC15BEU9VRa1Vo7jm010dxlGJ.output.error.message$",
                                              "operator": "nmw",
                                              "right_operand": "Workflows with Incident Analysis intents are not allowed to be created, updated or deleted"
                                            }
                                          },
                                          "operator": "or",
                                          "right_operand": {
                                            "left_operand": "$activity.definition_activity_02I83Q4KYK8PV1oP39By1PFbfsBqKpQ3euj.output.error.code$",
                                            "operator": "ne",
                                            "right_operand": "400"
                                          }
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_02I83Q4KYK8PV1oP39By1PFbfsBqKpQ3euj.output.error.message$",
                                          "operator": "nmw",
                                          "right_operand": "Workflows with Incident Analysis intents are not allowed to be created, updated or deleted"
                                        }
                                      },
                                      "operator": "or",
                                      "right_operand": {
                                        "left_operand": "$activity.definition_activity_02I835W4H5PFR7Co5aIv56ZOItcaN9PB7x1.output.error.code$",
                                        "operator": "ne",
                                        "right_operand": "403"
                                      }
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_02I835W4H5PFR7Co5aIv56ZOItcaN9PB7x1.output.error.message$",
                                      "operator": "nmw",
                                      "right_operand": "Forbidden"
                                    }
                                  },
                                  "operator": "or",
                                  "right_operand": {
                                    "left_operand": "$activity.definition_activity_02I836G6NU04O22883RIXlBjWwF5VMdtFOB.output.error.code$",
                                    "operator": "ne",
                                    "right_operand": "403"
                                  }
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_02I836G6NU04O22883RIXlBjWwF5VMdtFOB.output.error.message$",
                                  "operator": "nmw",
                                  "right_operand": "Forbidden"
                                }
                              },
                              "operator": "or",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_02IAH9N5O37JM497g0HLA4V0yAUkAdPWqiL.output.error.code$",
                                "operator": "ne",
                                "right_operand": "200"
                              }
                            },
                            "operator": "or",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_02IAH9SGTXRO06ZPfeCNfEeqyaw3OcL2YOW.output.error.code$",
                              "operator": "ne",
                              "right_operand": "200"
                            }
                          },
                          "operator": "or",
                          "right_operand": {
                            "left_operand": "$activity.definition_activity_02IAH9YAHB1TF4lCHjXbRXcx2H8AEIRans4.output.error.code$",
                            "operator": "ne",
                            "right_operand": "200"
                          }
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_02I83BQIWON6I0YdysdEyv7FvcWV20Jz3l2.output.error.code$",
                          "operator": "ne",
                          "right_operand": "200"
                        }
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02I83D6M24MWI4kZr0D8LV3QnejVvfMFVOf.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02I83DFLPY4Z65EHRew64jYnGmLrtHd4lZO.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "operator": "or",
                  "right_operand": {
                    "left_operand": "$activity.definition_activity_02I83QJUKJUKW5vqchvIB7wPTfPaf0QLhbN.output.error.code$",
                    "operator": "ne",
                    "right_operand": "200"
                  }
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$activity.definition_activity_02I83QSIJO4T24FAVmleAcHbCpkkUFLi0Mg.output.error.code$",
                  "operator": "ne",
                  "right_operand": "200"
                }
              },
              "continue_on_failure": false,
              "display_name": "FailCase",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02IBH9XAP2AN60t0ip72OiM4UWthrIaaGKj",
                "name": "Set Variables",
                "title": "FailCase",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "FailCase",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02I82VOIZ71HD0A6Bku07tHUOhrYHbzZ9LM.output.variable_workflow_02I857O440CKM0dmvi98h6gPFFcK5Ip41zE$",
                      "variable_value_new": "Fail"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02I850SMWA21B4AeVZKeVyEB24oxVQmspvG",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "targets": {
    "definition_target_02CJRFC3P3FC304KnTutXoejdmZDYNUMkJR": {
      "unique_name": "definition_target_02CJRFC3P3FC304KnTutXoejdmZDYNUMkJR",
      "name": "Automation API Custom",
      "title": "Automation API Custom",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "",
        "disable_certificate_validation": true,
        "display_name": "Automation API Custom",
        "host": "automate.test.iroh.site",
        "ignore_proxy": true,
        "no_runtime_user": true,
        "protocol": "https"
      }
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
        "name": "SXO- Create Token-Generate Token",
        "title": "SXO- Create Token-Generate Token",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "client-secret",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Fail",
              "scope": "output",
              "name": "Token Generation Status",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02DJBM55OAE734oLfvIKzE4MxFyiXIrVcYR",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "token",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "client_id",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false,
              "variable_string_format": ""
            },
            "unique_name": "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "description": "This WF Used Generate Token for Tenant Using Client ID and Client Secret",
          "display_name": "SXO- Create Token-Generate Token",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$",
            "execute_on_workflow_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD",
            "name": "HTTP Request",
            "title": "Create token",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "client_secret=$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.input.variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4$\u0026grant_type=client_credentials\u0026client_id=$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.input.variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7$",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ],
              "display_name": "Create token",
              "method": "POST",
              "relative_url": "/oauth2/token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV",
            "name": "JSONPath Query",
            "title": "Get Token",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Get Token",
              "input_json": "$activity.definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.access_token",
                  "jsonpath_query_name": "token",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02BC75G4HIDLS4gLpshXHmYqx7felpNEF3o",
            "name": "Set Variables",
            "title": "Set token output variable to generated token",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Set token output variable to generated token",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                  "variable_value_new": "$activity.definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV.output.jsonpath_queries.token$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02DJBMAELR6VK7CssqESkx4t4o9vPm3Zq6Q",
            "name": "Condition Block",
            "title": "Verify Token Generation",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Verify Token Generation",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02DJBMAESCT805PwD1svfBaW7TxxRzXFyzr",
                "name": "Condition Branch",
                "title": "Pass Case",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV.output.error.code$",
                        "operator": "eq",
                        "right_operand": "200"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02BC75G4HIDLS4gLpshXHmYqx7felpNEF3o.output.error.code$",
                      "operator": "eq",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Pass Case",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02DJBNQ2F3PNZ0AKjBx061Nt1mgaPTGY3IK",
                    "name": "Set Variables",
                    "title": "PassCase",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "PassCase",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.output.variable_workflow_02DJBM55OAE734oLfvIKzE4MxFyiXIrVcYR$",
                          "variable_value_new": "Pass"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02DJBO37G1DKK2Wz94WUSToBiRzqwf6nJp4",
                "name": "Condition Branch",
                "title": "Fail Case",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV.output.error.code$",
                        "operator": "ne",
                        "right_operand": "200"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_02BC75G4HIDLS4gLpshXHmYqx7felpNEF3o.output.error.code$",
                      "operator": "ne",
                      "right_operand": "200"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Fail Case",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02DJO4X2EUMJR6ZKxfWWb3fyUYJHxSkucwM",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa"
  ],
  "dependent_workflows": [
    "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
    "definition_workflow_01TNRGUJTQ00K5a18OTctGAj8Qtrns7cITI",
    "definition_workflow_026R3MTZDNXS11nSJ26lq1HDCDh5bTUboMa"
  ],
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:iroh_api",
      "proxy_endpoint_metadata_id": "platform-apis"
    }
  ]
}