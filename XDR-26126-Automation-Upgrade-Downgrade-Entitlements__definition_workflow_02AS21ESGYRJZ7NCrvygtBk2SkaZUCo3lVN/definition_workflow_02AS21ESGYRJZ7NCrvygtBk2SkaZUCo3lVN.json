{
  "workflow": {
    "unique_name": "definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN",
    "name": "XDR-26126-Automation-Upgrade/Downgrade Entitlements",
    "title": "XDR-26126-Automation-Upgrade/Downgrade Entitlements",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjJscmNidExVeUI3aFRVQ0JGTVpvWU9VeTZTWThIeWJVNzBXVkk2ZzdaYmsifQ.eyJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvZW1haWwiOiJ2c3BhbmNoYStwbGF0Zm9ybUBjaXNjby5jb20iLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvaWRwL2lkIjoic3hzbyIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvdXNlci9uaWNrIjoiVmluYXkgUCIsImVtYWlsIjoidnNwYW5jaGErcGxhdGZvcm1AY2lzY28uY29tIiwiYXVkIjpbImlyb2gtdWkiLCJsb2dpbiJdLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvcm9sZSI6ImFkbWluIiwic3ViIjoiODdiN2MwMWQtMGE2Mi00OGYzLTk2ZTktNjQ1MDc5Nzc5ODk1IiwiaXNzIjoiSVJPSCBBdXRoIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vYXV0aC9yZWZyZXNoLXRva2VuLWp0aSI6InJlZnJlc2gtNjM3YTEzNTYtZjQyNi00YTZkLWFhZTYtYjczYTM0ODg4MGRiIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9zY29wZXMiOlsiaXJvaC1hZG1pbiIsImV2ZW50OnJlYWQiLCJpbnNpZ2h0cyIsInZhdWx0L2NvbmZpZ3M6cmVhZCIsImludGVncmF0aW9uIiwicHJpdmF0ZS1pbnRlbCIsImFkbWluIiwicHJvZmlsZSIsImluc3BlY3QiLCJhc3NldCIsImZlZWRiYWNrIiwiaXJvaC1tYXN0ZXIiLCJzc2UiLCJyZWdpc3RyeSIsInVzZXJzIiwiaW52ZXN0aWdhdGlvbiIsImNpc2NvIiwiaW52aXRlIiwicGxheWJvb2siLCJjYXNlYm9vayIsInZhdWx0L2NvbmZpZy9tZXRhZGF0YTpyZWFkIiwib3JiaXRhbCIsImVucmljaCIsIm9hdXRoIiwiZ2xvYmFsLWludGVsIiwiY29sbGVjdCIsInJlc3BvbnNlIiwidWktc2V0dGluZ3MiLCJ0ZWxlbWV0cnk6d3JpdGUiLCJvcGVuaWQiLCJub3RpZmljYXRpb24iLCJ3ZWJob29rIiwidmF1bHQvY29uZmlnL3Bvc3R1cmU6cmVhZCIsImFvIl0sImV4cCI6MTcwMjcwNzcwNywiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vYXV0aC9jbGllbnQvbmFtZSI6IlRocmVhdCBSZXNwb25zZSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb2F1dGgvdXNlci9pZCI6Ijg3YjdjMDFkLTBhNjItNDhmMy05NmU5LTY0NTA3OTc3OTg5NSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb3JnL2lkIjoiNjM0ODljZjktNTYxYy00OTU4LWExM2QtNmQ4NGI3ZWYwOWQ0IiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vYXV0aC9ncmFudCI6ImxvZ2luIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vcmcvbmFtZSI6IklST0giLCJqdGkiOiJ0b2tlbi04NTY2MjkyOS02NWE3LTQwMWMtYmYxYi00ZmI4M2E4NTgyMGUiLCJuYmYiOjE3MDI2MjEyNDcsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvdXNlci9uYW1lIjoiVmluYXkgUCIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvdXNlci9pZCI6Ijg3YjdjMDFkLTBhNjItNDhmMy05NmU5LTY0NTA3OTc3OTg5NSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb2F1dGgvY2xpZW50L2lkIjoiaXJvaC11aSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvdmVyc2lvbiI6InYyLjEwLWM2ZDljZmM4NTU3OTg2NTA1YjkxIiwiaWF0IjoxNzAyNjIxMzA3LCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL29hdXRoL2tpbmQiOiJzZXNzaW9uLXRva2VuIn0.Ho4xU4C-VW4Dd9eQo6B_NbsaQs9KBEujx6jBfdNumOAQWwZJeaRn3shs3MvGJbleZgmfkQgK0RQZggRTnJ8pB5fn1h0SLtOshN_4vTQEjfKodMWJeCz7lCmWnB6Z3qOCDPnV5N57j77cS3rLGRBFfkUtFHeXxsJgl8EhuuD_P9CTVT-GAc3WOtHc4duZEsSREgQfW9TbHzX4T7hbePApEz3xjFsFjH16Wr8xyRRZIO0xF86io6j1PSn_712KpD6yYC9IA0djfdnZnZBbtxAxEeoHldb2-dAN9pTw8y64PxkRRzOprjtb0lgSFruvtxPimK34RUvvzGchW-_SQ_A9a6Y4FP14tbzelaKUPa5nc-7LrGzZpiANvr9Sko8kXN5LwMKU-VGffwM7Qp6hljVhRF5byoyIdGGnSacOBC4aT2_aAmWal4F8Za-gdqYODdcPHF5qu1Q_cwSFhwd_z4oN5NzJ-vf82kVNiqzs0eCiGkxQpvehYykj3GI6W-wPUWhqeSpeuG0qDzIO4nPqjXetWSZXJYnrOMjQvqeDsjcAToC1xjgDjSDGR8O6P5vMVqQmCXmRB0YffGouHrKkI-XuRj2K22wejfV8IhiVBfh5ZtuOZMw3tv6ArnsdIQbS2txgYqf30-BUYfm5_0LHg3OqNxJO_QN7Ds7YDEfMqmmzgG0",
          "scope": "input",
          "name": "Provide token for Upgrade and Downgrade (should be IROH Tenant)",
          "type": "datatype.string",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02AS2FP8064XC4oZeZj0Vhgdxt3bYUjg6gW",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjJscmNidExVeUI3aFRVQ0JGTVpvWU9VeTZTWThIeWJVNzBXVkk2ZzdaYmsifQ.eyJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvZW1haWwiOiJ2c3BhbmNoYStlc3NlbnRpYWxzQGNpc2NvLmNvbSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvdXNlci9pZHAvaWQiOiJzeHNvIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy91c2VyL25pY2siOiJ2c3BhbmNoYSBlc3NlbnRpYWxzLVNhbmpheVRlbmFudChFeGlzdGluZykiLCJlbWFpbCI6InZzcGFuY2hhK2Vzc2VudGlhbHNAY2lzY28uY29tIiwiYXVkIjpbImlyb2gtdWkiLCJsb2dpbiJdLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvcm9sZSI6ImFkbWluIiwic3ViIjoiODcxYTAzYWYtY2UzYS00YjY5LWFjMmMtYjg3MzBiNDVjZjMyIiwiaXNzIjoiSVJPSCBBdXRoIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vYXV0aC9yZWZyZXNoLXRva2VuLWp0aSI6InJlZnJlc2gtY2M3YzhkNjgtOGQyMi00YzFjLWI5Y2UtNTk1ZWU2YWJhZDJiIiwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9zY29wZXMiOlsiZXZlbnQ6cmVhZCIsImNpc2NvL2ZlYXR1cmUtZmxhZy94ZHIiLCJpbnNpZ2h0cyIsInZhdWx0L2NvbmZpZ3M6cmVhZCIsImludGVncmF0aW9uIiwicHJpdmF0ZS1pbnRlbCIsImFkbWluIiwicHJvZmlsZSIsImluc3BlY3QiLCJhc3NldCIsImZlZWRiYWNrIiwic3NlIiwicmVnaXN0cnkiLCJ1c2VycyIsImludmVzdGlnYXRpb24iLCJpbnZpdGUiLCJwbGF5Ym9vayIsImNhc2Vib29rIiwidmF1bHQvY29uZmlnL21ldGFkYXRhOnJlYWQiLCJvcmJpdGFsIiwiZW5yaWNoIiwib2F1dGgiLCJjb2xsZWN0IiwicmVzcG9uc2UiLCJ1aS1zZXR0aW5ncyIsInRlbGVtZXRyeTp3cml0ZSIsIm9wZW5pZCIsIm5vdGlmaWNhdGlvbiIsImdsb2JhbC1pbnRlbDpyZWFkIiwid2ViaG9vayIsInZhdWx0L2NvbmZpZy9wb3N0dXJlOnJlYWQiLCJhbyJdLCJleHAiOjE3MDI3MDUxNTgsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb2F1dGgvY2xpZW50L25hbWUiOiJUaHJlYXQgUmVzcG9uc2UiLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL29hdXRoL3VzZXIvaWQiOiI4NzFhMDNhZi1jZTNhLTRiNjktYWMyYy1iODczMGI0NWNmMzIiLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL29yZy9pZCI6IjM4NzRiMjM5LTkzZWUtNDNmZS1hNWUyLTU3OGY0YjYxZWE2MSIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb2F1dGgvZ3JhbnQiOiJsb2dpbiIsImh0dHBzOi8vc2NoZW1hcy5jaXNjby5jb20vaXJvaC9pZGVudGl0eS9jbGFpbXMvb3JnL25hbWUiOiJzYW5qbXMrZXNzZW50aWFscyIsImp0aSI6InRva2VuLTdlMzIzZjAwLTYxYWItNGZhMy04Njc2LTg3MjhkZWNhMDRmNyIsIm5iZiI6MTcwMjYxODY5OCwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy91c2VyL25hbWUiOiJ2c3BhbmNoYSBlc3NlbnRpYWxzLVNhbmpheVRlbmFudChFeGlzdGluZykiLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3VzZXIvaWQiOiI4NzFhMDNhZi1jZTNhLTRiNjktYWMyYy1iODczMGI0NWNmMzIiLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL29hdXRoL2NsaWVudC9pZCI6Imlyb2gtdWkiLCJodHRwczovL3NjaGVtYXMuY2lzY28uY29tL2lyb2gvaWRlbnRpdHkvY2xhaW1zL3ZlcnNpb24iOiJ2Mi4xMC1jNmQ5Y2ZjODU1Nzk4NjUwNWI5MSIsImlhdCI6MTcwMjYxODc1OCwiaHR0cHM6Ly9zY2hlbWFzLmNpc2NvLmNvbS9pcm9oL2lkZW50aXR5L2NsYWltcy9vYXV0aC9raW5kIjoic2Vzc2lvbi10b2tlbiJ9.QmEQVFnS5wK8LMDNjiqHNf2woJgN5al0aDJW7Er2Br1mJJEmG4FiXyrFJKi3Fl_lODnHcmjvIYvM_jkIYnSiet82cdG8XQdw-bHev0KRsJIbcXQiTR0pyVO7121kWUyoNz_8q8OIY-DaOld5E_vncB9C8RGveGpYOzG7Wxz-s6eU5Wdpv1ntPFStZNK6tV4r8hjz1PE1fz5h-ba1UOtaqc-hx7Ys_ng2vouBR4TGTOqR3895NpVqLcLIF40bCNUh68moXe6L_zzc-7qJaN6wC5ZnF419g23pUpJXAEhwed2-meM1ggKdfaH8EST22A6URpAHYDeV63vORfbVT5ckma7JXRu8VHCx4KhnGhNSlAUMjHuU4Ipgd_EW6NY5IM7dtCljtisfGiKfxmR1X1MNb9YQrJzp_We5LS453a8WNXNYxpC6tSMq6M30dlQEC6KzqMoyhRMUFMKuWjcflgDQKhmKDF0Py8rlkUpSNKc73hbHUu8b44B91UJQodQy13B369NTms_aaytiNY3GLGGQNfsSLD5mJKG7Y-feZO3VaDOTIHezTwQpYvo5LLwMWbHuD09WXaPZm8wfFaNrxCFCJw0TJpyJ2ohcFq39AdlHknBa2RX3rwMDHWH1B4NTzQbONnF3-eDGxe82YRSgTAW-ECg0Sz_TgxaZUqI62Q3H0NI",
          "scope": "input",
          "name": "Provide the token for OrgID one which downgraded or Upgraded",
          "type": "datatype.string",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02AS400JXQXGI6FdJ5QNeKY0fugShldDyNX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 180,
          "scope": "input",
          "name": "Data_Retention",
          "type": "datatype.integer",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02AS2H8BOP7MB0EKxaNhulHtjbhFJnpWemZ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "advantage,essentials,premier",
          "scope": "input",
          "name": "Enter the Lic Tier which user want to Upgrade Or Downgrade",
          "type": "datatype.string",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02AS2EWS7VLZ03WV9dvRUMFccyP5h4p0N0W",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "3874b239-93ee-43fe-a5e2-578f4b61ea61",
          "scope": "input",
          "name": "Enter the OrgID which User want to Downgrade or Upgrade",
          "type": "datatype.string",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02AS2F81OUZKQ7MR8lzmUn4rRefwvtzXrLm",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "XDR-26126-Automation-Upgrade/Downgrade Entitlements",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02AS2DKIJPGW313OhctCyvP5PfIDCycyrIG",
        "name": "XDR-Downgrade and Upgrade Lic Tier -- Reusable Atomic",
        "title": "XDR-Downgrade and Upgrade Lic Tier -- Reusable Atomic",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "XDR-Downgrade and Upgrade Lic Tier -- Reusable Atomic",
          "input": {
            "variable_workflow_02ARXP6I9V0XU2ygl9xRKNgMtZOOWUYopOz": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2F81OUZKQ7MR8lzmUn4rRefwvtzXrLm$",
            "variable_workflow_02ARXRX8PIPY979kqMDtBY2I8FbfpSVbBT9": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2EWS7VLZ03WV9dvRUMFccyP5h4p0N0W$",
            "variable_workflow_02ARXSNAF5AWE7BFlz3FRwjR4wM8yfeM0Aa": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2H8BOP7MB0EKxaNhulHtjbhFJnpWemZ$",
            "variable_workflow_02ARZF27MMWMM5yXezDWoTdPzLggNiPjd35": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2FP8064XC4oZeZj0Vhgdxt3bYUjg6gW$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "execute_on_this_target": true,
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_02ARXMMI8YB7L7IUeQ8pPJUcHECjHRnVbjK",
          "workflow_name": "XDR-Downgrade and Upgrade Lic Tier -- Reusable Atomic"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02AS2DP0RPWOB2mXntVFDMFUdqgNC0WUz7w",
        "name": "Condition Block",
        "title": "Condition Block",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Condition Block",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02AS2DP10BJM10UrBA3iGKK2nGPFOq2S78K",
            "name": "Condition Branch",
            "title": "When Tier is essentials",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2EWS7VLZ03WV9dvRUMFccyP5h4p0N0W$",
                "operator": "eq",
                "right_operand": "essentials"
              },
              "continue_on_failure": false,
              "display_name": "When Tier is essentials",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02AS3UNO4U3KN4pw7SkihFzDq0z1UKW3lpX",
                "name": "HTTP Request",
                "title": "GET Module Type",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS400JXQXGI6FdJ5QNeKY0fugShldDyNX$"
                    }
                  ],
                  "display_name": "GET Module Type",
                  "method": "GET",
                  "relative_url": "/iroh-int/module-type",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3UQJR5UWB5QIRgY0XR5Vcx4gn6RxtnX",
                "name": "JSONPath Query",
                "title": "Fetch Flags",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Flags",
                  "input_json": "$activity.definition_activity_02AS3UNO4U3KN4pw7SkihFzDq0z1UKW3lpX.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..flags",
                      "jsonpath_query_name": "flags",
                      "jsonpath_query_type": "string",
                      "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3UTOC8W0E325R3VvHygtPCtkiV8QMCX",
                "name": "Execute Python Script",
                "title": "Execute Python Script",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Execute Python Script",
                  "script": "data = $activity.definition_activity_02AS3UQJR5UWB5QIRgY0XR5Vcx4gn6RxtnX.output.jsonpath_queries.flags$\ncount_of_third_party = sum(\"third-party\" in item for item in data)\ncount_of_third_party_and_xdr = sum(item == [\"third-party\", \"xdr\"] for item in data)\n\nprint(\"Count of 'third-party':\", count_of_third_party)\nprint(\"Count of 'third-party' and 'xdr':\", count_of_third_party_and_xdr)\nprint(\"Total Count:\", count_of_third_party+count_of_third_party_and_xdr)",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02AS2E0N59K770UPW4kjJ4ppnk3hisXcz6l",
            "name": "Condition Branch",
            "title": "When Tier is advantage",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2EWS7VLZ03WV9dvRUMFccyP5h4p0N0W$",
                "operator": "eq",
                "right_operand": "advantage"
              },
              "continue_on_failure": false,
              "display_name": "When Tier is advantage",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02AS3LQZK9YWB5i25FnpqV5ADLBNwqv9tpC",
                "name": "HTTP Request",
                "title": "GET Module Type",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS400JXQXGI6FdJ5QNeKY0fugShldDyNX$"
                    }
                  ],
                  "display_name": "GET Module Type",
                  "method": "GET",
                  "relative_url": "/iroh-int/module-type",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3MN4XF3QN2zfvuyHiClDkoABUsDGom9",
                "name": "JSONPath Query",
                "title": "Fetch Flags",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Flags",
                  "input_json": "$activity.definition_activity_02AS3LQZK9YWB5i25FnpqV5ADLBNwqv9tpC.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..flags",
                      "jsonpath_query_name": "flags",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3N8AIJZY63W4Aq2Sh3Yzhkeq3dhJS3F",
                "name": "Execute Python Script",
                "title": "Execute Python Script",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Execute Python Script",
                  "script": "data = $activity.definition_activity_02AS3MN4XF3QN2zfvuyHiClDkoABUsDGom9.output.jsonpath_queries.flags$\n\ncount_of_third_party = sum(\"third-party\" in item for item in data)\ncount_of_third_party_and_xdr = sum(item == [\"third-party\", \"xdr\"] for item in data)\n\nprint(\"Count of 'third-party':\", count_of_third_party)\nprint(\"Count of 'third-party' and 'xdr':\", count_of_third_party_and_xdr)\nprint(\"Total Count:\", count_of_third_party+count_of_third_party_and_xdr)",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_02AS3VLQLE5AV3EQ0xFBBUm7w5nPfTMESYn",
            "name": "Condition Branch",
            "title": "When Tier is premier",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS2EWS7VLZ03WV9dvRUMFccyP5h4p0N0W$",
                "operator": "eq",
                "right_operand": "premier"
              },
              "continue_on_failure": false,
              "display_name": "When Tier is premier",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02AS3VLQLFFKW08lUthCqIMEZKwTDx0HfXg",
                "name": "HTTP Request",
                "title": "GET Module Type",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "$workflow.definition_workflow_02AS21ESGYRJZ7NCrvygtBk2SkaZUCo3lVN.input.variable_workflow_02AS400JXQXGI6FdJ5QNeKY0fugShldDyNX$"
                    }
                  ],
                  "display_name": "GET Module Type",
                  "method": "GET",
                  "relative_url": "/iroh-int/module-type",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3VLQLJ0EB3p7tnMzwjB7MoE6JOTaUyb",
                "name": "JSONPath Query",
                "title": "Fetch Flags",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Fetch Flags",
                  "input_json": "$activity.definition_activity_02AS3VLQLFFKW08lUthCqIMEZKwTDx0HfXg.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..flags",
                      "jsonpath_query_name": "flags",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02AS3VLQLPGTJ1paEr6ElP0HQwIYfi4LVeN",
                "name": "Execute Python Script",
                "title": "Execute Python Script",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Execute Python Script",
                  "script": "data = $activity.definition_activity_02AS3VLQLJ0EB3p7tnMzwjB7MoE6JOTaUyb.output.jsonpath_queries.flags$\n\ncount_of_third_party = sum(\"third-party\" in item for item in data)\ncount_of_third_party_and_xdr = sum(item == [\"third-party\", \"xdr\"] for item in data)\n\nprint(\"Count of 'third-party':\", count_of_third_party)\nprint(\"Count of 'third-party' and 'xdr':\", count_of_third_party_and_xdr)\nprint(\"Total Count:\", count_of_third_party+count_of_third_party_and_xdr)",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "atomic_workflows": [
    "definition_workflow_02ARXMMI8YB7L7IUeQ8pPJUcHECjHRnVbjK"
  ],
  "dependent_workflows": [
    "definition_workflow_02ARXMMI8YB7L7IUeQ8pPJUcHECjHRnVbjK"
  ],
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:iroh_api"
    }
  ]
}