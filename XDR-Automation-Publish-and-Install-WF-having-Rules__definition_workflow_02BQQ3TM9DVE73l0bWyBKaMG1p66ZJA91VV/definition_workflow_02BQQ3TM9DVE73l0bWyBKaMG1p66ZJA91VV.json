{
  "workflow": {
    "unique_name": "definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV",
    "name": "XDR-Automation-Publish and Install WF having Rules",
    "title": "XDR-Automation-Publish and Install WF having Rules",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": null,
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "XDR-Automation-Publish and Install WF having Rules",
      "display_name": "XDR-Automation-Publish and Install WF having Rules",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "specify_on_workflow_start": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs",
        "name": "Generate Token for Publish",
        "title": "Generate Token for Publish",
        "type": "workflow.sub_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Generate Token for Publish",
          "input": {
            "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7": "client-dc20f545-dd07-4d6b-8850-a9a5d19dedb2",
            "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4": "Lt_XfbrmcpCNPibSYGvCH600fhVGyhXF30OkM5wCB0ZbBIK6Nv-TFg"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
          "workflow_name": "Vinay - SXO- Create Token-Generate Token"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02BQQREB5VDPO5bgtdujqtFbsS2bWLCRqML",
        "name": "Sleep",
        "title": "Sleep for 5s",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Sleep for 5s",
          "skip_execution": false,
          "sleep_interval": 5
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02BQRWMXDU7T808BZNqiNULIiWRHaryt7dI",
        "name": "Group",
        "title": "Pre-requiste",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Pre-requiste",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_02BQRT25XC96D4Smv0PmwIk9KmU4tapPNXX",
            "name": "Parallel Block",
            "title": "Parallel Block",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Parallel Block",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_02BQRT264ZKII3CJdsPSosW8DdYlGfvM4Np",
                "name": "Parallel Branch",
                "title": "WF Using Automation Rule Template",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "WF Using Automation Rule Template",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02BQQ4D9X95XH40brgurigud5Cuyj7RVVPb",
                    "name": "Atomic-Creating WF Using Template (Automation Rule Template)",
                    "title": "Atomic-Creating WF Using Template (Automation Rule Template)",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Atomic-Creating WF Using Template (Automation Rule Template)",
                      "input": {
                        "variable_workflow_02AOGHGZ8XXJF6VakCwn6dN4seKUIJrF8f0": "Authorization",
                        "variable_workflow_02AOGHQKS7LN56QFlKiV2wbkRZSd0GFgDQH": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                        "variable_workflow_02AOGO15MTXWY7gRFaKV67BXJbsg2gqhlEG": "WF_Aut_Rule",
                        "variable_workflow_02AOGV0KB4F0Y45c4CJjE27IPMfBC8D2abG": "\"domain\",\"email\",\"hostname\",\"ip\",\"ipv6\",\"md5\",\"sha1\",\"sha256\",\"url\",\"user\",\"amp_computer_guid\",\"certificate_common_name\",\"certificate_issuer\",\"certificate_serial\",\"cisco_cm_id\",\"cisco_mid\",\"cisco_uc_id\",\"cortex_agent_id\",\"crowdstrike_id\",\"cybereason_id\",\"darktrace_id\",\"device\",\"email_messageid\",\"email_subject\",\"file_name\",\"file_path\",\"imei\",\"imsi\",\"mac_address\",\"ms_machine_id\",\"mutex\",\"ngfw_id\",\"ngfw_name\",\"odns_identity\",\"odns_identity_label\",\"orbital_node_id\",\"pki_serial\",\"process_args\",\"process_hash\",\"process_name\",\"process_path\",\"process_username\",\"processor_id\",\"registry_key\",\"registry_name\",\"registry_path\",\"s1_agent_id\",\"serial_number\",\"swc_device_id\",\"trend_micro_id\",\"user_agent\"",
                        "variable_workflow_02AOHIPFZHWUH27Q7VhueHiNVHsXRQ4p18H": "",
                        "variable_workflow_02AOHOFCO0W784sXKcSgMEXqzBeSKbjdUQp": "\"approval_task.rule_event\",\"email.rule_event\",\"incident.rule_event\",\"schedule.rule_schedule\",\"webhook.rule_event\""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
                      "workflow_name": "XDR-Automation-Atomic-Creating WF Using Template"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_02BQRT479VLM60CkeDx7gUKT0TtWedUecvO",
                "name": "Parallel Branch",
                "title": "Creation of WF Using PivotMenu Template ",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Creation of WF Using PivotMenu Template ",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_02BQRQLDTPW5H26DTQntitYJdlnT2ghOv17",
                    "name": "Sleep",
                    "title": "Sleep for 10s",
                    "type": "core.sleep",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Sleep for 10s",
                      "skip_execution": false,
                      "sleep_interval": 10
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_02BQRQJRQ4I6R3CTeKX7wT92qm4rm6D2Nkn",
                    "name": "Atomic-Creating WF Using Template (Pivot Menu Template)",
                    "title": "Atomic-Creating WF Using Template (Pivot Menu Template)",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Atomic-Creating WF Using Template (Pivot Menu Template)",
                      "input": {
                        "variable_workflow_02AOGHGZ8XXJF6VakCwn6dN4seKUIJrF8f0": "Authorization",
                        "variable_workflow_02AOGHQKS7LN56QFlKiV2wbkRZSd0GFgDQH": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                        "variable_workflow_02AOGO15MTXWY7gRFaKV67BXJbsg2gqhlEG": "PivotMenu",
                        "variable_workflow_02AOGV0KB4F0Y45c4CJjE27IPMfBC8D2abG": "\"domain\",\"email\",\"hostname\",\"ip\",\"ipv6\",\"md5\",\"sha1\",\"sha256\",\"url\",\"user\",\"amp_computer_guid\",\"certificate_common_name\",\"certificate_issuer\",\"certificate_serial\",\"cisco_cm_id\",\"cisco_mid\",\"cisco_uc_id\",\"cortex_agent_id\",\"crowdstrike_id\",\"cybereason_id\",\"darktrace_id\",\"device\",\"email_messageid\",\"email_subject\",\"file_name\",\"file_path\",\"imei\",\"imsi\",\"mac_address\",\"ms_machine_id\",\"mutex\",\"ngfw_id\",\"ngfw_name\",\"odns_identity\",\"odns_identity_label\",\"orbital_node_id\",\"pki_serial\",\"process_args\",\"process_hash\",\"process_name\",\"process_path\",\"process_username\",\"processor_id\",\"registry_key\",\"registry_name\",\"registry_path\",\"s1_agent_id\",\"serial_number\",\"swc_device_id\",\"trend_micro_id\",\"user_agent\"",
                        "variable_workflow_02AOHIPFZHWUH27Q7VhueHiNVHsXRQ4p18H": "",
                        "variable_workflow_02AOHOFCO0W784sXKcSgMEXqzBeSKbjdUQp": "\"approval_task.rule_event\",\"email.rule_event\",\"incident.rule_event\",\"schedule.rule_schedule\",\"webhook.rule_event\""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "target_type": "web-service.endpoint",
                        "use_workflow_target": true
                      },
                      "workflow_id": "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
                      "workflow_name": "XDR-Automation-Atomic-Creating WF Using Template"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_02BQRWY020IYA5UQ7wt8SuCH2hoJycCZLPb",
            "name": "Group",
            "title": "Creation of Rules",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Creation of Rules",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02BQQ594HNYBQ1ebiPeN6z3l4rxyP5QPAIe",
                "name": "Automation - Create a Approval Task Rule",
                "title": "Automation - Create a Approval Task Rule",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create a Approval Task Rule",
                  "input": {
                    "variable_workflow_027MU5DP2Y0QV373c6xrE9AaxdSboy2UkdP": "Authorization",
                    "variable_workflow_027MU5DP2YOOP2E2lqg74QpeLxjYfPFLd1E": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                    "variable_workflow_027MU5DP2YWPX7hppM5wy7ucaUEpzSiIPXs": "$activity.definition_activity_02BQQ4D9X95XH40brgurigud5Cuyj7RVVPb.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$",
                    "variable_workflow_027MU5DP2ZG4M2M5RGKKfinZ7fnyMegq2Jh": false,
                    "variable_workflow_027MU5DP2ZUUI2h5Puh47MrWHYptwjKKgzn": "\"conditions\": {      \"left_operand\": \"$output.subject_line$\",      \"operator\": \"eq\",      \"right_operand\": \"completed\"    },",
                    "variable_workflow_027MU5DP3026X6pquZ6e4iNBoMxOBGKJYGE": "Apr-rule-$workflow.definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV.output.instance_id$",
                    "variable_workflow_02890TSOC3JQX0Ju9xWorvP0lcjMFEsf0SU": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
                  "workflow_name": "Automation - Create a Approval Task Rule"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQR6SVLJKYA20mX0NHntBMAqVmyOvVI4I",
                "name": "Sleep",
                "title": "Sleep for 5s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 5s",
                  "skip_execution": false,
                  "sleep_interval": 5
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQQSIWP3D2N1WnXpDcbcu5WOflBoeS932",
                "name": "Automation - Create a Standalone Incident Rule",
                "title": "Automation - Create a Standalone Incident Rule",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create a Standalone Incident Rule",
                  "input": {
                    "variable_workflow_027MPV5U2DIIF0zubA1M33SbdTCt6ZCzfq4": "$activity.definition_activity_02BQQ4D9X95XH40brgurigud5Cuyj7RVVPb.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$",
                    "variable_workflow_027MPV5U2EFCD2dIXOMcCJfC8zTYKWhgvL0": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                    "variable_workflow_027MPV5U2ETAA17CVQcWakhMZzhJv72iREN": "Authorization",
                    "variable_workflow_027MQ2YZNQUVF083B0R4hBHunurAKbOgtJK": "ST-rule-$workflow.definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV.output.instance_id$",
                    "variable_workflow_027MQ6J9U6SFN6iWZGzhPRXoQSwKfKnmVwO": false,
                    "variable_workflow_027MTIDA440DM0hV6hVS0HKzyKm21K1dvp9": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": {\n          \"left_operand\": {\n            \"left_operand\": {\n              \"left_operand\": {\n                \"left_operand\": {\n                  \"left_operand\": {\n                    \"left_operand\": {\n                      \"left_operand\": {\n                        \"left_operand\": {\n                          \"left_operand\": {\n                            \"left_operand\": {\n                              \"left_operand\": {\n                                \"left_operand\": {\n                                  \"left_operand\": {\n                                    \"left_operand\": {\n                                      \"left_operand\": {\n                                        \"left_operand\": \"$output.incident.description$\",\n                                        \"operator\": \"mw\",\n                                        \"right_operand\": \"*incident*\"\n                                      },\n                                      \"right_operand\": {\n                                        \"left_operand\": \"$output.incident.status$\",\n                                        \"operator\": \"eq\",\n                                        \"right_operand\": \"New\"\n                                      },\n                                      \"operator\": \"and\"\n                                    },\n                                    \"right_operand\": {\n                                      \"left_operand\": \"$output.incident.source$\",\n                                      \"operator\": \"eq\",\n                                      \"right_operand\": \"Umbrella\"\n                                    },\n                                    \"operator\": \"and\"\n                                  },\n                                  \"right_operand\": {\n                                    \"left_operand\": \"$output.incident.tlp$\",\n                                    \"operator\": \"eq\",\n                                    \"right_operand\": \"amber\"\n                                  },\n                                  \"operator\": \"and\"\n                                },\n                                \"right_operand\": {\n                                  \"left_operand\": \"$output.incident.id$\",\n                                  \"operator\": \"mw\",\n                                  \"right_operand\": \"https://private.intel*iroh.site:443/ctia/incident/incident*\"\n                                },\n                                \"operator\": \"and\"\n                              },\n                              \"right_operand\": {\n                                \"left_operand\": \"$output.source.totalCount$\",\n                                \"operator\": \"gte\",\n                                \"right_operand\": 0\n                              },\n                              \"operator\": \"and\"\n                            },\n                            \"right_operand\": {\n                              \"left_operand\": \"$output.targets.totalCount$\",\n                              \"operator\": \"gte\",\n                              \"right_operand\": 0\n                            },\n                            \"operator\": \"and\"\n                          },\n                          \"right_operand\": {\n                            \"left_operand\": \"$output.incident.scores.asset$\",\n                            \"operator\": \"gte\",\n                            \"right_operand\": 0\n                          },\n                          \"operator\": \"and\"\n                        },\n                        \"right_operand\": {\n                          \"left_operand\": \"$output.incident.scores.global$\",\n                          \"operator\": \"gte\",\n                          \"right_operand\": 0\n                        },\n                        \"operator\": \"and\"\n                      },\n                      \"right_operand\": {\n                        \"left_operand\": \"$output.incident.scores.ttp$\",\n                        \"operator\": \"gte\",\n                        \"right_operand\": 0\n                      },\n                      \"operator\": \"and\"\n                    },\n                    \"right_operand\": {\n                      \"left_operand\": \"$output.eventsCount$\",\n                      \"operator\": \"gte\",\n                      \"right_operand\": 0\n                    },\n                    \"operator\": \"and\"\n                  },\n                  \"right_operand\": {\n                    \"left_operand\": \"$output.incident.confidence$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": \"High\"\n                  },\n                  \"operator\": \"and\"\n                },\n                \"right_operand\": {\n                  \"left_operand\": \"$output.firstEventDate$\",\n                  \"operator\": \"ne\",\n                  \"right_operand\": \"2023-01-01\"\n                },\n                \"operator\": \"or\"\n              },\n              \"right_operand\": {\n                \"left_operand\": \"$output.indicators.totalCount$\",\n                \"operator\": \"gte\",\n                \"right_operand\": 0\n              },\n              \"operator\": \"or\"\n            },\n            \"right_operand\": {\n              \"left_operand\": \"$output.mitreData.totalCount$\",\n              \"operator\": \"gte\",\n              \"right_operand\": 0\n            },\n            \"operator\": \"or\"\n          },\n          \"right_operand\": {\n            \"left_operand\": \"$output.observables.totalCount$\",\n            \"operator\": \"gte\",\n            \"right_operand\": 0\n          },\n          \"operator\": \"or\"\n        },\n        \"right_operand\": {\n          \"left_operand\": \"$output.observables.data[*].type$\",\n          \"operator\": \"eq\",\n          \"right_operand\": \"domain\"\n        },\n        \"operator\": \"or\"\n      },\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.title$\",\n        \"right_operand\": \"Automation Rule Testing ST*\",\n        \"operator\": \"mw\"\n      },\n      \"operator\": \"and\"\n    },",
                    "variable_workflow_028XFL5OHWNXK5o11JcxV0kSReACzV9dk57": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
                  "workflow_name": "Automation - Create a Standalone Incident Rule"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQR71NRKBM941q3gRvUqwH4sjOXWiZhip",
                "name": "Sleep",
                "title": "Sleep for 5s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 5s",
                  "skip_execution": false,
                  "sleep_interval": 5
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQQXXPPP00Z3eIP8d9K0YIeMiGerqXSxI",
                "name": "Automation - Create a Priority Incident Rule",
                "title": "Automation - Create a Priority Incident Rule",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create a Priority Incident Rule",
                  "input": {
                    "variable_workflow_027MR8CHBC18861hO5QjA8naySKiwdu2gyN": "INC-PR-$workflow.definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV.output.instance_id$",
                    "variable_workflow_027MR8CHBC96A1GWgiQyknzFoBdYsa57Emh": "$activity.definition_activity_02BQQ4D9X95XH40brgurigud5Cuyj7RVVPb.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$",
                    "variable_workflow_027MR8CHBDRYU5sk9Lg2youqkRPg6xC0nRk": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                    "variable_workflow_027MR8CHBDYW87eMO6SYumhX8GZuks1Avqv": false,
                    "variable_workflow_027MR8CHBE5O23vojTUmq4Vl8h35vfIluId": "Authorization",
                    "variable_workflow_027MRCJ2DP2UI35v7wyIVOskvXAKOfjKrR2": true,
                    "variable_workflow_027MTARABH2P26oUCfYR8ctTuDRFybB13qe": "\"conditions\": {\n      \"left_operand\": {\n        \"left_operand\": {\n          \"left_operand\": {\n            \"left_operand\": {\n              \"left_operand\": {\n                \"left_operand\": {\n                  \"left_operand\": {\n                    \"left_operand\": {\n                      \"left_operand\": {\n                        \"left_operand\": {\n                          \"left_operand\": {\n                            \"left_operand\": {\n                              \"left_operand\": {\n                                \"left_operand\": {\n                                  \"left_operand\": {\n                                    \"left_operand\": {\n                                      \"left_operand\": {\n                                        \"left_operand\": \"$output.incident.description$\",\n                                        \"operator\": \"mw\",\n                                        \"right_operand\": \"*incident*\"\n                                      },\n                                      \"right_operand\": {\n                                        \"left_operand\": \"$output.incident.status$\",\n                                        \"operator\": \"eq\",\n                                        \"right_operand\": \"New\"\n                                      },\n                                      \"operator\": \"and\"\n                                    },\n                                    \"right_operand\": {\n                                      \"left_operand\": \"$output.incident.source$\",\n                                      \"operator\": \"eq\",\n                                      \"right_operand\": \"Umbrella\"\n                                    },\n                                    \"operator\": \"and\"\n                                  },\n                                  \"right_operand\": {\n                                    \"left_operand\": \"$output.incident.tlp$\",\n                                    \"operator\": \"eq\",\n                                    \"right_operand\": \"amber\"\n                                  },\n                                  \"operator\": \"and\"\n                                },\n                                \"right_operand\": {\n                                  \"left_operand\": \"$output.incident.id$\",\n                                  \"operator\": \"mw\",\n                                  \"right_operand\": \"https://private.intel*iroh.site:443/ctia/incident/incident*\"\n                                },\n                                \"operator\": \"and\"\n                              },\n                              \"right_operand\": {\n                                \"left_operand\": \"$output.source.totalCount$\",\n                                \"operator\": \"gte\",\n                                \"right_operand\": 0\n                              },\n                              \"operator\": \"and\"\n                            },\n                            \"right_operand\": {\n                              \"left_operand\": \"$output.targets.totalCount$\",\n                              \"operator\": \"gte\",\n                              \"right_operand\": 0\n                            },\n                            \"operator\": \"and\"\n                          },\n                          \"right_operand\": {\n                            \"left_operand\": \"$output.incident.scores.asset$\",\n                            \"operator\": \"gte\",\n                            \"right_operand\": 0\n                          },\n                          \"operator\": \"and\"\n                        },\n                        \"right_operand\": {\n                          \"left_operand\": \"$output.incident.scores.global$\",\n                          \"operator\": \"gte\",\n                          \"right_operand\": 0\n                        },\n                        \"operator\": \"and\"\n                      },\n                      \"right_operand\": {\n                        \"left_operand\": \"$output.incident.scores.ttp$\",\n                        \"operator\": \"gte\",\n                        \"right_operand\": 0\n                      },\n                      \"operator\": \"and\"\n                    },\n                    \"right_operand\": {\n                      \"left_operand\": \"$output.eventsCount$\",\n                      \"operator\": \"gte\",\n                      \"right_operand\": 0\n                    },\n                    \"operator\": \"and\"\n                  },\n                  \"right_operand\": {\n                    \"left_operand\": \"$output.incident.confidence$\",\n                    \"operator\": \"eq\",\n                    \"right_operand\": \"High\"\n                  },\n                  \"operator\": \"and\"\n                },\n                \"right_operand\": {\n                  \"left_operand\": \"$output.firstEventDate$\",\n                  \"operator\": \"ne\",\n                  \"right_operand\": \"2023-01-01\"\n                },\n                \"operator\": \"or\"\n              },\n              \"right_operand\": {\n                \"left_operand\": \"$output.indicators.totalCount$\",\n                \"operator\": \"gte\",\n                \"right_operand\": 0\n              },\n              \"operator\": \"or\"\n            },\n            \"right_operand\": {\n              \"left_operand\": \"$output.mitreData.totalCount$\",\n              \"operator\": \"gte\",\n              \"right_operand\": 0\n            },\n            \"operator\": \"or\"\n          },\n          \"right_operand\": {\n            \"left_operand\": \"$output.observables.totalCount$\",\n            \"operator\": \"gte\",\n            \"right_operand\": 0\n          },\n          \"operator\": \"or\"\n        },\n        \"right_operand\": {\n          \"left_operand\": \"$output.observables.data[*].type$\",\n          \"operator\": \"eq\",\n          \"right_operand\": \"domain\"\n        },\n        \"operator\": \"or\"\n      },\n      \"right_operand\": {\n        \"left_operand\": \"$output.incident.title$\",\n        \"right_operand\": \"Automation Rule Testing PR*\",\n        \"operator\": \"mw\"\n      },\n      \"operator\": \"and\"\n    },"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
                  "workflow_name": "Automation - Create a Priority Incident Rule"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQR76MXYF681dlYMsdihJh3KoudY6hsIU",
                "name": "Sleep",
                "title": "Sleep for 5s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 5s",
                  "skip_execution": false,
                  "sleep_interval": 5
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQSVLJTI36Z2w0lo0J2EC0ZiO0kWJSgHb",
                "name": "HTTP Request",
                "title": "Set Order 1 for Priority Rule",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"type\": \"incident.rule_event\",\n  \"rule\": {\n    \"id\": \"$activity.definition_activity_02BQQXXPPP00Z3eIP8d9K0YIeMiGerqXSxI.output.variable_workflow_027MR8CHBDD633pQPGnXsZVl1TYdOrt5209$\"\n  },\n  \"previous_rule\": {}\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$"
                    }
                  ],
                  "display_name": "Set Order 1 for Priority Rule",
                  "method": "PATCH",
                  "relative_url": "/api/v1/rules/priority",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQQZNREQYLB4I5x6OETVmzyKwuHCQUiRo",
                "name": "Automation - Create Webhook",
                "title": "Automation - Create Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create Webhook",
                  "input": {
                    "variable_workflow_027P5JFQ0SDKR6MoGg5qxaOLoqiaWHkkoYq": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                    "variable_workflow_027P5JFQ0T3TB64EqngIu50Y9q0SkpVr6yd": "Authorization",
                    "variable_workflow_027P5JFQ0TAUB6yI2eLlWXZkMomsSYVKq0r": "WH-Json-$workflow.definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV.output.instance_id$",
                    "variable_workflow_027P5O8M6T5BM1LlSSC5COdB66Myv1Bi81T": "application/json"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
                  "workflow_name": "Automation - Create Webhook"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQR7AVSXIY73DOGcg6WnWk1IkFukiT2bR",
                "name": "Sleep",
                "title": "Sleep for 5s",
                "type": "core.sleep",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Sleep for 5s",
                  "skip_execution": false,
                  "sleep_interval": 5
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02BQR0EBPOU5I5H4aKN7HNt4FBBUAyQHo0d",
                "name": "Automation - Create a Webhook Rule",
                "title": "Automation - Create a Webhook Rule",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Automation - Create a Webhook Rule",
                  "input": {
                    "variable_workflow_027P45D44BNVE2w76s6EPAIDPhPBKNiSA8b": false,
                    "variable_workflow_027P45D44CF1A4tEsHLpvO2STimcIcVhrJt": "$activity.definition_activity_02BQQ4D9X95XH40brgurigud5Cuyj7RVVPb.output.variable_workflow_02AOGVGEQA83R0St7xjCFlLOloAHVVTwiO9$",
                    "variable_workflow_027P45D44CNAZ6angvnRBAs2qfCCDdUu8ci": "$activity.definition_activity_02BQQZNREQYLB4I5x6OETVmzyKwuHCQUiRo.output.variable_workflow_027P5JFQ0SP106SOaK9zDE4KzgITsplp9Tk$",
                    "variable_workflow_027P45D44D1BO6VaE0q6IvWEztPJg3h0hIS": "\"conditions\": {      \"left_operand\": \"$output.request_body$\",      \"operator\": \"mw\",      \"right_operand\": \"*test*\"    },",
                    "variable_workflow_027P45D44DMB477bxyEMolVkSG1vM9kCrAK": "Bearer $activity.definition_activity_02BQQ6HK7KNPW15WsvRyXJLe31TAVddkuPs.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                    "variable_workflow_027P45D44DTL82ccunZl1nVPIB2nzGAM2S9": "Authorization",
                    "variable_workflow_027P45D44E9AA7Ww5VxYXs0OBcaz6zQJGT8": "WH-Json-$workflow.definition_workflow_02BQQ3TM9DVE73l0bWyBKaMG1p66ZJA91VV.output.instance_id$",
                    "variable_workflow_028SFNZF9E80K2Ply4MsV48QvpSgsi0DPx2": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "target_type": "web-service.endpoint",
                    "use_workflow_target": true
                  },
                  "workflow_id": "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v",
                  "workflow_name": "Automation - Create a Webhook Rule"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
        "name": "Vinay - SXO- Create Token-Generate Token",
        "title": "Vinay - SXO- Create Token-Generate Token",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "client_id",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "token",
              "type": "datatype.string",
              "is_required": false,
              "display_on_wizard": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "client-secret",
              "type": "datatype.string",
              "is_required": true,
              "display_on_wizard": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "Vinay - SXO- Create Token-Generate Token",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api$",
            "execute_on_workflow_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD",
            "name": "HTTP Request",
            "title": "Create token",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "client_secret=$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.input.variable_workflow_02BC8GA3DL7UT2XvjCn2jMUeOtCfsmMDZy4$\u0026grant_type=client_credentials\u0026client_id=$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.input.variable_workflow_02BC75FY6KJQ31bp06fvoXJ188gYh1wbUa7$",
              "continue_on_error_status_code": false,
              "continue_on_failure": true,
              "custom_headers": [
                {
                  "name": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ],
              "display_name": "Create token",
              "method": "POST",
              "relative_url": "/oauth2/token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV",
            "name": "JSONPath Query",
            "title": "Get Token",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Get Token",
              "input_json": "$activity.definition_activity_02BC75G22FOUZ4EkPmUFkyaUDv7ufY6XoyD.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.access_token",
                  "jsonpath_query_name": "token",
                  "jsonpath_query_type": "string",
                  "zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssZ"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02BC75G4HIDLS4gLpshXHmYqx7felpNEF3o",
            "name": "Set Variables",
            "title": "Set token output variable to generated token",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Set token output variable to generated token",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX.output.variable_workflow_02BC75FY6K85Y7UxbMgUx2RiWsymGSVCmQm$",
                  "variable_value_new": "$activity.definition_activity_02BC75G34XD9J77fLUiyGdXiTwppF2BuwNV.output.jsonpath_queries.token$"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
    "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
    "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v"
  ],
  "dependent_workflows": [
    "definition_workflow_02BC75FXY8V6Q7fCnqF2hIiteIL3tPcTIMX",
    "definition_workflow_02AOGESRPNY2Q0jJfksWj2Cwha9MaNmtv3k",
    "definition_workflow_027MU5DO6KIE40ogRJMxIUt6V5nik849pFP",
    "definition_workflow_027MPV5T5BDE60Q3n3jgLoLENPtPsMnHoah",
    "definition_workflow_027MR8CGEDVWB2xHFmMmI9YCGHDLWT7b1ln",
    "definition_workflow_027P5JFPBK36T57z9vNUGDiD30JJThfKwXv",
    "definition_workflow_027P45D2VMD4G1SXxA7PCa24mpenkDUSS3v"
  ],
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:iroh_api"
    }
  ]
}